[0m03:59:03.466276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7096a75c3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7096a552d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7096a55bb460>]}


============================== 03:59:03.472979 | ad3c6af6-83f5-4b36-8da3-77bea24a360e ==============================
[0m03:59:03.472979 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:59:03.473586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:59:05.330453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad3c6af6-83f5-4b36-8da3-77bea24a360e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7096a52ee520>]}
[0m03:59:05.387501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad3c6af6-83f5-4b36-8da3-77bea24a360e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7096a6782ee0>]}
[0m03:59:05.389533 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:59:05.421095 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:59:05.422338 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:59:05.422893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ad3c6af6-83f5-4b36-8da3-77bea24a360e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70967add0e50>]}
[0m03:59:06.580055 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m03:59:06.585556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad3c6af6-83f5-4b36-8da3-77bea24a360e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7096a17d1c10>]}
[0m03:59:06.650307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad3c6af6-83f5-4b36-8da3-77bea24a360e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7096a1701b50>]}
[0m03:59:06.650936 [info ] [MainThread]: Found 454 macros
[0m03:59:06.651370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad3c6af6-83f5-4b36-8da3-77bea24a360e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7096a17d1310>]}
[0m03:59:06.652499 [info ] [MainThread]: 
[0m03:59:06.652933 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:59:06.653552 [debug] [MainThread]: Command end result
[0m03:59:06.681128 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2775474, "process_user_time": 4.579684, "process_kernel_time": 1.751879, "process_mem_max_rss": "192120", "process_in_blocks": "3944", "process_out_blocks": "17464"}
[0m03:59:06.681904 [debug] [MainThread]: Command `dbt run` succeeded at 03:59:06.681793 after 3.28 seconds
[0m03:59:06.682423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7096a75c3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7096a61cc400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70967ae26220>]}
[0m03:59:06.682849 [debug] [MainThread]: Flushing usage events
[0m03:59:14.346574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753502ee5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753500d73130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753501b052e0>]}


============================== 03:59:14.352504 | 72028068-1aa4-40aa-9230-96b6b79da19f ==============================
[0m03:59:14.352504 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:59:14.353121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m03:59:15.228864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72028068-1aa4-40aa-9230-96b6b79da19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753500c2a490>]}
[0m03:59:15.285097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72028068-1aa4-40aa-9230-96b6b79da19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753501b19dc0>]}
[0m03:59:15.286332 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:59:15.312393 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:59:15.399540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:59:15.400277 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:59:15.401112 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m03:59:15.411561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72028068-1aa4-40aa-9230-96b6b79da19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534fd25e8e0>]}
[0m03:59:15.619732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72028068-1aa4-40aa-9230-96b6b79da19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534d2590250>]}
[0m03:59:15.620643 [info ] [MainThread]: Found 454 macros
[0m03:59:15.621257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72028068-1aa4-40aa-9230-96b6b79da19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534d25902e0>]}
[0m03:59:15.622630 [info ] [MainThread]: 
[0m03:59:15.623111 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:59:15.625184 [debug] [MainThread]: Command end result
[0m03:59:15.656193 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3625637, "process_user_time": 2.819899, "process_kernel_time": 1.583451, "process_mem_max_rss": "192252", "process_in_blocks": "600", "process_out_blocks": "1776"}
[0m03:59:15.657349 [debug] [MainThread]: Command `dbt test` succeeded at 03:59:15.657207 after 1.36 seconds
[0m03:59:15.657874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753502ee5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534d2406160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753501b19dc0>]}
[0m03:59:15.658377 [debug] [MainThread]: Flushing usage events
[0m04:00:02.774471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e37313434c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e372f2203a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e372f1a25e0>]}


============================== 04:00:02.782579 | 3509089f-2985-47d2-8a4c-0e73a1481bc9 ==============================
[0m04:00:02.782579 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:00:02.783496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m04:00:03.867384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3509089f-2985-47d2-8a4c-0e73a1481bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e37080d4b80>]}
[0m04:00:03.930754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3509089f-2985-47d2-8a4c-0e73a1481bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e372f2283a0>]}
[0m04:00:03.931926 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:00:03.954822 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:00:04.033325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m04:00:04.034185 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/sources.yml
[0m04:00:04.096637 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:00:04.103429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3509089f-2985-47d2-8a4c-0e73a1481bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e372b697eb0>]}
[0m04:00:04.244078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3509089f-2985-47d2-8a4c-0e73a1481bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e372b7591c0>]}
[0m04:00:04.244757 [info ] [MainThread]: Found 454 macros
[0m04:00:04.245216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3509089f-2985-47d2-8a4c-0e73a1481bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e372b6af760>]}
[0m04:00:04.246668 [info ] [MainThread]: 
[0m04:00:04.247116 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:00:04.247727 [debug] [MainThread]: Command end result
[0m04:00:04.273976 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5608637, "process_user_time": 2.867664, "process_kernel_time": 1.637524, "process_mem_max_rss": "192312", "process_out_blocks": "2664", "process_in_blocks": "0"}
[0m04:00:04.274694 [debug] [MainThread]: Command `dbt run` succeeded at 04:00:04.274583 after 1.56 seconds
[0m04:00:04.275183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e37313434c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e372ffcd850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e372f2283a0>]}
[0m04:00:04.275628 [debug] [MainThread]: Flushing usage events
[0m04:00:08.744646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788519875490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7885176d9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78851769e670>]}


============================== 04:00:08.750550 | 96cfd8b9-d409-4830-9f03-c9397c603dc6 ==============================
[0m04:00:08.750550 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:00:08.751152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m04:00:09.593541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96cfd8b9-d409-4830-9f03-c9397c603dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7884f0640b50>]}
[0m04:00:09.646991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96cfd8b9-d409-4830-9f03-c9397c603dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7884f01f3730>]}
[0m04:00:09.647847 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:00:09.671494 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:00:09.824750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:00:09.825598 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:00:09.826356 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:00:09.836205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96cfd8b9-d409-4830-9f03-c9397c603dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788513c095b0>]}
[0m04:00:10.005696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96cfd8b9-d409-4830-9f03-c9397c603dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788513b3f370>]}
[0m04:00:10.006346 [info ] [MainThread]: Found 454 macros
[0m04:00:10.006848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96cfd8b9-d409-4830-9f03-c9397c603dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788513c09820>]}
[0m04:00:10.007967 [info ] [MainThread]: 
[0m04:00:10.008416 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:00:10.010278 [debug] [MainThread]: Command end result
[0m04:00:10.039002 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3466774, "process_user_time": 2.752703, "process_kernel_time": 1.566124, "process_mem_max_rss": "191960", "process_out_blocks": "1776", "process_in_blocks": "0"}
[0m04:00:10.039865 [debug] [MainThread]: Command `dbt test` succeeded at 04:00:10.039709 after 1.35 seconds
[0m04:00:10.040440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788519875490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7884f01f3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788513b6d5e0>]}
[0m04:00:10.040878 [debug] [MainThread]: Flushing usage events
[0m04:01:02.686808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc687894a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc6857fd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc68588c460>]}


============================== 04:01:02.693266 | c8bfd5d5-af8d-41cc-b024-0a2f02b6d093 ==============================
[0m04:01:02.693266 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:01:02.693931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m04:01:03.702165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8bfd5d5-af8d-41cc-b024-0a2f02b6d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc657f46610>]}
[0m04:01:03.758732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8bfd5d5-af8d-41cc-b024-0a2f02b6d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc657eceeb0>]}
[0m04:01:03.759723 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:01:03.781438 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:01:03.870078 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m04:01:03.870825 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/bronze/bronze_data.sql
[0m04:01:03.871407 [debug] [MainThread]: Partial parsing: updated file: crypto_transform://models/sources.yml
[0m04:01:03.130494 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:01:03.145144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8bfd5d5-af8d-41cc-b024-0a2f02b6d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc680e29040>]}
[0m04:01:03.254624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8bfd5d5-af8d-41cc-b024-0a2f02b6d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc680d72970>]}
[0m04:01:03.255367 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:01:03.255879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8bfd5d5-af8d-41cc-b024-0a2f02b6d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc680daac70>]}
[0m04:01:03.257433 [info ] [MainThread]: 
[0m04:01:03.257967 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:01:03.258723 [debug] [MainThread]: Command end result
[0m04:01:03.290206 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9064997, "process_user_time": 3.2458, "process_kernel_time": 1.626917, "process_mem_max_rss": "196656", "process_in_blocks": "536", "process_out_blocks": "2688"}
[0m04:01:03.291107 [debug] [MainThread]: Command `dbt run` succeeded at 04:01:03.290943 after 1.91 seconds
[0m04:01:03.291671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc687894a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc657f46610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc680e33fa0>]}
[0m04:01:03.292132 [debug] [MainThread]: Flushing usage events
[0m04:01:08.078510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78290779d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782905ca5ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782905730520>]}


============================== 04:01:08.083785 | a44ec2f0-3f35-4c01-9fd6-bc24fbfd46dc ==============================
[0m04:01:08.083785 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:01:08.084397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m04:01:09.003455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a44ec2f0-3f35-4c01-9fd6-bc24fbfd46dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7829054ee5e0>]}
[0m04:01:09.059137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a44ec2f0-3f35-4c01-9fd6-bc24fbfd46dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7828d7e4fa60>]}
[0m04:01:09.060168 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:01:09.082069 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:01:09.208904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:01:09.209509 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:01:09.216684 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:01:09.252019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a44ec2f0-3f35-4c01-9fd6-bc24fbfd46dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782901b26040>]}
[0m04:01:09.444949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a44ec2f0-3f35-4c01-9fd6-bc24fbfd46dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7828d7e950a0>]}
[0m04:01:09.445703 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:01:09.446185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a44ec2f0-3f35-4c01-9fd6-bc24fbfd46dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782901b01730>]}
[0m04:01:09.447551 [info ] [MainThread]: 
[0m04:01:09.448032 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:01:09.449947 [debug] [MainThread]: Command end result
[0m04:01:09.478365 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.4520386, "process_user_time": 2.815553, "process_kernel_time": 1.511465, "process_mem_max_rss": "192972", "process_out_blocks": "1792", "process_in_blocks": "0"}
[0m04:01:09.479141 [debug] [MainThread]: Command `dbt test` succeeded at 04:01:09.479003 after 1.45 seconds
[0m04:01:09.479614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78290779d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7829063d03d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782901b1b040>]}
[0m04:01:09.480043 [debug] [MainThread]: Flushing usage events
[0m04:02:03.237518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb4a6511a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb4a447b4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb4a4509460>]}


============================== 04:02:03.243167 | f652e039-4443-4635-bcb8-fbaef69836fa ==============================
[0m04:02:03.243167 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:02:03.243809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:02:04.198811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f652e039-4443-4635-bcb8-fbaef69836fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb47d2b2610>]}
[0m04:02:04.265354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f652e039-4443-4635-bcb8-fbaef69836fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb47d23aee0>]}
[0m04:02:04.266643 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:02:04.292878 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:02:04.450279 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:02:04.451025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f652e039-4443-4635-bcb8-fbaef69836fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb4a511a310>]}
[0m04:02:05.773653 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:02:05.786928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f652e039-4443-4635-bcb8-fbaef69836fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb49f6366d0>]}
[0m04:02:05.890047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f652e039-4443-4635-bcb8-fbaef69836fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb49f5a52b0>]}
[0m04:02:05.890710 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:02:05.891229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f652e039-4443-4635-bcb8-fbaef69836fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb49f56ec40>]}
[0m04:02:05.892804 [info ] [MainThread]: 
[0m04:02:05.893572 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:02:05.894985 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:02:05.910839 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:02:05.911396 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:02:05.911812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:02:18.562532 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:02:18.563171 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m04:02:18.563722 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m04:02:18.564206 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m04:02:18.564769 [debug] [ThreadPool]: On list_streaming_db: No close available on handle
[0m04:02:18.565925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:02:18.566377 [debug] [MainThread]: Connection 'list_streaming_db' was properly closed.
[0m04:02:18.566833 [info ] [MainThread]: 
[0m04:02:18.567338 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 12.67 seconds (12.67s).
[0m04:02:18.568035 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "streaming_db"
  Database Error
    250001: Could not connect to Snowflake backend after 1 attempt(s).Aborting
[0m04:02:18.569236 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.94506, "process_user_time": 5.127868, "process_kernel_time": 1.665947, "process_mem_max_rss": "241584", "process_in_blocks": "8456", "process_out_blocks": "6480", "command_success": false}
[0m04:02:18.569898 [debug] [MainThread]: Command `dbt run` failed at 04:02:18.569785 after 14.95 seconds
[0m04:02:18.570356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb4a6511a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb49f5258e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb49ecc5550>]}
[0m04:02:18.570867 [debug] [MainThread]: Flushing usage events
[0m04:03:03.052980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb9d17abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb9b180eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb9afc9970>]}


============================== 04:03:03.059254 | 86fc2024-2de3-4f7c-aa87-2db4fbd48170 ==============================
[0m04:03:03.059254 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:03:03.060020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:03:04.039900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86fc2024-2de3-4f7c-aa87-2db4fbd48170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb741ccbb0>]}
[0m04:03:04.116489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86fc2024-2de3-4f7c-aa87-2db4fbd48170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb9bdaddc0>]}
[0m04:03:04.117643 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:03:04.145097 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:03:04.287494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:03:04.288269 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:03:04.295401 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:03:04.333938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86fc2024-2de3-4f7c-aa87-2db4fbd48170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb974a7e20>]}
[0m04:03:04.446276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86fc2024-2de3-4f7c-aa87-2db4fbd48170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb97466ee0>]}
[0m04:03:04.447044 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:03:04.447559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86fc2024-2de3-4f7c-aa87-2db4fbd48170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb974b9e20>]}
[0m04:03:04.544056 [info ] [MainThread]: 
[0m04:03:04.545017 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:03:04.546679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:03:04.564920 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:03:04.565580 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:03:04.565993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:03:11.060778 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:03:11.061560 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m04:03:11.062415 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m04:03:11.062817 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m04:03:11.063412 [debug] [ThreadPool]: On list_streaming_db: No close available on handle
[0m04:03:11.064890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:03:11.065411 [debug] [MainThread]: Connection 'list_streaming_db' was properly closed.
[0m04:03:11.065985 [info ] [MainThread]: 
[0m04:03:11.066587 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 6.52 seconds (6.52s).
[0m04:03:11.067648 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "streaming_db"
  Database Error
    250001: Could not connect to Snowflake backend after 1 attempt(s).Aborting
[0m04:03:11.069122 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.073937, "process_user_time": 3.215912, "process_kernel_time": 1.487127, "process_mem_max_rss": "205216", "process_in_blocks": "1224", "process_out_blocks": "920", "command_success": false}
[0m04:03:11.069939 [debug] [MainThread]: Command `dbt run` failed at 04:03:11.069809 after 8.07 seconds
[0m04:03:11.070561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb9d17abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb974e0eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb97576b50>]}
[0m04:03:11.071080 [debug] [MainThread]: Flushing usage events
[0m04:04:03.348853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b333bb0a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b3319bc700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b3319bcfa0>]}


============================== 04:04:03.355751 | 2ff4c7c3-e093-413f-844f-a79bdf1c310f ==============================
[0m04:04:03.355751 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:04:03.356397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:04:04.293298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ff4c7c3-e093-413f-844f-a79bdf1c310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b3042c0f70>]}
[0m04:04:04.358760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ff4c7c3-e093-413f-844f-a79bdf1c310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b3042c0e80>]}
[0m04:04:04.359946 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:04:04.384544 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:04:04.518465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:04:04.519178 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:04:04.526450 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:04:04.564238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ff4c7c3-e093-413f-844f-a79bdf1c310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b32df1efa0>]}
[0m04:04:04.674343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ff4c7c3-e093-413f-844f-a79bdf1c310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b32de9df70>]}
[0m04:04:04.675097 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:04:04.675622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ff4c7c3-e093-413f-844f-a79bdf1c310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b32df2f730>]}
[0m04:04:04.768174 [info ] [MainThread]: 
[0m04:04:04.769228 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:04:04.770939 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:04:04.788648 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:04:04.789181 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:04:04.789576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:04:10.014512 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:04:10.015311 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m04:04:10.015954 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m04:04:10.016471 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m04:04:10.017145 [debug] [ThreadPool]: On list_streaming_db: No close available on handle
[0m04:04:10.018842 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:04:10.019435 [debug] [MainThread]: Connection 'list_streaming_db' was properly closed.
[0m04:04:10.020153 [info ] [MainThread]: 
[0m04:04:10.020751 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 5.25 seconds (5.25s).
[0m04:04:10.021588 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "streaming_db"
  Database Error
    250001: Could not connect to Snowflake backend after 1 attempt(s).Aborting
[0m04:04:10.023017 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.7303414, "process_user_time": 3.171778, "process_kernel_time": 1.665474, "process_mem_max_rss": "205616", "process_in_blocks": "504", "process_out_blocks": "928", "command_success": false}
[0m04:04:10.023958 [debug] [MainThread]: Command `dbt run` failed at 04:04:10.023819 after 6.73 seconds
[0m04:04:10.024549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b333bb0a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b32df79640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b32dfac3a0>]}
[0m04:04:10.025145 [debug] [MainThread]: Flushing usage events
[0m04:05:03.441424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fd47bd7400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fd460dfac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fd45b6a520>]}


============================== 04:05:03.448707 | 8b085bbb-4c85-401a-a8b3-76b19569521a ==============================
[0m04:05:03.448707 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:05:03.449417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:05:04.442366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b085bbb-4c85-401a-a8b3-76b19569521a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fd4592f5e0>]}
[0m04:05:04.501303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b085bbb-4c85-401a-a8b3-76b19569521a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fd1828aa60>]}
[0m04:05:04.502417 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:05:04.526663 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:05:04.670590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:05:04.671213 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:05:04.677733 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:05:04.714315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b085bbb-4c85-401a-a8b3-76b19569521a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fd41f5d2b0>]}
[0m04:05:04.821901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b085bbb-4c85-401a-a8b3-76b19569521a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fd41ed7340>]}
[0m04:05:04.822617 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:05:04.823073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b085bbb-4c85-401a-a8b3-76b19569521a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fd41f66760>]}
[0m04:05:04.914511 [info ] [MainThread]: 
[0m04:05:04.915698 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:05:04.917288 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:05:04.934403 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:05:04.935061 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:05:04.935472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:05:09.613943 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:05:09.614782 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m04:05:09.615519 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m04:05:09.616003 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m04:05:09.616641 [debug] [ThreadPool]: On list_streaming_db: No close available on handle
[0m04:05:09.617905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:05:09.618423 [debug] [MainThread]: Connection 'list_streaming_db' was properly closed.
[0m04:05:09.618978 [info ] [MainThread]: 
[0m04:05:09.619553 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 4.70 seconds (4.70s).
[0m04:05:09.620373 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "streaming_db"
  Database Error
    250001: Could not connect to Snowflake backend after 1 attempt(s).Aborting
[0m04:05:09.622344 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.7418957, "process_user_time": 3.146658, "process_kernel_time": 1.631461, "process_mem_max_rss": "205288", "process_in_blocks": "8", "process_out_blocks": "920", "command_success": false}
[0m04:05:09.623155 [debug] [MainThread]: Command `dbt run` failed at 04:05:09.623032 after 7.74 seconds
[0m04:05:09.623746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fd47bd7400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fd41f90ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fd41fda5e0>]}
[0m04:05:09.624307 [debug] [MainThread]: Flushing usage events
[0m04:06:02.754011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fe44b33a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fe238d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fe230e5e0>]}


============================== 04:06:02.759439 | 3a8748a3-df6d-49a1-b833-f474ca4d6278 ==============================
[0m04:06:02.759439 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:06:02.760081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:06:03.676146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a8748a3-df6d-49a1-b833-f474ca4d6278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fb3b1cbe0>]}
[0m04:06:03.731953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a8748a3-df6d-49a1-b833-f474ca4d6278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fe23983d0>]}
[0m04:06:03.732870 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:06:03.755691 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:06:03.888678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:06:03.889543 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:06:03.896828 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:06:03.934681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a8748a3-df6d-49a1-b833-f474ca4d6278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fde838310>]}
[0m04:06:04.045549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a8748a3-df6d-49a1-b833-f474ca4d6278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fde7f1f40>]}
[0m04:06:04.046261 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:06:04.046767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a8748a3-df6d-49a1-b833-f474ca4d6278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fde838bb0>]}
[0m04:06:04.135291 [info ] [MainThread]: 
[0m04:06:04.136192 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:06:04.137623 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:06:04.153490 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:06:04.153904 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:06:04.154284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:06:10.174874 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:06:10.175567 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m04:06:10.176181 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m04:06:10.176641 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m04:06:10.177183 [debug] [ThreadPool]: On list_streaming_db: No close available on handle
[0m04:06:10.178369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:06:10.178915 [debug] [MainThread]: Connection 'list_streaming_db' was properly closed.
[0m04:06:10.179429 [info ] [MainThread]: 
[0m04:06:10.180001 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 6.04 seconds (6.04s).
[0m04:06:10.180887 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "streaming_db"
  Database Error
    250001: Could not connect to Snowflake backend after 1 attempt(s).Aborting
[0m04:06:10.182045 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.807566, "process_user_time": 3.000842, "process_kernel_time": 1.529918, "process_mem_max_rss": "205844", "process_in_blocks": "16", "process_out_blocks": "928", "command_success": false}
[0m04:06:10.182931 [debug] [MainThread]: Command `dbt run` failed at 04:06:10.182805 after 8.81 seconds
[0m04:06:10.183438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fe44b33a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fde86e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fde8f2250>]}
[0m04:06:10.183925 [debug] [MainThread]: Flushing usage events
[0m04:07:03.758866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755efd9cda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755efb9374f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755efb9c5460>]}


============================== 04:07:03.765551 | 54961bad-d576-457a-811c-8030913f3265 ==============================
[0m04:07:03.765551 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:07:03.766288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m04:07:03.232496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54961bad-d576-457a-811c-8030913f3265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755ed4774610>]}
[0m04:07:03.293596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54961bad-d576-457a-811c-8030913f3265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755ed46fdeb0>]}
[0m04:07:03.294776 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:07:03.319563 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:07:03.464031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:07:03.464767 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:07:03.472597 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:07:03.512143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54961bad-d576-457a-811c-8030913f3265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755ef7d27eb0>]}
[0m04:07:03.624547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54961bad-d576-457a-811c-8030913f3265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755ef7ca5fa0>]}
[0m04:07:03.625274 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:07:03.625831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54961bad-d576-457a-811c-8030913f3265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755ef7d2ddf0>]}
[0m04:07:03.715701 [info ] [MainThread]: 
[0m04:07:03.716677 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:07:03.718116 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:07:03.735803 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:07:03.736316 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:07:03.736758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:07:11.714804 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:07:11.715594 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m04:07:11.716269 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m04:07:11.716737 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m04:07:11.717321 [debug] [ThreadPool]: On list_streaming_db: No close available on handle
[0m04:07:11.718666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:07:11.719179 [debug] [MainThread]: Connection 'list_streaming_db' was properly closed.
[0m04:07:11.719935 [info ] [MainThread]: 
[0m04:07:11.720530 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 8.00 seconds (8.00s).
[0m04:07:11.721407 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "streaming_db"
  Database Error
    250001: Could not connect to Snowflake backend after 1 attempt(s).Aborting
[0m04:07:11.722676 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.456197, "process_user_time": 3.062999, "process_kernel_time": 1.565365, "process_mem_max_rss": "205444", "process_in_blocks": "8", "process_out_blocks": "920", "command_success": false}
[0m04:07:11.723600 [debug] [MainThread]: Command `dbt run` failed at 04:07:11.723466 after 9.46 seconds
[0m04:07:11.724171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755efd9cda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755ed46a9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755ef7db4cd0>]}
[0m04:07:11.724726 [debug] [MainThread]: Flushing usage events
[0m04:08:01.801640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706f45c72490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706f43b0e3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706f43a935e0>]}


============================== 04:08:01.807255 | 03834724-ce05-4003-9423-2cba2f3eff09 ==============================
[0m04:08:01.807255 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:08:01.807828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m04:08:02.740020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03834724-ce05-4003-9423-2cba2f3eff09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706f1c19eb80>]}
[0m04:08:02.795523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03834724-ce05-4003-9423-2cba2f3eff09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706f43b13370>]}
[0m04:08:02.796808 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:08:02.819450 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:08:02.926458 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:08:02.927243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '03834724-ce05-4003-9423-2cba2f3eff09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706f448a5550>]}
[0m04:08:04.291193 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:08:04.304447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03834724-ce05-4003-9423-2cba2f3eff09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706f3f1c4760>]}
[0m04:08:04.409609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03834724-ce05-4003-9423-2cba2f3eff09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706f3cc74340>]}
[0m04:08:04.410382 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:08:04.410911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03834724-ce05-4003-9423-2cba2f3eff09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706f3f1b6fa0>]}
[0m04:08:04.412650 [info ] [MainThread]: 
[0m04:08:04.413376 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:08:04.414936 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:08:04.430926 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:08:04.431485 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:08:04.431895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:08:07.694402 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 3.262 seconds
[0m04:08:07.697492 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:08:08.286397 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db_public'
[0m04:08:08.300022 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:08:08.300522 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:08:08.300985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:08:09.515883 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.215 seconds
[0m04:08:09.518143 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:08:09.874673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03834724-ce05-4003-9423-2cba2f3eff09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706f3cc16d90>]}
[0m04:08:09.875722 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:08:09.876569 [info ] [MainThread]: 
[0m04:08:09.886777 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:08:09.887750 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:08:09.888533 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:08:09.889038 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:08:09.900032 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:08:09.903181 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:08:09.938681 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:08:09.942066 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:08:09.942625 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT 
    *
FROM streaming_db.public.stock_trades_raw
  );
[0m04:08:09.943078 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:10.784008 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0f2f8-0001-ba8f-0001-85aa0003800a
[0m04:08:10.784759 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'PUBLIC'.
[0m04:08:10.785492 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:08:11.139761 [debug] [Thread-1  ]: Database Error in model bronze_data (models/bronze/bronze_data.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'PUBLIC'.
  compiled code at target/run/crypto_transform/models/bronze/bronze_data.sql
[0m04:08:11.142450 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03834724-ce05-4003-9423-2cba2f3eff09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706f3f27d850>]}
[0m04:08:11.143860 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.bronze_data ........................ [[31mERROR[0m in 1.25s]
[0m04:08:11.145100 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:08:11.147699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:08:11.148119 [debug] [MainThread]: Connection 'list_streaming_db' was properly closed.
[0m04:08:11.148453 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:08:11.148841 [info ] [MainThread]: 
[0m04:08:11.149313 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.74 seconds (6.74s).
[0m04:08:11.150149 [debug] [MainThread]: Command end result
[0m04:08:11.187065 [info ] [MainThread]: 
[0m04:08:11.187855 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:08:11.188480 [info ] [MainThread]: 
[0m04:08:11.189189 [error] [MainThread]:   Database Error in model bronze_data (models/bronze/bronze_data.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'PUBLIC'.
  compiled code at target/run/crypto_transform/models/bronze/bronze_data.sql
[0m04:08:11.189687 [info ] [MainThread]: 
[0m04:08:11.190197 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:08:11.191345 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.444216, "process_user_time": 4.580079, "process_kernel_time": 1.609967, "process_mem_max_rss": "210708", "process_in_blocks": "104", "process_out_blocks": "4808", "command_success": false}
[0m04:08:11.191991 [debug] [MainThread]: Command `dbt run` failed at 04:08:11.191882 after 9.44 seconds
[0m04:08:11.192519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706f45c72490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706f43b13370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706f3f250040>]}
[0m04:08:11.192963 [debug] [MainThread]: Flushing usage events
[0m04:09:02.887297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705286999190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705284f62ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70528492d520>]}


============================== 04:09:02.893322 | a42eddd4-2935-4c80-a930-252dea14ccc1 ==============================
[0m04:09:02.893322 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:09:02.893953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:09:03.814294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a42eddd4-2935-4c80-a930-252dea14ccc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7052846ef5e0>]}
[0m04:09:03.874766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a42eddd4-2935-4c80-a930-252dea14ccc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70525d744a60>]}
[0m04:09:03.875996 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:09:03.901415 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:09:04.036218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:09:04.036877 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:09:04.043860 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:09:04.082262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a42eddd4-2935-4c80-a930-252dea14ccc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705280ce22b0>]}
[0m04:09:04.198367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a42eddd4-2935-4c80-a930-252dea14ccc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705280c9b340>]}
[0m04:09:04.199099 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:09:04.199631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a42eddd4-2935-4c80-a930-252dea14ccc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705280cea760>]}
[0m04:09:04.287632 [info ] [MainThread]: 
[0m04:09:04.288581 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:09:04.290159 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:09:04.306445 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:09:04.306877 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:09:04.307375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:09:05.858410 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.551 seconds
[0m04:09:05.861104 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:09:06.214550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:09:06.227553 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:09:06.228012 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:09:06.228409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:09:07.056714 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.828 seconds
[0m04:09:07.059094 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:09:07.422899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a42eddd4-2935-4c80-a930-252dea14ccc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705280d9daf0>]}
[0m04:09:07.423965 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:09:07.424548 [info ] [MainThread]: 
[0m04:09:07.434622 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:09:07.435381 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:09:07.436210 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:09:07.436644 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:09:07.445553 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:09:07.446397 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:09:07.474801 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:09:07.475898 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:09:07.476451 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT 
    *
FROM streaming_db.public.stock_trades_raw
  );
[0m04:09:07.476998 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:09:08.621088 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0f2f9-0001-ba9c-0001-85aa0003900a
[0m04:09:08.621873 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'PUBLIC'.
[0m04:09:08.622616 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:09:09.001355 [debug] [Thread-1  ]: Database Error in model bronze_data (models/bronze/bronze_data.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'PUBLIC'.
  compiled code at target/run/crypto_transform/models/bronze/bronze_data.sql
[0m04:09:09.004132 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a42eddd4-2935-4c80-a930-252dea14ccc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705280608760>]}
[0m04:09:09.005072 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.bronze_data ........................ [[31mERROR[0m in 1.57s]
[0m04:09:09.006076 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:09:09.009177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:09:09.009905 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:09:09.010459 [info ] [MainThread]: 
[0m04:09:09.011176 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m04:09:09.012319 [debug] [MainThread]: Command end result
[0m04:09:09.051158 [info ] [MainThread]: 
[0m04:09:09.051913 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:09:09.052377 [info ] [MainThread]: 
[0m04:09:09.053104 [error] [MainThread]:   Database Error in model bronze_data (models/bronze/bronze_data.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'PUBLIC'.
  compiled code at target/run/crypto_transform/models/bronze/bronze_data.sql
[0m04:09:09.053623 [info ] [MainThread]: 
[0m04:09:09.054228 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:09:09.055547 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.226479, "process_user_time": 3.083713, "process_kernel_time": 1.519777, "process_mem_max_rss": "204496", "process_out_blocks": "1832", "command_success": false, "process_in_blocks": "0"}
[0m04:09:09.056323 [debug] [MainThread]: Command `dbt run` failed at 04:09:09.056203 after 6.23 seconds
[0m04:09:09.056887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705286999190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70525d6f9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7052855cd3d0>]}
[0m04:09:09.057470 [debug] [MainThread]: Flushing usage events
[0m04:14:36.395001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d48def8520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d48efbcd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d48becaac0>]}


============================== 04:14:36.407823 | 03d3a2b9-1112-451c-919a-0693c7664b7e ==============================
[0m04:14:36.407823 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:14:36.408678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:14:37.640768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03d3a2b9-1112-451c-919a-0693c7664b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d464d6a850>]}
[0m04:14:37.700627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03d3a2b9-1112-451c-919a-0693c7664b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d464d28fd0>]}
[0m04:14:37.701806 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:14:37.726837 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:14:37.872104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:14:37.872799 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:14:37.880147 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:14:37.920457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03d3a2b9-1112-451c-919a-0693c7664b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d4882c0040>]}
[0m04:14:38.042746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03d3a2b9-1112-451c-919a-0693c7664b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d48822d070>]}
[0m04:14:38.043465 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:14:38.043995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03d3a2b9-1112-451c-919a-0693c7664b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d4882cbc40>]}
[0m04:14:38.145191 [info ] [MainThread]: 
[0m04:14:38.146164 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:14:38.147880 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:14:38.169896 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:14:38.170926 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:14:38.171515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:14:39.374701 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.895 seconds
[0m04:14:39.377970 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:14:39.765662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:14:39.780764 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:14:39.781282 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:14:39.781712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:14:40.650364 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.869 seconds
[0m04:14:40.652804 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:14:41.041370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03d3a2b9-1112-451c-919a-0693c7664b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d4882f2d60>]}
[0m04:14:41.042545 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:14:41.043217 [info ] [MainThread]: 
[0m04:14:41.053699 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:14:41.054595 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:14:41.055684 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:14:41.056309 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:14:41.065456 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:14:41.066253 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:14:41.098085 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:14:41.099306 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:14:41.099844 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT 
    *
FROM streaming_db.public.stock_trades_raw
  );
[0m04:14:41.100298 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:14:42.308250 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.208 seconds
[0m04:14:42.341393 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:14:42.726417 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03d3a2b9-1112-451c-919a-0693c7664b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d48efbcd60>]}
[0m04:14:42.727710 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.67s]
[0m04:14:42.728848 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:14:42.731291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:14:42.731807 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:14:42.732342 [info ] [MainThread]: 
[0m04:14:42.733017 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.59 seconds (4.59s).
[0m04:14:42.733987 [debug] [MainThread]: Command end result
[0m04:14:42.768711 [info ] [MainThread]: 
[0m04:14:42.769516 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:14:42.769976 [info ] [MainThread]: 
[0m04:14:42.770521 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:14:42.771837 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.129118, "process_user_time": 3.444837, "process_kernel_time": 2.081255, "process_mem_max_rss": "203296", "process_in_blocks": "584", "process_out_blocks": "1832"}
[0m04:14:42.772604 [debug] [MainThread]: Command `dbt run` succeeded at 04:14:42.772482 after 8.13 seconds
[0m04:14:42.773125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d48def8520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d48cb6a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d48cbeb5e0>]}
[0m04:14:42.773620 [debug] [MainThread]: Flushing usage events
[0m04:14:48.196964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5fc75b83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5fc54923a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5fc54155e0>]}


============================== 04:14:48.202896 | 1fd6de11-b42a-43ba-8283-e0c8f2f26aa0 ==============================
[0m04:14:48.202896 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:14:48.203602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m04:14:49.152910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fd6de11-b42a-43ba-8283-e0c8f2f26aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f97c6fb80>]}
[0m04:14:49.215940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fd6de11-b42a-43ba-8283-e0c8f2f26aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5fc54963a0>]}
[0m04:14:49.217145 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:14:49.242191 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:14:49.383143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:14:49.383805 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:14:49.390828 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:14:49.430043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fd6de11-b42a-43ba-8283-e0c8f2f26aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5fc197e2e0>]}
[0m04:14:49.644382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fd6de11-b42a-43ba-8283-e0c8f2f26aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f97cee040>]}
[0m04:14:49.645221 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:14:49.645769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fd6de11-b42a-43ba-8283-e0c8f2f26aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5fc5afd9d0>]}
[0m04:14:49.647453 [info ] [MainThread]: 
[0m04:14:49.647978 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:14:49.650157 [debug] [MainThread]: Command end result
[0m04:14:49.682425 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5438883, "process_user_time": 2.866428, "process_kernel_time": 1.601936, "process_mem_max_rss": "192592", "process_out_blocks": "1800", "process_in_blocks": "0"}
[0m04:14:49.683353 [debug] [MainThread]: Command `dbt test` succeeded at 04:14:49.683206 after 1.54 seconds
[0m04:14:49.683921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5fc75b83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5fc71f9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5fc6227400>]}
[0m04:14:49.684419 [debug] [MainThread]: Flushing usage events
[0m04:15:03.379772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb801fa9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb800430ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7fff3b520>]}


============================== 04:15:03.385618 | cd2025ba-874f-4396-a006-10d4be790f56 ==============================
[0m04:15:03.385618 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:15:03.386240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:15:04.362820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd2025ba-874f-4396-a006-10d4be790f56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7ffd025e0>]}
[0m04:15:04.425348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd2025ba-874f-4396-a006-10d4be790f56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7d8d51a60>]}
[0m04:15:04.426475 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:15:04.450536 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:15:04.594598 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:15:04.595249 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:15:04.603362 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:15:04.642620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd2025ba-874f-4396-a006-10d4be790f56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7fc3332b0>]}
[0m04:15:04.758347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd2025ba-874f-4396-a006-10d4be790f56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7fc2ab340>]}
[0m04:15:04.759145 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:15:04.759772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd2025ba-874f-4396-a006-10d4be790f56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7fc33b2e0>]}
[0m04:15:04.853221 [info ] [MainThread]: 
[0m04:15:04.854268 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:15:04.855918 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:15:04.873749 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:15:04.874206 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:15:04.874664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:15:06.193353 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.318 seconds
[0m04:15:06.196467 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:15:06.582755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:15:06.595131 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:15:06.595643 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:15:06.596096 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:15:06.907985 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.901 seconds
[0m04:15:06.910618 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:15:06.030457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd2025ba-874f-4396-a006-10d4be790f56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7d8caae80>]}
[0m04:15:06.031565 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:15:06.032261 [info ] [MainThread]: 
[0m04:15:06.041926 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:15:06.042710 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:15:06.043706 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:15:06.044236 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:15:06.053609 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:15:06.054388 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:15:06.084834 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:15:06.085924 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:15:06.086468 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT 
    *
FROM streaming_db.public.stock_trades_raw
  );
[0m04:15:06.086922 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:15:07.097854 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.011 seconds
[0m04:15:07.130622 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:15:07.521682 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2025ba-874f-4396-a006-10d4be790f56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7fc3ab6d0>]}
[0m04:15:07.523086 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.48s]
[0m04:15:07.524090 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:15:07.526628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:15:07.527125 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:15:07.527719 [info ] [MainThread]: 
[0m04:15:07.528276 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m04:15:07.529309 [debug] [MainThread]: Command end result
[0m04:15:07.562143 [info ] [MainThread]: 
[0m04:15:07.562865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:15:07.563420 [info ] [MainThread]: 
[0m04:15:07.563936 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:15:07.565108 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.090479, "process_user_time": 3.202, "process_kernel_time": 1.578236, "process_mem_max_rss": "203496", "process_out_blocks": "1832", "process_in_blocks": "0"}
[0m04:15:07.565856 [debug] [MainThread]: Command `dbt run` succeeded at 04:15:07.565737 after 6.09 seconds
[0m04:15:07.566395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb801fa9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7d8d03a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb800bdb3d0>]}
[0m04:15:07.566855 [debug] [MainThread]: Flushing usage events
[0m04:15:15.281859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b39a2976370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b39a08143a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b39a07975e0>]}


============================== 04:15:15.288003 | 18bb4cea-6347-4042-a8f5-27047ef08eed ==============================
[0m04:15:15.288003 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:15:15.288709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m04:15:16.213765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18bb4cea-6347-4042-a8f5-27047ef08eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b39796d3b80>]}
[0m04:15:16.274678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18bb4cea-6347-4042-a8f5-27047ef08eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b39a08232e0>]}
[0m04:15:16.275848 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:15:16.301491 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:15:16.467671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:15:16.468341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:15:16.475631 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:15:16.513464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18bb4cea-6347-4042-a8f5-27047ef08eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b399ccbe2e0>]}
[0m04:15:16.755873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18bb4cea-6347-4042-a8f5-27047ef08eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b397975d040>]}
[0m04:15:16.756863 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:15:16.757531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18bb4cea-6347-4042-a8f5-27047ef08eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b39a0dff9d0>]}
[0m04:15:16.759568 [info ] [MainThread]: 
[0m04:15:16.760180 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:15:16.762816 [debug] [MainThread]: Command end result
[0m04:15:16.798065 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5689068, "process_user_time": 2.899284, "process_kernel_time": 1.619965, "process_mem_max_rss": "192704", "process_out_blocks": "1792", "process_in_blocks": "0"}
[0m04:15:16.799096 [debug] [MainThread]: Command `dbt test` succeeded at 04:15:16.798916 after 1.57 seconds
[0m04:15:16.799803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b39a2976370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b39a257a100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b39a15a9400>]}
[0m04:15:16.800608 [debug] [MainThread]: Flushing usage events
[0m04:16:03.552873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f884ea8a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f882ca5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f882ca5fa0>]}


============================== 04:16:03.558857 | 9a63733d-b048-4537-be37-f2d9e999a503 ==============================
[0m04:16:03.558857 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:16:03.559485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m04:16:04.720172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a63733d-b048-4537-be37-f2d9e999a503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f8551dcf70>]}
[0m04:16:04.782886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a63733d-b048-4537-be37-f2d9e999a503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f8551dce80>]}
[0m04:16:04.784173 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:16:04.810709 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:16:04.971214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:16:04.971921 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:16:04.979086 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:16:05.016775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a63733d-b048-4537-be37-f2d9e999a503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f87f1d8fa0>]}
[0m04:16:05.136069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a63733d-b048-4537-be37-f2d9e999a503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f87f190f70>]}
[0m04:16:05.136832 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:16:05.137468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a63733d-b048-4537-be37-f2d9e999a503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f87f1e35e0>]}
[0m04:16:05.235546 [info ] [MainThread]: 
[0m04:16:05.236632 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:16:05.238212 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:16:05.257172 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:16:05.257848 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:16:05.258360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:16:06.985986 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.727 seconds
[0m04:16:06.989273 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:16:07.372675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:16:07.387214 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:16:07.387651 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:16:07.388041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:16:08.247017 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.859 seconds
[0m04:16:08.249605 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:16:08.636949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a63733d-b048-4537-be37-f2d9e999a503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f882d39190>]}
[0m04:16:08.638163 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:16:08.638851 [info ] [MainThread]: 
[0m04:16:08.650787 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:16:08.651778 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:16:08.652835 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:16:08.653472 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:16:08.663027 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:16:08.663860 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:16:08.697982 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:16:08.699180 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:16:08.699640 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT 
    *
FROM streaming_db.public.stock_trades_raw
  );
[0m04:16:08.700134 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:16:09.713508 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.013 seconds
[0m04:16:09.747692 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:16:10.137046 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a63733d-b048-4537-be37-f2d9e999a503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f87f2a5c10>]}
[0m04:16:10.138743 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.48s]
[0m04:16:10.140292 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:16:10.142672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:16:10.143144 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:16:10.143666 [info ] [MainThread]: 
[0m04:16:10.144224 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.91 seconds (4.91s).
[0m04:16:10.145217 [debug] [MainThread]: Command end result
[0m04:16:10.182128 [info ] [MainThread]: 
[0m04:16:10.183169 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:16:10.183674 [info ] [MainThread]: 
[0m04:16:10.184284 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:16:10.185686 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.6940074, "process_user_time": 3.481741, "process_kernel_time": 1.441658, "process_mem_max_rss": "203372", "process_out_blocks": "1832", "process_in_blocks": "0"}
[0m04:16:10.186489 [debug] [MainThread]: Command `dbt run` succeeded at 04:16:10.186363 after 6.69 seconds
[0m04:16:10.187044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f884ea8a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f8550f7190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f8543e6c40>]}
[0m04:16:10.187539 [debug] [MainThread]: Flushing usage events
[0m04:16:15.522612 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m04:16:16.962254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dbbbac64c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dbb992bac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dbb98f0670>]}


============================== 04:16:16.969611 | a8915159-b913-4823-8f5b-1a713f48019f ==============================
[0m04:16:16.969611 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:16:16.970475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m04:16:18.159377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8915159-b913-4823-8f5b-1a713f48019f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db8b196b50>]}
[0m04:16:18.237562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8915159-b913-4823-8f5b-1a713f48019f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db8b15f760>]}
[0m04:16:18.238824 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:16:18.269181 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:16:18.484891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:16:18.485779 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:16:18.495679 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:16:18.543289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8915159-b913-4823-8f5b-1a713f48019f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dbb5e0f040>]}
[0m04:16:18.796971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8915159-b913-4823-8f5b-1a713f48019f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dbb9f4d8b0>]}
[0m04:16:18.797826 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:16:18.798416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8915159-b913-4823-8f5b-1a713f48019f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dbb9970910>]}
[0m04:16:18.800282 [info ] [MainThread]: 
[0m04:16:18.800846 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:16:18.803253 [debug] [MainThread]: Command end result
[0m04:16:18.841100 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.9524856, "process_user_time": 3.257671, "process_kernel_time": 1.596373, "process_mem_max_rss": "193092", "process_out_blocks": "1800", "process_in_blocks": "0"}
[0m04:16:18.843068 [debug] [MainThread]: Command `dbt test` succeeded at 04:16:18.842881 after 1.95 seconds
[0m04:16:18.843711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dbbbac64c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dbb9dd1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db8b196b50>]}
[0m04:16:18.844238 [debug] [MainThread]: Flushing usage events
[0m04:17:01.569304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e8a3c43a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e8a1a4e700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e8a1a4efa0>]}


============================== 04:17:01.575342 | eacadc7a-4f6c-4109-8a16-98c84b4f090b ==============================
[0m04:17:01.575342 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:17:01.575997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:17:02.468713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eacadc7a-4f6c-4109-8a16-98c84b4f090b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e87436df70>]}
[0m04:17:02.525520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eacadc7a-4f6c-4109-8a16-98c84b4f090b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e87436de80>]}
[0m04:17:02.526635 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:17:02.549292 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:17:02.772514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:17:02.773229 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:17:02.780491 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:17:02.822384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eacadc7a-4f6c-4109-8a16-98c84b4f090b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e89df74fa0>]}
[0m04:17:02.930421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eacadc7a-4f6c-4109-8a16-98c84b4f090b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e89df31f70>]}
[0m04:17:02.931220 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:17:02.931732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eacadc7a-4f6c-4109-8a16-98c84b4f090b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e89df7f5e0>]}
[0m04:17:03.017195 [info ] [MainThread]: 
[0m04:17:03.018243 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:17:03.019767 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:17:03.037895 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:17:03.038466 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:17:03.038945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:17:04.328807 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.290 seconds
[0m04:17:04.332159 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:17:04.728454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:17:04.742845 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:17:04.743460 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:17:04.743965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:17:05.652078 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.908 seconds
[0m04:17:05.654754 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:17:06.042253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eacadc7a-4f6c-4109-8a16-98c84b4f090b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e8a1ad31f0>]}
[0m04:17:06.043438 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:17:06.044024 [info ] [MainThread]: 
[0m04:17:06.053096 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:17:06.053853 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:17:06.054698 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:17:06.055263 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:17:06.064417 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:17:06.065226 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:17:06.094713 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:17:06.095683 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:17:06.096175 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT 
    *
FROM streaming_db.public.stock_trades_raw
  );
[0m04:17:06.096650 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:17:07.678690 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.582 seconds
[0m04:17:07.714724 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:17:08.087894 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eacadc7a-4f6c-4109-8a16-98c84b4f090b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e89e040c10>]}
[0m04:17:08.089127 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 2.03s]
[0m04:17:08.090081 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:17:08.092509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:17:08.092998 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:17:08.093621 [info ] [MainThread]: 
[0m04:17:08.094261 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.08 seconds (5.08s).
[0m04:17:08.095456 [debug] [MainThread]: Command end result
[0m04:17:08.133785 [info ] [MainThread]: 
[0m04:17:08.134627 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:17:08.135228 [info ] [MainThread]: 
[0m04:17:08.135843 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:17:08.137131 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.625967, "process_user_time": 3.19125, "process_kernel_time": 1.546587, "process_mem_max_rss": "203656", "process_out_blocks": "1832", "process_in_blocks": "0"}
[0m04:17:08.138022 [debug] [MainThread]: Command `dbt run` succeeded at 04:17:08.137885 after 6.63 seconds
[0m04:17:08.138585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e8a3c43a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e89df31370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e8731a5e80>]}
[0m04:17:08.139152 [debug] [MainThread]: Flushing usage events
[0m04:17:12.711424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70392977a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703927c80ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70392770b520>]}


============================== 04:17:12.722632 | 465bbb7d-2566-4e5a-9762-622695ec4a90 ==============================
[0m04:17:12.722632 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:17:12.724117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:17:13.775431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '465bbb7d-2566-4e5a-9762-622695ec4a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7039274ce5e0>]}
[0m04:17:13.836477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '465bbb7d-2566-4e5a-9762-622695ec4a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70390051ba60>]}
[0m04:17:13.837674 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:17:13.862520 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:17:14.009783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:17:14.010458 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:17:14.017573 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:17:14.057245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '465bbb7d-2566-4e5a-9762-622695ec4a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703923b002e0>]}
[0m04:17:14.272390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '465bbb7d-2566-4e5a-9762-622695ec4a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70392779a130>]}
[0m04:17:14.273137 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:17:14.273658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '465bbb7d-2566-4e5a-9762-622695ec4a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70392779a520>]}
[0m04:17:14.275146 [info ] [MainThread]: 
[0m04:17:14.275645 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:17:14.277738 [debug] [MainThread]: Command end result
[0m04:17:14.309066 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.6662394, "process_user_time": 2.974666, "process_kernel_time": 1.562073, "process_mem_max_rss": "192872", "process_out_blocks": "1792", "process_in_blocks": "0"}
[0m04:17:14.310123 [debug] [MainThread]: Command `dbt test` succeeded at 04:17:14.309907 after 1.67 seconds
[0m04:17:14.310850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70392977a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70392779a130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7039274ce5e0>]}
[0m04:17:14.311405 [debug] [MainThread]: Flushing usage events
[0m04:18:03.361706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e71da3e5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e71d88eeac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e71d8379520>]}


============================== 04:18:03.367993 | b6dcb512-db56-4294-9ecb-702423d69cd4 ==============================
[0m04:18:03.367993 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:18:03.368846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:18:04.266334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6dcb512-db56-4294-9ecb-702423d69cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e71d80805e0>]}
[0m04:18:04.325114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6dcb512-db56-4294-9ecb-702423d69cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e71b016da60>]}
[0m04:18:04.326313 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:18:04.352086 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:18:04.491387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:18:04.492019 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:18:04.499129 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:18:04.536584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6dcb512-db56-4294-9ecb-702423d69cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e71d476e2b0>]}
[0m04:18:04.655229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6dcb512-db56-4294-9ecb-702423d69cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e71d46e8340>]}
[0m04:18:04.655905 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:18:04.656411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6dcb512-db56-4294-9ecb-702423d69cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e71d4776760>]}
[0m04:18:04.750282 [info ] [MainThread]: 
[0m04:18:04.751221 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:18:04.752740 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:18:04.769773 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:18:04.770237 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:18:04.770803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:18:07.030360 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.259 seconds
[0m04:18:07.033556 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:18:07.751560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:18:07.767189 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:18:07.767789 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:18:07.768244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:18:09.639132 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.871 seconds
[0m04:18:09.642207 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:18:10.018286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6dcb512-db56-4294-9ecb-702423d69cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e71b00cce80>]}
[0m04:18:10.019470 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:18:10.020114 [info ] [MainThread]: 
[0m04:18:10.031095 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:18:10.032009 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:18:10.032920 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:18:10.033380 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:18:10.042715 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:18:10.043512 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:18:10.072696 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:18:10.073646 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:18:10.074194 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT 
    *
FROM streaming_db.public.stock_trades_raw
  );
[0m04:18:10.074646 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:18:11.070006 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.995 seconds
[0m04:18:11.101849 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:18:11.488213 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6dcb512-db56-4294-9ecb-702423d69cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e71d47e96d0>]}
[0m04:18:11.489346 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.45s]
[0m04:18:11.490267 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:18:11.492814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:18:11.493307 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:18:11.493844 [info ] [MainThread]: 
[0m04:18:11.494469 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.74 seconds (6.74s).
[0m04:18:11.495609 [debug] [MainThread]: Command end result
[0m04:18:11.528806 [info ] [MainThread]: 
[0m04:18:11.529545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:18:11.530022 [info ] [MainThread]: 
[0m04:18:11.530503 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:18:11.531705 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.224119, "process_user_time": 3.187854, "process_kernel_time": 1.582649, "process_mem_max_rss": "203072", "process_out_blocks": "1832", "process_in_blocks": "0"}
[0m04:18:11.532433 [debug] [MainThread]: Command `dbt run` succeeded at 04:18:11.532314 after 8.22 seconds
[0m04:18:11.532938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e71da3e5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e71b011fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e71b011c2b0>]}
[0m04:18:11.533412 [debug] [MainThread]: Flushing usage events
[0m04:18:20.707621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5bdb855a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5bdb5279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5bd96e03d0>]}


============================== 04:18:20.714006 | 69514680-a920-4623-8592-a4cbc4ca0051 ==============================
[0m04:18:20.714006 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:18:20.714655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m04:18:21.734342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69514680-a920-4623-8592-a4cbc4ca0051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5babf293a0>]}
[0m04:18:21.801895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69514680-a920-4623-8592-a4cbc4ca0051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5babf05340>]}
[0m04:18:21.803301 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:18:21.833351 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:18:22.025033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:18:22.025734 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:18:22.033989 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:18:22.075171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69514680-a920-4623-8592-a4cbc4ca0051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5bd5bc2fd0>]}
[0m04:18:22.291233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69514680-a920-4623-8592-a4cbc4ca0051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5bda47c4c0>]}
[0m04:18:22.292086 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:18:22.292613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69514680-a920-4623-8592-a4cbc4ca0051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5bd97d50d0>]}
[0m04:18:22.294094 [info ] [MainThread]: 
[0m04:18:22.294573 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:18:22.296668 [debug] [MainThread]: Command end result
[0m04:18:22.326676 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.6726952, "process_user_time": 2.896326, "process_kernel_time": 1.412383, "process_mem_max_rss": "193280", "process_out_blocks": "1784", "process_in_blocks": "0"}
[0m04:18:22.327529 [debug] [MainThread]: Command `dbt test` succeeded at 04:18:22.327407 after 1.67 seconds
[0m04:18:22.328057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5bdb855a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5bda48b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5babf293a0>]}
[0m04:18:22.328560 [debug] [MainThread]: Flushing usage events
[0m04:19:03.813202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b358cfcc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b358aea93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b358ae235e0>]}


============================== 04:19:03.820311 | e2234b73-9eaa-4d3a-9726-ddfcfd38489f ==============================
[0m04:19:03.820311 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:19:03.820966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:19:04.756406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2234b73-9eaa-4d3a-9726-ddfcfd38489f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3564492b80>]}
[0m04:19:04.818659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2234b73-9eaa-4d3a-9726-ddfcfd38489f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b358aeb33a0>]}
[0m04:19:04.819796 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:19:04.843694 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:19:04.989166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:19:04.989950 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:19:04.997138 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:19:05.036742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2234b73-9eaa-4d3a-9726-ddfcfd38489f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b35873942e0>]}
[0m04:19:05.157422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2234b73-9eaa-4d3a-9726-ddfcfd38489f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b358730ff40>]}
[0m04:19:05.158162 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:19:05.158680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2234b73-9eaa-4d3a-9726-ddfcfd38489f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b35873a0df0>]}
[0m04:19:05.260927 [info ] [MainThread]: 
[0m04:19:05.262342 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:19:05.263883 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:19:05.285208 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:19:05.285908 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:19:05.286336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:19:06.573056 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.286 seconds
[0m04:19:06.576569 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:19:06.956720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:19:06.971114 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:19:06.971759 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:19:06.972215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:19:08.715924 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.743 seconds
[0m04:19:08.718972 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:19:09.448672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2234b73-9eaa-4d3a-9726-ddfcfd38489f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b358aea9130>]}
[0m04:19:09.450176 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:19:09.450868 [info ] [MainThread]: 
[0m04:19:09.461708 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:19:09.462480 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:19:09.463443 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:19:09.463926 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:19:09.474642 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:19:09.475700 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:19:09.511550 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:19:09.512887 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:19:09.513464 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT 
    *
FROM streaming_db.public.stock_trades_raw
  );
[0m04:19:09.514053 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:19:10.505996 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.992 seconds
[0m04:19:10.568164 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:19:10.979030 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2234b73-9eaa-4d3a-9726-ddfcfd38489f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b35873e6f40>]}
[0m04:19:10.980193 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.51s]
[0m04:19:10.981528 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:19:10.984053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:19:10.984626 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:19:10.985120 [info ] [MainThread]: 
[0m04:19:10.985743 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.72 seconds (5.72s).
[0m04:19:10.986700 [debug] [MainThread]: Command end result
[0m04:19:11.022793 [info ] [MainThread]: 
[0m04:19:11.023562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:19:11.024057 [info ] [MainThread]: 
[0m04:19:11.024569 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:19:11.025849 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.271156, "process_user_time": 3.365665, "process_kernel_time": 1.566126, "process_mem_max_rss": "204276", "process_out_blocks": "1832", "process_in_blocks": "0"}
[0m04:19:11.026594 [debug] [MainThread]: Command `dbt run` succeeded at 04:19:11.026474 after 7.27 seconds
[0m04:19:11.027115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b358cfcc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3587305040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b355d165490>]}
[0m04:19:11.027662 [debug] [MainThread]: Flushing usage events
[0m04:19:17.706253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec9c08c7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec9be8314f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec9be8bf460>]}


============================== 04:19:17.712067 | 60f6ff68-ac05-446d-a86a-ecc51b3c7fd5 ==============================
[0m04:19:17.712067 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:19:17.712726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:19:18.594427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60f6ff68-ac05-446d-a86a-ecc51b3c7fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec998113610>]}
[0m04:19:18.653247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60f6ff68-ac05-446d-a86a-ecc51b3c7fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec99809ceb0>]}
[0m04:19:18.654259 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:19:18.676773 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:19:18.809487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:19:18.810192 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:19:18.817059 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:19:18.855312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60f6ff68-ac05-446d-a86a-ecc51b3c7fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec9bac1eee0>]}
[0m04:19:19.069539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60f6ff68-ac05-446d-a86a-ecc51b3c7fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec998120ac0>]}
[0m04:19:19.070358 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:19:19.070949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60f6ff68-ac05-446d-a86a-ecc51b3c7fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec998120040>]}
[0m04:19:19.072488 [info ] [MainThread]: 
[0m04:19:19.073020 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:19:19.075080 [debug] [MainThread]: Command end result
[0m04:19:19.105639 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.4542499, "process_user_time": 2.81062, "process_kernel_time": 1.416674, "process_mem_max_rss": "192848", "process_out_blocks": "1792", "process_in_blocks": "0"}
[0m04:19:19.106478 [debug] [MainThread]: Command `dbt test` succeeded at 04:19:19.106342 after 1.46 seconds
[0m04:19:19.107007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec9c08c7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec99807de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec998113610>]}
[0m04:19:19.107483 [debug] [MainThread]: Flushing usage events
[0m04:20:03.686837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984f9e4c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984f7ce83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984f7c625e0>]}


============================== 04:20:03.693057 | 29b3f997-a64b-453a-a64e-08d64c9f48d3 ==============================
[0m04:20:03.693057 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:20:03.693706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:20:04.694997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29b3f997-a64b-453a-a64e-08d64c9f48d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984d039db80>]}
[0m04:20:04.762077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29b3f997-a64b-453a-a64e-08d64c9f48d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984f7cf82e0>]}
[0m04:20:04.763283 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:20:04.792961 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:20:04.946110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:20:04.947075 [debug] [MainThread]: Partial parsing: updated file: crypto_transform://models/bronze/bronze_data.sql
[0m04:20:05.321576 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:20:05.340954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29b3f997-a64b-453a-a64e-08d64c9f48d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984f7c616d0>]}
[0m04:20:05.456235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29b3f997-a64b-453a-a64e-08d64c9f48d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984f3403250>]}
[0m04:20:05.456965 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:20:05.457515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29b3f997-a64b-453a-a64e-08d64c9f48d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984f3444940>]}
[0m04:20:05.459215 [info ] [MainThread]: 
[0m04:20:05.460005 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:20:05.461440 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:20:05.478910 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:20:05.479545 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:20:05.479948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:20:10.292385 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 4.812 seconds
[0m04:20:10.295735 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:20:10.679695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:20:10.695229 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:20:10.695935 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:20:10.696391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:20:11.597251 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.901 seconds
[0m04:20:11.600565 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:20:11.996102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29b3f997-a64b-453a-a64e-08d64c9f48d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984f33c8a90>]}
[0m04:20:11.997459 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:20:11.998170 [info ] [MainThread]: 
[0m04:20:12.009253 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:20:12.010157 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:20:12.010813 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:20:12.011545 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:20:12.022311 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:20:12.023418 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:20:12.056971 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:20:12.059025 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:20:12.059922 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:s::string AS ticker,           
    RECORD_CONTENT:p::float AS price,             
    RECORD_CONTENT:q::float AS quantity,          
    RECORD_CONTENT:T::timestamp AS trade_time,    -- 'T' = Trade Time
    RECORD_CONTENT:t::int AS trade_id,            -- 't' = Trade ID
    RECORD_CONTENT:b::int AS buyer_order_id,      -- 'b' = Buyer Order ID
    RECORD_CONTENT:a::int AS seller_order_id,     -- 'a' = Seller Order ID
    RECORD_CONTENT:m::boolean AS is_buyer_maker,  -- 'm' = Is Buyer Maker
    RECORD_CONTENT:e::string AS event_type,       -- 'e' = Event Type
    RECORD_CONTENT:E::timestamp AS event_time     -- 'E' = Event Time
    
FROM streaming_db.public.stock_trades_raw
  );
[0m04:20:12.060439 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:20:13.046886 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.986 seconds
[0m04:20:13.094747 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:20:13.497826 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b3f997-a64b-453a-a64e-08d64c9f48d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984f33c8a90>]}
[0m04:20:13.498945 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.49s]
[0m04:20:13.500004 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:20:13.502197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:20:13.502688 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:20:13.503260 [info ] [MainThread]: 
[0m04:20:13.503897 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.04 seconds (8.04s).
[0m04:20:13.504794 [debug] [MainThread]: Command end result
[0m04:20:13.539735 [info ] [MainThread]: 
[0m04:20:13.540450 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:20:13.540961 [info ] [MainThread]: 
[0m04:20:13.541721 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:20:13.543165 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.92996, "process_user_time": 3.488757, "process_kernel_time": 1.774454, "process_mem_max_rss": "207832", "process_out_blocks": "2720", "process_in_blocks": "0"}
[0m04:20:13.543929 [debug] [MainThread]: Command `dbt run` succeeded at 04:20:13.543808 after 9.93 seconds
[0m04:20:13.544535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984f9e4c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984f9ab04f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984f3403f70>]}
[0m04:20:13.545009 [debug] [MainThread]: Flushing usage events
[0m04:20:22.010481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766db735d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766db5866ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766db52f1520>]}


============================== 04:20:22.017059 | e8ab65e6-9916-44e2-8fcd-2357f3d3fa54 ==============================
[0m04:20:22.017059 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:20:22.017794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:20:23.091753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8ab65e6-9916-44e2-8fcd-2357f3d3fa54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766db50b75e0>]}
[0m04:20:23.184098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8ab65e6-9916-44e2-8fcd-2357f3d3fa54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766d869f3a60>]}
[0m04:20:23.185239 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:20:23.210749 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:20:23.349008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:20:23.349971 [debug] [MainThread]: Partial parsing: updated file: crypto_transform://models/bronze/bronze_data.sql
[0m04:20:23.694499 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:20:23.711626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8ab65e6-9916-44e2-8fcd-2357f3d3fa54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766db51723d0>]}
[0m04:20:23.829390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8ab65e6-9916-44e2-8fcd-2357f3d3fa54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766db089c400>]}
[0m04:20:23.830236 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:20:23.830788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8ab65e6-9916-44e2-8fcd-2357f3d3fa54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766db15a3370>]}
[0m04:20:23.832318 [info ] [MainThread]: 
[0m04:20:23.832822 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:20:23.833533 [debug] [MainThread]: Command end result
[0m04:20:23.865431 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.9170465, "process_user_time": 3.277468, "process_kernel_time": 1.547903, "process_mem_max_rss": "196728", "process_in_blocks": "8", "process_out_blocks": "2680"}
[0m04:20:23.866483 [debug] [MainThread]: Command `dbt test` succeeded at 04:20:23.866351 after 1.92 seconds
[0m04:20:23.867004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766db735d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766db6fb4130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766d868b2730>]}
[0m04:20:23.867505 [debug] [MainThread]: Flushing usage events
[0m04:21:03.370263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a068e8a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a066ceeac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a066cb0670>]}


============================== 04:21:03.385222 | 0cbf018c-b024-41c4-9b4e-4399e7e9a64d ==============================
[0m04:21:03.385222 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:21:03.386292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:21:04.366809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cbf018c-b024-41c4-9b4e-4399e7e9a64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a040194b50>]}
[0m04:21:04.427729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cbf018c-b024-41c4-9b4e-4399e7e9a64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a040173730>]}
[0m04:21:04.428878 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:21:04.452511 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:21:04.593176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:21:04.594137 [debug] [MainThread]: Partial parsing: updated file: crypto_transform://models/bronze/bronze_data.sql
[0m04:21:04.962515 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:21:04.979662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cbf018c-b024-41c4-9b4e-4399e7e9a64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a066cff190>]}
[0m04:21:05.091811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cbf018c-b024-41c4-9b4e-4399e7e9a64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a062441880>]}
[0m04:21:05.092583 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:21:05.093084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cbf018c-b024-41c4-9b4e-4399e7e9a64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a062479310>]}
[0m04:21:05.094799 [info ] [MainThread]: 
[0m04:21:05.095520 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:21:05.096762 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:21:05.111981 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:21:05.112596 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:21:05.113165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:21:06.462127 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.349 seconds
[0m04:21:06.465231 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:21:06.855305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:21:06.868731 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:21:06.869288 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:21:06.869789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:21:08.391454 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.522 seconds
[0m04:21:08.394104 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:21:08.770989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cbf018c-b024-41c4-9b4e-4399e7e9a64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a06240b1c0>]}
[0m04:21:08.772199 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:21:08.772802 [info ] [MainThread]: 
[0m04:21:08.783187 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:21:08.784098 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:21:08.785074 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:21:08.785635 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:21:08.795291 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:21:08.796240 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:21:08.829223 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:21:08.830892 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:21:08.831425 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:s::string AS ticker,           
    RECORD_CONTENT:p::float AS price,             
    RECORD_CONTENT:q::float AS quantity,          
    RECORD_CONTENT:T::timestamp AS trade_time,    
    RECORD_CONTENT:t::int AS trade_id,            
    RECORD_CONTENT:b::int AS buyer_order_id,      
    RECORD_CONTENT:a::int AS seller_order_id,     
    RECORD_CONTENT:m::boolean AS is_buyer_maker,  
    RECORD_CONTENT:e::string AS event_type,       
    RECORD_CONTENT:E::timestamp AS event_time     
    
FROM streaming_db.public.stock_trades_raw
  );
[0m04:21:08.831904 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:21:09.795232 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.963 seconds
[0m04:21:09.829815 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:21:10.214431 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cbf018c-b024-41c4-9b4e-4399e7e9a64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a062438310>]}
[0m04:21:10.215585 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.43s]
[0m04:21:10.216630 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:21:10.219014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:21:10.219490 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:21:10.219960 [info ] [MainThread]: 
[0m04:21:10.220646 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.12 seconds (5.12s).
[0m04:21:10.221762 [debug] [MainThread]: Command end result
[0m04:21:10.255710 [info ] [MainThread]: 
[0m04:21:10.256425 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:21:10.256887 [info ] [MainThread]: 
[0m04:21:10.257372 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:21:10.258580 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.987812, "process_user_time": 3.464574, "process_kernel_time": 1.617554, "process_mem_max_rss": "207364", "process_out_blocks": "2728", "process_in_blocks": "0"}
[0m04:21:10.259337 [debug] [MainThread]: Command `dbt run` succeeded at 04:21:10.259192 after 6.99 seconds
[0m04:21:10.259883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a068e8a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a040173730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a06240b190>]}
[0m04:21:10.260344 [debug] [MainThread]: Flushing usage events
[0m04:21:14.890854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a6e19da190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a6df83eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a6df805670>]}


============================== 04:21:14.897100 | 6a3e0e14-0d6d-4022-8d73-f729fa533393 ==============================
[0m04:21:14.897100 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:21:14.897798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:21:15.816340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a3e0e14-0d6d-4022-8d73-f729fa533393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a6b10c3b50>]}
[0m04:21:15.874650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a3e0e14-0d6d-4022-8d73-f729fa533393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a6b10a1730>]}
[0m04:21:15.875658 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:21:15.898804 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:21:16.031652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:21:16.032363 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:21:16.039494 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:21:16.079170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a3e0e14-0d6d-4022-8d73-f729fa533393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a6dbd63040>]}
[0m04:21:16.298359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a3e0e14-0d6d-4022-8d73-f729fa533393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a6df880460>]}
[0m04:21:16.299228 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:21:16.299794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a3e0e14-0d6d-4022-8d73-f729fa533393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a6dbd60fd0>]}
[0m04:21:16.301396 [info ] [MainThread]: 
[0m04:21:16.301895 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:21:16.303964 [debug] [MainThread]: Command end result
[0m04:21:16.337491 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5038822, "process_user_time": 2.747832, "process_kernel_time": 1.590651, "process_mem_max_rss": "192596", "process_in_blocks": "192", "process_out_blocks": "1800"}
[0m04:21:16.338359 [debug] [MainThread]: Command `dbt test` succeeded at 04:21:16.338216 after 1.50 seconds
[0m04:21:16.338899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a6e19da190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a6e0629550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a6b10c3b50>]}
[0m04:21:16.339454 [debug] [MainThread]: Flushing usage events
[0m04:22:03.829330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079a5f013d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079a4387ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079a3e92520>]}


============================== 04:22:03.835771 | 09ff7b11-396d-42a6-9cd1-6bb5592b7666 ==============================
[0m04:22:03.835771 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:22:03.836476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:22:04.864827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09ff7b11-396d-42a6-9cd1-6bb5592b7666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079a3c5a5e0>]}
[0m04:22:04.921710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09ff7b11-396d-42a6-9cd1-6bb5592b7666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70797cc98a60>]}
[0m04:22:04.922748 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:22:04.945618 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:22:05.082903 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:22:05.083554 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:22:05.090498 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:22:05.129396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09ff7b11-396d-42a6-9cd1-6bb5592b7666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079a02472b0>]}
[0m04:22:05.242842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09ff7b11-396d-42a6-9cd1-6bb5592b7666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079a0200340>]}
[0m04:22:05.243628 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:22:05.244250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09ff7b11-396d-42a6-9cd1-6bb5592b7666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079a024f760>]}
[0m04:22:05.333085 [info ] [MainThread]: 
[0m04:22:05.333967 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:22:05.335516 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:22:05.351668 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:22:05.352091 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:22:05.352627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:22:06.653268 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.300 seconds
[0m04:22:06.657040 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:22:07.068105 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db_public'
[0m04:22:07.081376 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:22:07.081981 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:22:07.082513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:22:08.608593 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.526 seconds
[0m04:22:08.611438 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:22:09.019096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09ff7b11-396d-42a6-9cd1-6bb5592b7666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70797c3cce80>]}
[0m04:22:09.020184 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:22:09.020826 [info ] [MainThread]: 
[0m04:22:09.031199 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:22:09.031963 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:22:09.032876 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:22:09.033393 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:22:09.042363 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:22:09.043122 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:22:09.073128 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:22:09.074765 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:22:09.075273 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:s::string AS ticker,           
    RECORD_CONTENT:p::float AS price,             
    RECORD_CONTENT:q::float AS quantity,          
    RECORD_CONTENT:T::timestamp AS trade_time,    
    RECORD_CONTENT:t::int AS trade_id,            
    RECORD_CONTENT:b::int AS buyer_order_id,      
    RECORD_CONTENT:a::int AS seller_order_id,     
    RECORD_CONTENT:m::boolean AS is_buyer_maker,  
    RECORD_CONTENT:e::string AS event_type,       
    RECORD_CONTENT:E::timestamp AS event_time     
    
FROM streaming_db.public.stock_trades_raw
  );
[0m04:22:09.075814 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:22:10.063250 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.987 seconds
[0m04:22:10.097001 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:22:09.944047 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09ff7b11-396d-42a6-9cd1-6bb5592b7666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70797d8a0f40>]}
[0m04:22:09.945204 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 0.91s]
[0m04:22:09.946144 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:22:09.948469 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:22:09.948953 [debug] [MainThread]: Connection 'list_streaming_db' was properly closed.
[0m04:22:09.949410 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:22:09.949968 [info ] [MainThread]: 
[0m04:22:09.950602 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.62 seconds (4.62s).
[0m04:22:09.951750 [debug] [MainThread]: Command end result
[0m04:22:09.985580 [info ] [MainThread]: 
[0m04:22:09.986367 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:22:09.986895 [info ] [MainThread]: 
[0m04:22:09.987470 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:22:09.988808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.7638907, "process_user_time": 3.207269, "process_kernel_time": 1.717099, "process_mem_max_rss": "204132", "process_out_blocks": "1840", "process_in_blocks": "0"}
[0m04:22:09.989610 [debug] [MainThread]: Command `dbt run` succeeded at 04:22:09.989489 after 6.76 seconds
[0m04:22:09.990138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079a5f013d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70797cc50a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70799fdb74c0>]}
[0m04:22:09.990658 [debug] [MainThread]: Flushing usage events
[0m04:22:14.947127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705ff12374c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705fef09bac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705fef050670>]}


============================== 04:22:14.953793 | a885b1ee-f268-45f6-86c6-88c5ec845662 ==============================
[0m04:22:14.953793 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:22:14.954612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m04:22:15.896364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a885b1ee-f268-45f6-86c6-88c5ec845662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705fc1904b50>]}
[0m04:22:15.958087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a885b1ee-f268-45f6-86c6-88c5ec845662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705fc18da760>]}
[0m04:22:15.959176 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:22:15.984201 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:22:16.134262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:22:16.134907 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:22:16.141846 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:22:16.182932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a885b1ee-f268-45f6-86c6-88c5ec845662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705feb581040>]}
[0m04:22:16.424359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a885b1ee-f268-45f6-86c6-88c5ec845662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705fef0da400>]}
[0m04:22:16.425348 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:22:16.425939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a885b1ee-f268-45f6-86c6-88c5ec845662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705feb578fd0>]}
[0m04:22:16.428244 [info ] [MainThread]: 
[0m04:22:16.428879 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:22:16.433074 [debug] [MainThread]: Command end result
[0m04:22:16.474271 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5887765, "process_user_time": 2.958288, "process_kernel_time": 1.545262, "process_mem_max_rss": "192936", "process_in_blocks": "504", "process_out_blocks": "1792"}
[0m04:22:16.475127 [debug] [MainThread]: Command `dbt test` succeeded at 04:22:16.475002 after 1.59 seconds
[0m04:22:16.475649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705ff12374c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705fefe87550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705fc1904b50>]}
[0m04:22:16.476395 [debug] [MainThread]: Flushing usage events
[0m04:23:03.527547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c681016460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c67eeb43a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c67ee2c5e0>]}


============================== 04:23:03.537134 | bca54fcb-80a0-42b4-891b-7a6c8fbc3ab8 ==============================
[0m04:23:03.537134 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:23:03.537930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:23:04.498245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bca54fcb-80a0-42b4-891b-7a6c8fbc3ab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c6584acb80>]}
[0m04:23:04.563718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bca54fcb-80a0-42b4-891b-7a6c8fbc3ab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c67eebc3a0>]}
[0m04:23:04.564829 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:23:04.589674 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:23:04.742627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:23:04.743303 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:23:04.751449 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:23:04.796792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bca54fcb-80a0-42b4-891b-7a6c8fbc3ab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c67b3a12e0>]}
[0m04:23:04.915300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bca54fcb-80a0-42b4-891b-7a6c8fbc3ab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c67b318f40>]}
[0m04:23:04.916083 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:23:04.916599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bca54fcb-80a0-42b4-891b-7a6c8fbc3ab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c67b3a1f40>]}
[0m04:23:05.012859 [info ] [MainThread]: 
[0m04:23:05.014015 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:23:05.015604 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:23:05.033804 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:23:05.034448 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:23:05.034869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:23:05.887353 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.663 seconds
[0m04:23:05.890402 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:23:06.282650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:23:06.296716 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:23:06.297409 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:23:06.297875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:23:07.160420 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.862 seconds
[0m04:23:07.163171 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:23:07.578744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bca54fcb-80a0-42b4-891b-7a6c8fbc3ab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c67b41a2e0>]}
[0m04:23:07.580073 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:23:07.580830 [info ] [MainThread]: 
[0m04:23:07.591269 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:23:07.592251 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:23:07.593271 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:23:07.593757 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:23:07.604969 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:23:07.606085 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:23:07.638600 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:23:07.640293 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:23:07.640874 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:s::string AS ticker,           
    RECORD_CONTENT:p::float AS price,             
    RECORD_CONTENT:q::float AS quantity,          
    RECORD_CONTENT:T::timestamp AS trade_time,    
    RECORD_CONTENT:t::int AS trade_id,            
    RECORD_CONTENT:b::int AS buyer_order_id,      
    RECORD_CONTENT:a::int AS seller_order_id,     
    RECORD_CONTENT:m::boolean AS is_buyer_maker,  
    RECORD_CONTENT:e::string AS event_type,       
    RECORD_CONTENT:E::timestamp AS event_time     
    
FROM streaming_db.public.stock_trades_raw
  );
[0m04:23:07.641365 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:23:08.640665 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.999 seconds
[0m04:23:08.674085 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:23:09.069509 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bca54fcb-80a0-42b4-891b-7a6c8fbc3ab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c67eebcf40>]}
[0m04:23:09.070774 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.47s]
[0m04:23:09.071699 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:23:09.073983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:23:09.074481 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:23:09.074976 [info ] [MainThread]: 
[0m04:23:09.075545 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.06 seconds (4.06s).
[0m04:23:09.076536 [debug] [MainThread]: Command end result
[0m04:23:09.117315 [info ] [MainThread]: 
[0m04:23:09.118096 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:23:09.118659 [info ] [MainThread]: 
[0m04:23:09.119177 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:23:09.120436 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.513016, "process_user_time": 3.420348, "process_kernel_time": 1.627119, "process_mem_max_rss": "203432", "process_out_blocks": "1832", "process_in_blocks": "0"}
[0m04:23:09.121344 [debug] [MainThread]: Command `dbt run` succeeded at 04:23:09.121217 after 6.51 seconds
[0m04:23:09.121962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c681016460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c67b318f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c6584b2a30>]}
[0m04:23:09.122608 [debug] [MainThread]: Flushing usage events
[0m04:23:15.093174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a89054384c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a890329eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8903260670>]}


============================== 04:23:15.099369 | b5bb3ca2-eaf4-4c5c-abbf-f46b1149d36a ==============================
[0m04:23:15.099369 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:23:15.100036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:23:16.079551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5bb3ca2-eaf4-4c5c-abbf-f46b1149d36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a88d5904b50>]}
[0m04:23:16.138885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5bb3ca2-eaf4-4c5c-abbf-f46b1149d36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a88d58e2730>]}
[0m04:23:16.139977 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:23:16.164439 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:23:16.317801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:23:16.318455 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:23:16.325593 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:23:16.366171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5bb3ca2-eaf4-4c5c-abbf-f46b1149d36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a88ff783040>]}
[0m04:23:16.577258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5bb3ca2-eaf4-4c5c-abbf-f46b1149d36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a89032e03d0>]}
[0m04:23:16.577956 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:23:16.578449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5bb3ca2-eaf4-4c5c-abbf-f46b1149d36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a88ff77afd0>]}
[0m04:23:16.579917 [info ] [MainThread]: 
[0m04:23:16.580467 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:23:16.582628 [debug] [MainThread]: Command end result
[0m04:23:16.613540 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5815078, "process_user_time": 3.083465, "process_kernel_time": 1.628009, "process_mem_max_rss": "192740", "process_in_blocks": "216", "process_out_blocks": "1792"}
[0m04:23:16.614505 [debug] [MainThread]: Command `dbt test` succeeded at 04:23:16.614382 after 1.58 seconds
[0m04:23:16.615027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a89054384c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8904089550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a88d5904b50>]}
[0m04:23:16.615530 [debug] [MainThread]: Flushing usage events
[0m04:24:02.784541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e8053153d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e8037daac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e8032e5520>]}


============================== 04:24:02.790365 | 6c90f751-7b41-476f-a206-5612d791b254 ==============================
[0m04:24:02.790365 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:24:02.791026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:24:02.401739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c90f751-7b41-476f-a206-5612d791b254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e8030aa5e0>]}
[0m04:24:02.461295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c90f751-7b41-476f-a206-5612d791b254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e7dc0faa60>]}
[0m04:24:02.462378 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:24:02.485485 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:24:02.657387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:24:02.657984 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:24:02.664787 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:24:02.702901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c90f751-7b41-476f-a206-5612d791b254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e7ff6da2b0>]}
[0m04:24:02.820531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c90f751-7b41-476f-a206-5612d791b254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e7ff654340>]}
[0m04:24:02.821424 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:24:02.822094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c90f751-7b41-476f-a206-5612d791b254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e7ff6e5760>]}
[0m04:24:02.943669 [info ] [MainThread]: 
[0m04:24:02.945668 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:24:02.948596 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:24:02.978659 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:24:02.979330 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:24:02.979756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:24:04.674602 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.695 seconds
[0m04:24:04.678054 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:24:05.048310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:24:05.062980 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:24:05.063594 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:24:05.064078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:24:06.550884 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.487 seconds
[0m04:24:06.553721 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:24:06.931386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c90f751-7b41-476f-a206-5612d791b254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e7dc04ee80>]}
[0m04:24:06.932534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:24:06.933180 [info ] [MainThread]: 
[0m04:24:06.944261 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:24:06.944954 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:24:06.945793 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:24:06.946257 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:24:06.955633 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:24:06.956390 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:24:06.985563 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:24:06.986979 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:24:06.987486 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:s::string AS ticker,           
    RECORD_CONTENT:p::float AS price,             
    RECORD_CONTENT:q::float AS quantity,          
    RECORD_CONTENT:T::timestamp AS trade_time,    
    RECORD_CONTENT:t::int AS trade_id,            
    RECORD_CONTENT:b::int AS buyer_order_id,      
    RECORD_CONTENT:a::int AS seller_order_id,     
    RECORD_CONTENT:m::boolean AS is_buyer_maker,  
    RECORD_CONTENT:e::string AS event_type,       
    RECORD_CONTENT:E::timestamp AS event_time     
    
FROM streaming_db.public.stock_trades_raw
  );
[0m04:24:06.987979 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:24:08.362489 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.374 seconds
[0m04:24:08.398765 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:24:08.802773 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c90f751-7b41-476f-a206-5612d791b254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e7ff7556d0>]}
[0m04:24:08.804395 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.85s]
[0m04:24:08.805470 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:24:08.808087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:24:08.808637 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:24:08.809279 [info ] [MainThread]: 
[0m04:24:08.810171 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.86 seconds (5.86s).
[0m04:24:08.811484 [debug] [MainThread]: Command end result
[0m04:24:08.846996 [info ] [MainThread]: 
[0m04:24:08.847738 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:24:08.848264 [info ] [MainThread]: 
[0m04:24:08.848863 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:24:08.850068 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3996024, "process_user_time": 3.2911, "process_kernel_time": 1.601997, "process_mem_max_rss": "203892", "process_out_blocks": "1840", "process_in_blocks": "0"}
[0m04:24:08.850829 [debug] [MainThread]: Command `dbt run` succeeded at 04:24:08.850709 after 7.40 seconds
[0m04:24:08.851374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e8053153d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e7dc0faa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e7dc0acaf0>]}
[0m04:24:08.851869 [debug] [MainThread]: Flushing usage events
[0m04:24:14.748610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78658e3c34f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78658f408d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78658c358ac0>]}


============================== 04:24:14.755234 | 4845081f-5e00-42b9-add8-8bc4d6dd8e87 ==============================
[0m04:24:14.755234 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:24:14.756059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m04:24:15.788527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4845081f-5e00-42b9-add8-8bc4d6dd8e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7865641f3850>]}
[0m04:24:15.851477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4845081f-5e00-42b9-add8-8bc4d6dd8e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7865641b1d30>]}
[0m04:24:15.852817 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:24:15.877474 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:24:16.018938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:24:16.019607 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:24:16.027351 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:24:16.066863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4845081f-5e00-42b9-add8-8bc4d6dd8e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78658874c040>]}
[0m04:24:16.295086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4845081f-5e00-42b9-add8-8bc4d6dd8e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78658c266b50>]}
[0m04:24:16.295957 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:24:16.296563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4845081f-5e00-42b9-add8-8bc4d6dd8e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78658c266fa0>]}
[0m04:24:16.298627 [info ] [MainThread]: 
[0m04:24:16.299247 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:24:16.301696 [debug] [MainThread]: Command end result
[0m04:24:16.336123 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.645522, "process_user_time": 3.102441, "process_kernel_time": 1.52073, "process_mem_max_rss": "192644", "process_in_blocks": "272", "process_out_blocks": "1792"}
[0m04:24:16.337085 [debug] [MainThread]: Command `dbt test` succeeded at 04:24:16.336933 after 1.65 seconds
[0m04:24:16.337672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78658e3c34f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78658cff8430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7865641036a0>]}
[0m04:24:16.338216 [debug] [MainThread]: Flushing usage events
[0m04:25:03.442069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e98651a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e965bb4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e96649460>]}


============================== 04:25:03.448612 | 0c0d534d-7412-4089-a9c9-2d09c523e656 ==============================
[0m04:25:03.448612 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:25:03.449275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:25:04.415692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c0d534d-7412-4089-a9c9-2d09c523e656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e68cf1610>]}
[0m04:25:04.476963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c0d534d-7412-4089-a9c9-2d09c523e656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e68c78ee0>]}
[0m04:25:04.478157 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:25:04.502191 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:25:04.644858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:25:04.645860 [debug] [MainThread]: Partial parsing: updated file: crypto_transform://models/bronze/bronze_data.sql
[0m04:25:05.020873 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:25:05.039817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c0d534d-7412-4089-a9c9-2d09c523e656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e92930dc0>]}
[0m04:25:05.156487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c0d534d-7412-4089-a9c9-2d09c523e656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e91bdba30>]}
[0m04:25:05.157196 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:25:05.157702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c0d534d-7412-4089-a9c9-2d09c523e656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e91c1d8b0>]}
[0m04:25:05.159351 [info ] [MainThread]: 
[0m04:25:05.160094 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:25:05.161413 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:25:05.179060 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:25:05.179761 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:25:05.180166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:25:06.859920 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.679 seconds
[0m04:25:06.862837 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:25:07.246025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:25:07.261435 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:25:07.262167 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:25:07.262572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:25:09.259272 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.997 seconds
[0m04:25:09.262074 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:25:09.655644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c0d534d-7412-4089-a9c9-2d09c523e656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e91bae190>]}
[0m04:25:09.656792 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:25:09.657451 [info ] [MainThread]: 
[0m04:25:09.671682 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:25:09.672546 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:25:09.673540 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:25:09.674049 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:25:09.684118 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:25:09.685026 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:25:09.718846 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:25:09.720872 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:25:09.721615 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:s::ticer AS ticker,           
    RECORD_CONTENT:p::price AS price,             
    RECORD_CONTENT:q::quantity AS quantity,          
    RECORD_CONTENT:T::timestamp AS trade_time,    
    RECORD_CONTENT:t::int AS trade_id,            
    RECORD_CONTENT:b::int AS buyer_order_id,      
    RECORD_CONTENT:a::int AS seller_order_id,     
    RECORD_CONTENT:m::boolean AS is_buyer_maker,  
    RECORD_CONTENT:e::string AS event_type,       
    RECORD_CONTENT:E::timestamp AS event_time     
    
FROM streaming_db.public.stock_trades_raw
  );
[0m04:25:09.722260 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:25:11.933632 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0f309-0001-ba9c-0001-85aa0003922a
[0m04:25:11.934388 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002040 (42601): SQL compilation error:
Unsupported data type 'TICER'.
[0m04:25:11.935264 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:25:12.322243 [debug] [Thread-1  ]: Database Error in model bronze_data (models/bronze/bronze_data.sql)
  002040 (42601): SQL compilation error:
  Unsupported data type 'TICER'.
  compiled code at target/run/crypto_transform/models/bronze/bronze_data.sql
[0m04:25:12.325580 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c0d534d-7412-4089-a9c9-2d09c523e656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e8a91ebb0>]}
[0m04:25:12.326650 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.bronze_data ........................ [[31mERROR[0m in 2.65s]
[0m04:25:12.327748 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:25:12.330583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:25:12.331089 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:25:12.331586 [info ] [MainThread]: 
[0m04:25:12.332149 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.17 seconds (7.17s).
[0m04:25:12.333143 [debug] [MainThread]: Command end result
[0m04:25:12.372577 [info ] [MainThread]: 
[0m04:25:12.373352 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:25:12.373880 [info ] [MainThread]: 
[0m04:25:12.374527 [error] [MainThread]:   Database Error in model bronze_data (models/bronze/bronze_data.sql)
  002040 (42601): SQL compilation error:
  Unsupported data type 'TICER'.
  compiled code at target/run/crypto_transform/models/bronze/bronze_data.sql
[0m04:25:12.374991 [info ] [MainThread]: 
[0m04:25:12.375508 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:25:12.377047 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.995933, "process_user_time": 3.464174, "process_kernel_time": 1.665832, "process_mem_max_rss": "207648", "process_out_blocks": "2720", "command_success": false, "process_in_blocks": "0"}
[0m04:25:12.377874 [debug] [MainThread]: Command `dbt run` failed at 04:25:12.377739 after 9.00 seconds
[0m04:25:12.378456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e98651a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e91bdba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e68cf1610>]}
[0m04:25:12.378927 [debug] [MainThread]: Flushing usage events
[0m04:26:03.346852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d3e4f27a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d3e2e914f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d3e2f1f460>]}


============================== 04:26:03.356471 | 81ec028a-a173-4560-9f20-dabb05dbcab5 ==============================
[0m04:26:03.356471 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:26:03.357658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:26:04.364474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81ec028a-a173-4560-9f20-dabb05dbcab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d3b51c8610>]}
[0m04:26:04.430447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81ec028a-a173-4560-9f20-dabb05dbcab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d3b5152eb0>]}
[0m04:26:04.431644 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:26:04.462510 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:26:04.714548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:26:04.715500 [debug] [MainThread]: Partial parsing: updated file: crypto_transform://models/bronze/bronze_data.sql
[0m04:26:05.077456 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:26:05.093699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81ec028a-a173-4560-9f20-dabb05dbcab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d3df206dc0>]}
[0m04:26:05.203614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81ec028a-a173-4560-9f20-dabb05dbcab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d3de4b1a30>]}
[0m04:26:05.204313 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:26:05.204899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81ec028a-a173-4560-9f20-dabb05dbcab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d3de4eb940>]}
[0m04:26:05.206556 [info ] [MainThread]: 
[0m04:26:05.207298 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:26:05.208588 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:26:05.224657 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:26:05.225260 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:26:05.225891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:26:06.517573 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.291 seconds
[0m04:26:06.520537 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:26:06.910988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:26:06.928370 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:26:06.929310 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:26:06.929817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:26:08.490595 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.561 seconds
[0m04:26:08.493461 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:26:08.871884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81ec028a-a173-4560-9f20-dabb05dbcab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d3de481190>]}
[0m04:26:08.873536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:26:08.874540 [info ] [MainThread]: 
[0m04:26:08.889808 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:26:08.891287 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:26:08.893007 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:26:08.894014 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:26:08.907941 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:26:08.910022 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:26:08.945506 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:26:08.947346 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:26:08.947871 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:s::ticer AS ticker,           
    RECORD_CONTENT:p::price AS price,             
    RECORD_CONTENT:q::quantity AS quantity,          
    RECORD_CONTENT:T::timestamp AS trade_time,    
    RECORD_CONTENT:t::trade_id AS trade_id,            
    RECORD_CONTENT:b::buyer_order_id AS buyer_order_id,      
    RECORD_CONTENT:a::seller_order_id AS seller_order_id,     
    RECORD_CONTENT:m::boolean AS is_buyer_maker,  
    RECORD_CONTENT:e::string AS event_type,       
    RECORD_CONTENT:E::timestamp AS event_time     
    
FROM streaming_db.public.stock_trades_raw
  );
[0m04:26:08.948364 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:26:10.448235 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0f30a-0001-ba8f-0001-85aa00038236
[0m04:26:10.448935 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002040 (42601): SQL compilation error:
Unsupported data type 'TICER'.
[0m04:26:10.449742 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:26:10.842842 [debug] [Thread-1  ]: Database Error in model bronze_data (models/bronze/bronze_data.sql)
  002040 (42601): SQL compilation error:
  Unsupported data type 'TICER'.
  compiled code at target/run/crypto_transform/models/bronze/bronze_data.sql
[0m04:26:10.845874 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81ec028a-a173-4560-9f20-dabb05dbcab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d3d71f2bb0>]}
[0m04:26:10.846889 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.bronze_data ........................ [[31mERROR[0m in 1.95s]
[0m04:26:10.847952 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:26:10.850494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:26:10.851034 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:26:10.851513 [info ] [MainThread]: 
[0m04:26:10.852178 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.64 seconds (5.64s).
[0m04:26:10.853458 [debug] [MainThread]: Command end result
[0m04:26:10.892153 [info ] [MainThread]: 
[0m04:26:10.892919 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:26:10.893444 [info ] [MainThread]: 
[0m04:26:10.894058 [error] [MainThread]:   Database Error in model bronze_data (models/bronze/bronze_data.sql)
  002040 (42601): SQL compilation error:
  Unsupported data type 'TICER'.
  compiled code at target/run/crypto_transform/models/bronze/bronze_data.sql
[0m04:26:10.894522 [info ] [MainThread]: 
[0m04:26:10.895113 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:26:10.896481 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.6122527, "process_user_time": 3.555664, "process_kernel_time": 1.689783, "process_mem_max_rss": "208032", "process_in_blocks": "568", "process_out_blocks": "2720", "command_success": false}
[0m04:26:10.897334 [debug] [MainThread]: Command `dbt run` failed at 04:26:10.897160 after 7.61 seconds
[0m04:26:10.897886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d3e4f27a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d3de4b1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d3b51c8610>]}
[0m04:26:10.898367 [debug] [MainThread]: Flushing usage events
[0m04:27:03.736321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7103e5d72a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7103e3b7e700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7103e3b7efa0>]}


============================== 04:27:03.744791 | 4db5c5df-512d-4c75-986a-b3a10eeda0ad ==============================
[0m04:27:03.744791 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:27:03.745773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:27:04.973483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4db5c5df-512d-4c75-986a-b3a10eeda0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7103bcb6ef70>]}
[0m04:27:05.033518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4db5c5df-512d-4c75-986a-b3a10eeda0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7103bcb6ee80>]}
[0m04:27:05.034664 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:27:05.058846 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:27:05.204423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:27:05.205847 [debug] [MainThread]: Partial parsing: updated file: crypto_transform://models/bronze/bronze_data.sql
[0m04:27:05.580947 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:27:05.598817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4db5c5df-512d-4c75-986a-b3a10eeda0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7103e000f190>]}
[0m04:27:05.721623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4db5c5df-512d-4c75-986a-b3a10eeda0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7103df365f40>]}
[0m04:27:05.722817 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:27:05.723446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4db5c5df-512d-4c75-986a-b3a10eeda0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7103df34c8b0>]}
[0m04:27:05.725379 [info ] [MainThread]: 
[0m04:27:05.726314 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:27:05.727894 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:27:05.748896 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:27:05.749536 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:27:05.750015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:27:07.091220 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.341 seconds
[0m04:27:07.094757 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:27:07.490821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:27:07.505014 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:27:07.505696 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:27:07.506385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:27:09.634590 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.128 seconds
[0m04:27:09.637225 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:27:10.014209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4db5c5df-512d-4c75-986a-b3a10eeda0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7103df2e3160>]}
[0m04:27:10.015426 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:27:10.016003 [info ] [MainThread]: 
[0m04:27:10.024726 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:27:10.025501 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:27:10.026378 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:27:10.026898 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:27:10.036637 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:27:10.037488 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:27:10.068244 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:27:10.069620 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:27:10.070173 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:s::ticer AS ticker,           
    RECORD_CONTENT:p::price AS price,             
    RECORD_CONTENT:q::quantity AS quantity,          
    RECORD_CONTENT:T::timestamp AS trade_time,    
    RECORD_CONTENT:t::trade_id AS trade_id,            
    RECORD_CONTENT:b::buyer_order_id AS buyer_order_id,      
    RECORD_CONTENT:a::seller_order_id AS seller_order_id   
    
FROM streaming_db.public.stock_trades_raw
  );
[0m04:27:10.070646 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:27:10.960514 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0f30b-0001-ba8f-0001-85aa0003823e
[0m04:27:10.961196 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002040 (42601): SQL compilation error:
Unsupported data type 'TICER'.
[0m04:27:10.961850 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:27:11.341491 [debug] [Thread-1  ]: Database Error in model bronze_data (models/bronze/bronze_data.sql)
  002040 (42601): SQL compilation error:
  Unsupported data type 'TICER'.
  compiled code at target/run/crypto_transform/models/bronze/bronze_data.sql
[0m04:27:11.344231 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4db5c5df-512d-4c75-986a-b3a10eeda0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7103d8052bb0>]}
[0m04:27:11.345137 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.bronze_data ........................ [[31mERROR[0m in 1.32s]
[0m04:27:11.346248 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:27:11.348699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:27:11.349128 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:27:11.349705 [info ] [MainThread]: 
[0m04:27:11.350281 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.62 seconds (5.62s).
[0m04:27:11.351286 [debug] [MainThread]: Command end result
[0m04:27:11.387305 [info ] [MainThread]: 
[0m04:27:11.388032 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:27:11.388509 [info ] [MainThread]: 
[0m04:27:11.389054 [error] [MainThread]:   Database Error in model bronze_data (models/bronze/bronze_data.sql)
  002040 (42601): SQL compilation error:
  Unsupported data type 'TICER'.
  compiled code at target/run/crypto_transform/models/bronze/bronze_data.sql
[0m04:27:11.389531 [info ] [MainThread]: 
[0m04:27:11.389948 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:27:11.391236 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.7216988, "process_user_time": 3.585528, "process_kernel_time": 1.452886, "process_mem_max_rss": "208196", "process_out_blocks": "2720", "command_success": false, "process_in_blocks": "0"}
[0m04:27:11.392001 [debug] [MainThread]: Command `dbt run` failed at 04:27:11.391855 after 7.72 seconds
[0m04:27:11.392603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7103e5d72a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7103df2e3160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7103df365280>]}
[0m04:27:11.393177 [debug] [MainThread]: Flushing usage events
[0m04:28:03.495583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642af3e3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642ad34c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642ad3da460>]}


============================== 04:28:03.502590 | cd64ee38-0cbf-4c47-9187-24c82b9bafd9 ==============================
[0m04:28:03.502590 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:28:03.503405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:28:04.516319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd64ee38-0cbf-4c47-9187-24c82b9bafd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76427faac610>]}
[0m04:28:04.575903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd64ee38-0cbf-4c47-9187-24c82b9bafd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76427fa36eb0>]}
[0m04:28:04.577390 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:28:04.604174 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:28:04.891410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:28:04.892906 [debug] [MainThread]: Partial parsing: updated file: crypto_transform://models/bronze/bronze_data.sql
[0m04:28:05.370966 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:28:05.388496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd64ee38-0cbf-4c47-9187-24c82b9bafd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642a96c2dc0>]}
[0m04:28:05.521412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd64ee38-0cbf-4c47-9187-24c82b9bafd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642a896eee0>]}
[0m04:28:05.522349 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:28:05.522885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd64ee38-0cbf-4c47-9187-24c82b9bafd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642a89ae8e0>]}
[0m04:28:05.525083 [info ] [MainThread]: 
[0m04:28:05.525983 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:28:05.527400 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:28:05.546779 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:28:05.547896 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:28:05.548721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:28:07.245330 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.696 seconds
[0m04:28:07.249094 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:28:07.621645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:28:07.636873 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:28:07.637408 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:28:07.637831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:28:08.520885 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.883 seconds
[0m04:28:08.524033 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:28:08.915437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd64ee38-0cbf-4c47-9187-24c82b9bafd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642a893c190>]}
[0m04:28:08.916691 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:28:08.917361 [info ] [MainThread]: 
[0m04:28:08.927909 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:28:08.928895 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:28:08.930042 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:28:08.930534 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:28:08.940904 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:28:08.941800 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:28:08.975299 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:28:08.976836 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:28:08.977336 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:s::ticker AS ticker,           
    RECORD_CONTENT:p::price AS price,             
    RECORD_CONTENT:q::quantity AS quantity,          
    RECORD_CONTENT:T::timestamp AS trade_time,    
    RECORD_CONTENT:t::trade_id AS trade_id,            
    RECORD_CONTENT:b::buyer_order_id AS buyer_order_id,      
    RECORD_CONTENT:a::seller_order_id AS seller_order_id   
    
FROM streaming_db.public.stock_trades_raw
  );
[0m04:28:08.977823 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:28:10.118675 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0f30c-0001-ba9c-0001-85aa00039236
[0m04:28:10.119376 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002040 (42601): SQL compilation error:
Unsupported data type 'TICKER'.
[0m04:28:10.120124 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:28:11.434166 [debug] [Thread-1  ]: Database Error in model bronze_data (models/bronze/bronze_data.sql)
  002040 (42601): SQL compilation error:
  Unsupported data type 'TICKER'.
  compiled code at target/run/crypto_transform/models/bronze/bronze_data.sql
[0m04:28:11.437450 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd64ee38-0cbf-4c47-9187-24c82b9bafd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642a16aebe0>]}
[0m04:28:11.438859 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.bronze_data ........................ [[31mERROR[0m in 2.51s]
[0m04:28:11.439851 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:28:11.442737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:28:11.443238 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:28:11.443712 [info ] [MainThread]: 
[0m04:28:11.444296 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.92 seconds (5.92s).
[0m04:28:11.445362 [debug] [MainThread]: Command end result
[0m04:28:11.485077 [info ] [MainThread]: 
[0m04:28:11.485830 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:28:11.486462 [info ] [MainThread]: 
[0m04:28:11.487172 [error] [MainThread]:   Database Error in model bronze_data (models/bronze/bronze_data.sql)
  002040 (42601): SQL compilation error:
  Unsupported data type 'TICKER'.
  compiled code at target/run/crypto_transform/models/bronze/bronze_data.sql
[0m04:28:11.487690 [info ] [MainThread]: 
[0m04:28:11.488257 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:28:11.489610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.063265, "process_user_time": 3.849678, "process_kernel_time": 1.635829, "process_mem_max_rss": "207760", "process_in_blocks": "56", "process_out_blocks": "2720", "command_success": false}
[0m04:28:11.490418 [debug] [MainThread]: Command `dbt run` failed at 04:28:11.490301 after 8.06 seconds
[0m04:28:11.491025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642af3e3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642a896e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642831cb4f0>]}
[0m04:28:11.491614 [debug] [MainThread]: Flushing usage events
[0m04:29:03.201546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49fdf754c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49fbe523a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49fbdd55e0>]}


============================== 04:29:03.207691 | 287407eb-33a0-4342-9797-9097521877d9 ==============================
[0m04:29:03.207691 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:29:03.208336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:29:04.152225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '287407eb-33a0-4342-9797-9097521877d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d4cfabe0>]}
[0m04:29:04.212139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '287407eb-33a0-4342-9797-9097521877d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49fbe612e0>]}
[0m04:29:04.213173 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:29:04.238680 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:29:04.471057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:29:04.471866 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:29:04.481295 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:29:04.530648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '287407eb-33a0-4342-9797-9097521877d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f82fc2e0>]}
[0m04:29:04.652095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '287407eb-33a0-4342-9797-9097521877d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f82bbf40>]}
[0m04:29:04.652853 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:29:04.653486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '287407eb-33a0-4342-9797-9097521877d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f8308df0>]}
[0m04:29:04.748916 [info ] [MainThread]: 
[0m04:29:04.749883 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:29:04.751408 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:29:04.768404 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:29:04.768901 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:29:04.769404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:29:06.451354 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.682 seconds
[0m04:29:06.454777 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:29:06.840299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:29:06.854308 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:29:06.854859 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:29:06.855262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:29:07.725397 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.870 seconds
[0m04:29:07.728165 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:29:08.116556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '287407eb-33a0-4342-9797-9097521877d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49fbe52130>]}
[0m04:29:08.117826 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:29:08.118501 [info ] [MainThread]: 
[0m04:29:08.128450 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:29:08.129177 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:29:08.130013 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:29:08.130492 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:29:08.139804 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:29:08.140594 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:29:08.170821 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:29:08.172249 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:29:08.172734 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:s::ticker AS ticker,           
    RECORD_CONTENT:p::price AS price,             
    RECORD_CONTENT:q::quantity AS quantity,          
    RECORD_CONTENT:T::timestamp AS trade_time,    
    RECORD_CONTENT:t::trade_id AS trade_id,            
    RECORD_CONTENT:b::buyer_order_id AS buyer_order_id,      
    RECORD_CONTENT:a::seller_order_id AS seller_order_id   
    
FROM streaming_db.public.stock_trades_raw
  );
[0m04:29:08.173247 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:29:09.001785 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0f30d-0001-ba8f-0001-85aa00038256
[0m04:29:09.002478 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002040 (42601): SQL compilation error:
Unsupported data type 'TICKER'.
[0m04:29:09.003495 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:29:09.391289 [debug] [Thread-1  ]: Database Error in model bronze_data (models/bronze/bronze_data.sql)
  002040 (42601): SQL compilation error:
  Unsupported data type 'TICKER'.
  compiled code at target/run/crypto_transform/models/bronze/bronze_data.sql
[0m04:29:09.394116 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '287407eb-33a0-4342-9797-9097521877d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f8350f40>]}
[0m04:29:09.395329 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.bronze_data ........................ [[31mERROR[0m in 1.26s]
[0m04:29:09.396450 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:29:09.399213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:29:09.399785 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:29:09.400408 [info ] [MainThread]: 
[0m04:29:09.400952 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.65 seconds (4.65s).
[0m04:29:09.401899 [debug] [MainThread]: Command end result
[0m04:29:09.438037 [info ] [MainThread]: 
[0m04:29:09.438760 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:29:09.439227 [info ] [MainThread]: 
[0m04:29:09.439895 [error] [MainThread]:   Database Error in model bronze_data (models/bronze/bronze_data.sql)
  002040 (42601): SQL compilation error:
  Unsupported data type 'TICKER'.
  compiled code at target/run/crypto_transform/models/bronze/bronze_data.sql
[0m04:29:09.440405 [info ] [MainThread]: 
[0m04:29:09.440821 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:29:09.442084 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.297605, "process_user_time": 3.318363, "process_kernel_time": 1.632785, "process_mem_max_rss": "203692", "process_in_blocks": "3848", "process_out_blocks": "1832", "command_success": false}
[0m04:29:09.442884 [debug] [MainThread]: Command `dbt run` failed at 04:29:09.442770 after 6.30 seconds
[0m04:29:09.443454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49fdf754c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d4cfda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49fbe612e0>]}
[0m04:29:09.444100 [debug] [MainThread]: Flushing usage events
[0m04:32:50.799135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722ba3e8c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722ba1d2a3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722ba1caf5e0>]}


============================== 04:32:50.809412 | e3c62c8e-fb3e-43d4-aeb5-3dd71ccdb142 ==============================
[0m04:32:50.809412 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:32:50.811110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:32:52.477972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3c62c8e-fb3e-43d4-aeb5-3dd71ccdb142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722b74503be0>]}
[0m04:32:52.571000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3c62c8e-fb3e-43d4-aeb5-3dd71ccdb142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722ba1d353a0>]}
[0m04:32:52.572552 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:32:52.628550 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:32:52.908162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:32:52.909394 [debug] [MainThread]: Partial parsing: updated file: crypto_transform://models/bronze/bronze_data.sql
[0m04:32:53.625013 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:32:53.651403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3c62c8e-fb3e-43d4-aeb5-3dd71ccdb142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722ba1ca36d0>]}
[0m04:32:53.806747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3c62c8e-fb3e-43d4-aeb5-3dd71ccdb142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722b9d4452b0>]}
[0m04:32:53.807686 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:32:53.808440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3c62c8e-fb3e-43d4-aeb5-3dd71ccdb142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722b9d486940>]}
[0m04:32:53.810778 [info ] [MainThread]: 
[0m04:32:53.811803 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:32:53.813730 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:32:53.834472 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:32:53.835101 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:32:53.835720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:32:57.001586 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 3.165 seconds
[0m04:32:57.013677 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:32:57.428779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:32:57.451477 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:32:57.452441 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:32:57.453192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:32:56.834758 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.254 seconds
[0m04:32:56.839480 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:32:57.232405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3c62c8e-fb3e-43d4-aeb5-3dd71ccdb142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722b9d40ac10>]}
[0m04:32:57.234482 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:32:57.235707 [info ] [MainThread]: 
[0m04:32:57.254598 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:32:57.256096 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:32:57.257809 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:32:57.258779 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:32:57.278823 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:32:57.280554 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:32:57.334945 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:32:57.337475 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:32:57.338377 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity:float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
    
FROM streaming_db.public.stock_trades_raw
  );
[0m04:32:57.339301 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:32:58.374337 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.035 seconds
[0m04:32:58.442808 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:32:58.834462 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3c62c8e-fb3e-43d4-aeb5-3dd71ccdb142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722b7782ff70>]}
[0m04:32:58.836439 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.57s]
[0m04:32:58.838225 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:32:58.841972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:32:58.842704 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:32:58.843725 [info ] [MainThread]: 
[0m04:32:58.844583 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.03 seconds (5.03s).
[0m04:32:58.846220 [debug] [MainThread]: Command end result
[0m04:32:58.932154 [info ] [MainThread]: 
[0m04:32:58.934064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:32:58.935067 [info ] [MainThread]: 
[0m04:32:58.936226 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:32:58.939173 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.122747, "process_user_time": 6.166672, "process_kernel_time": 1.950407, "process_mem_max_rss": "207524", "process_in_blocks": "896", "process_out_blocks": "2720"}
[0m04:32:58.941074 [debug] [MainThread]: Command `dbt run` succeeded at 04:32:58.940816 after 10.12 seconds
[0m04:32:58.942216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722ba3e8c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722ba3ade4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722b9d4452b0>]}
[0m04:32:58.943211 [debug] [MainThread]: Flushing usage events
[0m04:33:06.190038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac19ec96a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac19cbff4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac19cc8e460>]}


============================== 04:33:06.214099 | 8c9ce687-460c-4839-ac40-ef1a78690f48 ==============================
[0m04:33:06.214099 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:33:06.215673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m04:33:07.629209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71401ee1b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71401cc7fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71401cc41670>]}


============================== 04:33:07.647521 | 101efa4d-7038-4482-817b-7038dafacdc5 ==============================
[0m04:33:07.647521 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:33:07.649087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:33:08.502423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c9ce687-460c-4839-ac40-ef1a78690f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac175a40610>]}
[0m04:33:08.639450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c9ce687-460c-4839-ac40-ef1a78690f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac17499feb0>]}
[0m04:33:08.642291 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:33:08.704251 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:33:08.996424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:33:08.997395 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:33:09.006061 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:33:09.056506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c9ce687-460c-4839-ac40-ef1a78690f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac198fe9ee0>]}
[0m04:33:09.248206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c9ce687-460c-4839-ac40-ef1a78690f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac198f68fa0>]}
[0m04:33:09.249184 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:33:09.249847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c9ce687-460c-4839-ac40-ef1a78690f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac198ff1df0>]}
[0m04:33:09.374124 [info ] [MainThread]: 
[0m04:33:09.375727 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:33:09.377935 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:33:09.403063 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:33:09.403760 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:33:09.404232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:33:09.549819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '101efa4d-7038-4482-817b-7038dafacdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713fef512b50>]}
[0m04:33:09.630179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '101efa4d-7038-4482-817b-7038dafacdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713fef4f0730>]}
[0m04:33:09.631657 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:33:09.666715 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:33:09.873062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:33:09.873814 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:33:09.882531 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:33:09.949979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '101efa4d-7038-4482-817b-7038dafacdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714019164040>]}
[0m04:33:10.242889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '101efa4d-7038-4482-817b-7038dafacdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71401d1e58b0>]}
[0m04:33:10.243891 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:33:10.244467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '101efa4d-7038-4482-817b-7038dafacdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71401ccc1580>]}
[0m04:33:10.246512 [info ] [MainThread]: 
[0m04:33:10.247063 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:33:10.250456 [debug] [MainThread]: Command end result
[0m04:33:10.298264 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.7688105, "process_user_time": 4.859538, "process_kernel_time": 2.420119, "process_mem_max_rss": "192836", "process_out_blocks": "1808", "process_in_blocks": "0"}
[0m04:33:10.299427 [debug] [MainThread]: Command `dbt test` succeeded at 04:33:10.299276 after 2.77 seconds
[0m04:33:10.300388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71401ee1b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71401d364c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713fef512b50>]}
[0m04:33:10.301911 [debug] [MainThread]: Flushing usage events
[0m04:33:11.212858 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.808 seconds
[0m04:33:11.216733 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:33:11.605479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:33:11.625738 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:33:11.626616 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:33:11.627522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:33:12.820569 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.193 seconds
[0m04:33:12.825319 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:33:13.226053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c9ce687-460c-4839-ac40-ef1a78690f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac1749b9580>]}
[0m04:33:13.228434 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:33:13.229477 [info ] [MainThread]: 
[0m04:33:13.246283 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:33:13.247752 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:33:13.249320 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:33:13.250399 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:33:13.275022 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:33:13.277279 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:33:13.340277 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:33:13.343580 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:33:13.344657 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity:float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
    
FROM streaming_db.public.stock_trades_raw
  );
[0m04:33:13.345666 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:33:14.375114 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.029 seconds
[0m04:33:14.480869 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:33:14.881457 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c9ce687-460c-4839-ac40-ef1a78690f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac1749b9940>]}
[0m04:33:14.883164 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.63s]
[0m04:33:14.884943 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:33:14.888723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:33:14.889493 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:33:14.890181 [info ] [MainThread]: 
[0m04:33:14.891007 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.51 seconds (5.51s).
[0m04:33:14.892718 [debug] [MainThread]: Command end result
[0m04:33:14.948374 [info ] [MainThread]: 
[0m04:33:14.949896 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:33:14.950692 [info ] [MainThread]: 
[0m04:33:14.951550 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:33:14.953406 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.868783, "process_user_time": 5.874043, "process_kernel_time": 2.509818, "process_mem_max_rss": "203280", "process_in_blocks": "3720", "process_out_blocks": "1816"}
[0m04:33:14.954740 [debug] [MainThread]: Command `dbt run` succeeded at 04:33:14.954440 after 8.87 seconds
[0m04:33:14.955806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac19ec96a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac1749801c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac1748b2790>]}
[0m04:33:14.956893 [debug] [MainThread]: Flushing usage events
[0m04:33:22.652525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfd8fc8f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfd8db1b1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfd8e8ae310>]}


============================== 04:33:22.663330 | c056ed21-8a1f-4fd2-9f78-9fb873c2242b ==============================
[0m04:33:22.663330 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:33:22.664485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:33:24.353604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c056ed21-8a1f-4fd2-9f78-9fb873c2242b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfd603aec40>]}
[0m04:33:24.492070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c056ed21-8a1f-4fd2-9f78-9fb873c2242b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfd8db1b310>]}
[0m04:33:24.494920 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:33:24.544322 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:33:24.783846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:33:24.784768 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:33:24.799470 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:33:24.862147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c056ed21-8a1f-4fd2-9f78-9fb873c2242b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfd89fbcf10>]}
[0m04:33:25.334853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c056ed21-8a1f-4fd2-9f78-9fb873c2242b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfd6034e1c0>]}
[0m04:33:25.335931 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:33:25.336544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c056ed21-8a1f-4fd2-9f78-9fb873c2242b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfd89fbcfa0>]}
[0m04:33:25.338717 [info ] [MainThread]: 
[0m04:33:25.339394 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:33:25.342093 [debug] [MainThread]: Command end result
[0m04:33:25.384987 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.8162189, "process_user_time": 5.129098, "process_kernel_time": 1.799616, "process_mem_max_rss": "192920", "process_in_blocks": "2096", "process_out_blocks": "1800"}
[0m04:33:25.386287 [debug] [MainThread]: Command `dbt test` succeeded at 04:33:25.386108 after 2.82 seconds
[0m04:33:25.387442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfd8fc8f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfd8e8ae400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfd8dc95d30>]}
[0m04:33:25.388203 [debug] [MainThread]: Flushing usage events
[0m04:34:05.416045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae9c9e0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae9a87c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae9a7ff5e0>]}


============================== 04:34:05.432357 | f25c1f12-875c-4356-8acd-c8e7f71a213d ==============================
[0m04:34:05.432357 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:34:05.433814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m04:34:07.076921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f25c1f12-875c-4356-8acd-c8e7f71a213d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae74025be0>]}
[0m04:34:07.175255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f25c1f12-875c-4356-8acd-c8e7f71a213d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae9a882370>]}
[0m04:34:07.176855 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:34:07.215941 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:34:07.500222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:34:07.502105 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:34:07.523412 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:34:07.600059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f25c1f12-875c-4356-8acd-c8e7f71a213d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae96d672e0>]}
[0m04:34:07.794630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f25c1f12-875c-4356-8acd-c8e7f71a213d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae96ce0f40>]}
[0m04:34:07.795758 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:34:07.796592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f25c1f12-875c-4356-8acd-c8e7f71a213d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae96d6f820>]}
[0m04:34:07.930234 [info ] [MainThread]: 
[0m04:34:07.932159 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:34:07.934842 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:34:07.966292 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:34:07.967283 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:34:07.968265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:34:09.853303 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.884 seconds
[0m04:34:09.858789 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:34:10.263485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:34:10.288765 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:34:10.289971 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:34:10.290711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:11.486573 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.196 seconds
[0m04:34:11.491450 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:34:11.909673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f25c1f12-875c-4356-8acd-c8e7f71a213d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae9a87c130>]}
[0m04:34:11.911649 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:34:11.912576 [info ] [MainThread]: 
[0m04:34:11.930557 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:34:11.932005 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:34:11.933824 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:34:11.934710 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:34:11.950848 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:34:11.952402 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:34:12.001747 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:34:12.004016 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:34:12.004917 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity:float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
    
FROM streaming_db.public.stock_trades_raw
  );
[0m04:34:12.005671 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:34:12.997214 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.991 seconds
[0m04:34:13.048864 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:34:13.475239 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f25c1f12-875c-4356-8acd-c8e7f71a213d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae96dbcfd0>]}
[0m04:34:13.477163 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.54s]
[0m04:34:13.479002 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:34:13.482732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:34:13.483424 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:34:13.484457 [info ] [MainThread]: 
[0m04:34:13.485628 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.55 seconds (5.55s).
[0m04:34:13.487543 [debug] [MainThread]: Command end result
[0m04:34:13.559632 [info ] [MainThread]: 
[0m04:34:13.561451 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:34:13.562396 [info ] [MainThread]: 
[0m04:34:13.563457 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:34:13.566084 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.264729, "process_user_time": 5.560394, "process_kernel_time": 2.108587, "process_mem_max_rss": "203856", "process_out_blocks": "1840", "process_in_blocks": "0"}
[0m04:34:13.567735 [debug] [MainThread]: Command `dbt run` succeeded at 04:34:13.567531 after 8.27 seconds
[0m04:34:13.568736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae9c9e0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae9c5e3100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae740288e0>]}
[0m04:34:13.569604 [debug] [MainThread]: Flushing usage events
[0m04:34:21.459692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbabb0a2400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbabc124d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbab9033ac0>]}


============================== 04:34:21.468640 | 02e1e932-f6d5-41f8-8530-30121e1bec30 ==============================
[0m04:34:21.468640 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:34:21.469883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:34:23.000510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02e1e932-f6d5-41f8-8530-30121e1bec30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dba8b7e3850>]}
[0m04:34:23.095382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02e1e932-f6d5-41f8-8530-30121e1bec30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dba8b7a1d30>]}
[0m04:34:23.097021 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:34:23.136495 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:34:23.468669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:34:23.470970 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:34:23.507200 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:34:23.652721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02e1e932-f6d5-41f8-8530-30121e1bec30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbab53ea040>]}
[0m04:34:24.019873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02e1e932-f6d5-41f8-8530-30121e1bec30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbab8f41b50>]}
[0m04:34:24.020911 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:34:24.021670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02e1e932-f6d5-41f8-8530-30121e1bec30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbab8f41fa0>]}
[0m04:34:24.024130 [info ] [MainThread]: 
[0m04:34:24.024874 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:34:24.028027 [debug] [MainThread]: Command end result
[0m04:34:24.074359 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.7027378, "process_user_time": 5.18449, "process_kernel_time": 1.729467, "process_mem_max_rss": "193264", "process_out_blocks": "1800", "process_in_blocks": "0"}
[0m04:34:24.075617 [debug] [MainThread]: Command `dbt test` succeeded at 04:34:24.075427 after 2.70 seconds
[0m04:34:24.076433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbabb0a2400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbab9cd3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dba8b6f0700>]}
[0m04:34:24.077137 [debug] [MainThread]: Flushing usage events
[0m04:35:05.739723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fdece913a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fdead2c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fdeacaf5e0>]}


============================== 04:35:05.749737 | 80ee7e6f-1664-4243-ba27-7963eca9f22a ==============================
[0m04:35:05.749737 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:35:05.750847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:35:07.347226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80ee7e6f-1664-4243-ba27-7963eca9f22a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fdc411bbe0>]}
[0m04:35:07.451493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80ee7e6f-1664-4243-ba27-7963eca9f22a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fdead32370>]}
[0m04:35:07.453308 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:35:07.491651 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:35:07.784967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:35:07.786665 [debug] [MainThread]: Partial parsing: updated file: crypto_transform://models/bronze/bronze_data.sql
[0m04:35:08.342832 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.silver
- models.crypto_transform.gold
[0m04:35:08.368149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80ee7e6f-1664-4243-ba27-7963eca9f22a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fdeaca36d0>]}
[0m04:35:08.641591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80ee7e6f-1664-4243-ba27-7963eca9f22a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fde60412b0>]}
[0m04:35:08.642638 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:35:08.643333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80ee7e6f-1664-4243-ba27-7963eca9f22a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fde6084940>]}
[0m04:35:08.646097 [info ] [MainThread]: 
[0m04:35:08.647121 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:35:08.649009 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:35:08.674929 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:35:08.675797 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:35:08.676383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:35:10.132882 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.456 seconds
[0m04:35:10.137760 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:35:10.533646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:35:10.555188 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:35:10.556010 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:35:10.557257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:35:11.500436 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.943 seconds
[0m04:35:11.508821 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:35:11.915830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80ee7e6f-1664-4243-ba27-7963eca9f22a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fde5807c10>]}
[0m04:35:11.917934 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:35:11.918937 [info ] [MainThread]: 
[0m04:35:11.935741 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:35:11.937288 [info ] [Thread-1  ]: 1 of 1 START sql view model public.bronze_data ................................. [RUN]
[0m04:35:11.938951 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:35:11.939824 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:35:11.957194 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:35:11.959140 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:35:12.010256 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:35:12.013424 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:35:12.014923 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
    
FROM streaming_db.public.stock_trades_raw
  );
[0m04:35:12.016402 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:35:13.074773 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.058 seconds
[0m04:35:13.127833 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:35:13.515620 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80ee7e6f-1664-4243-ba27-7963eca9f22a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fdc4838f70>]}
[0m04:35:13.517947 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.57s]
[0m04:35:13.519412 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:35:13.523100 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:35:13.523894 [debug] [MainThread]: Connection 'model.crypto_transform.bronze_data' was properly closed.
[0m04:35:13.524985 [info ] [MainThread]: 
[0m04:35:13.526203 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.88 seconds (4.88s).
[0m04:35:13.528130 [debug] [MainThread]: Command end result
[0m04:35:13.611590 [info ] [MainThread]: 
[0m04:35:13.613368 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:35:13.614161 [info ] [MainThread]: 
[0m04:35:13.615076 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:35:13.617290 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.9616795, "process_user_time": 5.943906, "process_kernel_time": 1.766586, "process_mem_max_rss": "207624", "process_out_blocks": "2720", "process_in_blocks": "0"}
[0m04:35:13.618781 [debug] [MainThread]: Command `dbt run` succeeded at 04:35:13.618459 after 7.96 seconds
[0m04:35:13.620095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fdece913a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fdecae14f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fde60412b0>]}
[0m04:35:13.621084 [debug] [MainThread]: Flushing usage events
[0m04:35:20.394622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722205d85130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72220420eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722203d19520>]}


============================== 04:35:20.410985 | d990d5e0-f473-4dde-85b6-95cf5575fe95 ==============================
[0m04:35:20.410985 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:35:20.412321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:35:21.982614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd990d5e0-f473-4dde-85b6-95cf5575fe95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722203adb5e0>]}
[0m04:35:22.089150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd990d5e0-f473-4dde-85b6-95cf5575fe95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7221dcb2ba60>]}
[0m04:35:22.090953 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:35:22.135358 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:35:22.491190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:35:22.492227 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:35:22.505052 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_transform.gold
- models.crypto_transform.silver
[0m04:35:22.574247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd990d5e0-f473-4dde-85b6-95cf5575fe95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7222000ce2b0>]}
[0m04:35:22.888324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd990d5e0-f473-4dde-85b6-95cf5575fe95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722203da8130>]}
[0m04:35:22.889442 [info ] [MainThread]: Found 1 model, 1 source, 454 macros
[0m04:35:22.890298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd990d5e0-f473-4dde-85b6-95cf5575fe95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722203da8520>]}
[0m04:35:22.893812 [info ] [MainThread]: 
[0m04:35:22.894622 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:35:22.898961 [debug] [MainThread]: Command end result
[0m04:35:22.951529 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.7356906, "process_user_time": 4.856774, "process_kernel_time": 1.877599, "process_mem_max_rss": "192096", "process_out_blocks": "1792", "process_in_blocks": "0"}
[0m04:35:22.952772 [debug] [MainThread]: Command `dbt test` succeeded at 04:35:22.952588 after 2.74 seconds
[0m04:35:22.953737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722205d85130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722203da8130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722203adb5e0>]}
[0m04:35:22.954520 [debug] [MainThread]: Flushing usage events
[0m04:45:30.701789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a4809fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a460084f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a46096460>]}


============================== 04:45:30.711505 | 41a9790a-4c85-4034-a384-c60522b8e97f ==============================
[0m04:45:30.711505 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:45:30.712571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:45:32.264486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41a9790a-4c85-4034-a384-c60522b8e97f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a18730610>]}
[0m04:45:32.364865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41a9790a-4c85-4034-a384-c60522b8e97f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a186baeb0>]}
[0m04:45:32.366353 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:45:32.404999 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:45:32.622685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m04:45:32.624065 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/silver/silver_transformations.sql
[0m04:45:32.625105 [debug] [MainThread]: Partial parsing: updated file: crypto_transform://models/bronze/bronze_data.sql
[0m04:45:33.165952 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_transform.gold
[0m04:45:33.191819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41a9790a-4c85-4034-a384-c60522b8e97f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a4167c490>]}
[0m04:45:33.386126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41a9790a-4c85-4034-a384-c60522b8e97f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a41632880>]}
[0m04:45:33.387277 [info ] [MainThread]: Found 2 models, 1 source, 454 macros
[0m04:45:33.388011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41a9790a-4c85-4034-a384-c60522b8e97f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a416823d0>]}
[0m04:45:33.390317 [info ] [MainThread]: 
[0m04:45:33.391504 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:45:33.400222 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:45:33.425197 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:45:33.425855 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:45:33.426511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:45:35.747420 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.320 seconds
[0m04:45:35.753199 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:45:36.126383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:45:36.155456 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:45:36.156383 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:45:36.157316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:45:37.069195 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.912 seconds
[0m04:45:37.073075 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:45:37.477168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41a9790a-4c85-4034-a384-c60522b8e97f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a48087eb0>]}
[0m04:45:37.479358 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:45:37.480347 [info ] [MainThread]: 
[0m04:45:37.495468 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:45:37.496787 [info ] [Thread-1  ]: 1 of 2 START sql view model public.bronze_data ................................. [RUN]
[0m04:45:37.498586 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:45:37.499583 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:45:37.515610 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:45:37.516970 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:45:37.565242 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:45:37.567439 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:45:37.568215 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m04:45:37.568947 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:45:36.949547 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.205 seconds
[0m04:45:37.020847 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:45:37.419459 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41a9790a-4c85-4034-a384-c60522b8e97f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a41632af0>]}
[0m04:45:37.422732 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in -0.08s]
[0m04:45:37.425776 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:45:37.429359 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m04:45:37.431405 [info ] [Thread-1  ]: 2 of 2 START sql incremental model public.silver_transformations ............... [RUN]
[0m04:45:37.433008 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.silver_transformations)
[0m04:45:37.434236 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m04:45:37.445483 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m04:45:37.448757 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m04:45:37.592040 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.silver_transformations"
[0m04:45:37.597180 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:45:37.598424 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace transient table streaming_db.public.silver_transformations
         as
        (

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
        );
[0m04:45:37.599645 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:45:38.622373 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0f31d-0001-ba8f-0001-85aa0003836e
[0m04:45:38.623564 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m04:45:38.624802 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m04:45:39.011754 [debug] [Thread-1  ]: Database Error in model silver_transformations (models/silver/silver_transformations.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled code at target/run/crypto_transform/models/silver/silver_transformations.sql
[0m04:45:39.013380 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41a9790a-4c85-4034-a384-c60522b8e97f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a46cfe280>]}
[0m04:45:39.014909 [error] [Thread-1  ]: 2 of 2 ERROR creating sql incremental model public.silver_transformations ...... [[31mERROR[0m in 1.58s]
[0m04:45:39.016584 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m04:45:39.020432 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:45:39.021048 [debug] [MainThread]: Connection 'model.crypto_transform.silver_transformations' was properly closed.
[0m04:45:39.021752 [info ] [MainThread]: 
[0m04:45:39.022958 [info ] [MainThread]: Finished running 1 view model, 1 incremental model in 0 hours 0 minutes and 5.63 seconds (5.63s).
[0m04:45:39.024764 [debug] [MainThread]: Command end result
[0m04:45:39.085836 [info ] [MainThread]: 
[0m04:45:39.087405 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:45:39.088361 [info ] [MainThread]: 
[0m04:45:39.089539 [error] [MainThread]:   Database Error in model silver_transformations (models/silver/silver_transformations.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled code at target/run/crypto_transform/models/silver/silver_transformations.sql
[0m04:45:39.090386 [info ] [MainThread]: 
[0m04:45:39.091448 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m04:45:39.094694 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.329292, "process_user_time": 5.775539, "process_kernel_time": 1.960784, "process_mem_max_rss": "208012", "process_out_blocks": "2784", "command_success": false, "process_in_blocks": "0"}
[0m04:45:39.096353 [debug] [MainThread]: Command `dbt run` failed at 04:45:39.096071 after 10.33 seconds
[0m04:45:39.097670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a4809fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a47cd72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a4161a2b0>]}
[0m04:45:39.099052 [debug] [MainThread]: Flushing usage events
[0m04:46:05.350335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d7fcf0130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d7e17aac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d7dc85520>]}


============================== 04:46:05.360024 | 8521e8eb-df95-4c7d-9576-925fe8a8524e ==============================
[0m04:46:05.360024 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:46:05.362754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:46:04.990983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8521e8eb-df95-4c7d-9576-925fe8a8524e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d7da4a5e0>]}
[0m04:46:05.088750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8521e8eb-df95-4c7d-9576-925fe8a8524e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d4f3ada60>]}
[0m04:46:05.090432 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:46:05.136154 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:46:05.403385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:46:05.404501 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:46:05.420631 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_transform.gold
[0m04:46:05.497032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8521e8eb-df95-4c7d-9576-925fe8a8524e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d7a082b50>]}
[0m04:46:05.789364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8521e8eb-df95-4c7d-9576-925fe8a8524e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d7db489d0>]}
[0m04:46:05.790692 [info ] [MainThread]: Found 2 models, 1 source, 454 macros
[0m04:46:05.791580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8521e8eb-df95-4c7d-9576-925fe8a8524e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d81dfb850>]}
[0m04:46:05.794615 [info ] [MainThread]: 
[0m04:46:05.796587 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:46:05.811523 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:46:05.849621 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:46:05.850975 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:46:05.852067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:46:07.419915 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.567 seconds
[0m04:46:07.427399 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:46:07.848397 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db_public'
[0m04:46:07.880517 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:46:07.881815 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:46:07.883266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:46:08.798860 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.916 seconds
[0m04:46:08.802432 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:46:10.322984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8521e8eb-df95-4c7d-9576-925fe8a8524e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d7cccc310>]}
[0m04:46:10.325383 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:46:10.326404 [info ] [MainThread]: 
[0m04:46:10.341372 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:46:10.342767 [info ] [Thread-1  ]: 1 of 2 START sql view model public.bronze_data ................................. [RUN]
[0m04:46:10.344583 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:46:10.345472 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:46:10.364213 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:46:10.365868 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:46:10.421490 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:46:10.424914 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:46:10.426424 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m04:46:10.427335 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:46:12.070675 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.643 seconds
[0m04:46:12.116986 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:46:12.502153 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8521e8eb-df95-4c7d-9576-925fe8a8524e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d7fd04f10>]}
[0m04:46:12.504460 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 2.15s]
[0m04:46:12.506432 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:46:12.509012 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m04:46:12.510567 [info ] [Thread-1  ]: 2 of 2 START sql incremental model public.silver_transformations ............... [RUN]
[0m04:46:12.511744 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.silver_transformations)
[0m04:46:12.512782 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m04:46:12.527119 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m04:46:12.528776 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m04:46:12.621611 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.silver_transformations"
[0m04:46:12.626514 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:46:12.628975 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace transient table streaming_db.public.silver_transformations
         as
        (

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
        );
[0m04:46:12.630962 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:46:13.703234 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0f31e-0001-ba9c-0001-85aa00039336
[0m04:46:13.706549 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m04:46:13.709018 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m04:46:14.348086 [debug] [Thread-1  ]: Database Error in model silver_transformations (models/silver/silver_transformations.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled code at target/run/crypto_transform/models/silver/silver_transformations.sql
[0m04:46:14.352997 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8521e8eb-df95-4c7d-9576-925fe8a8524e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d79b8aa60>]}
[0m04:46:14.360318 [error] [Thread-1  ]: 2 of 2 ERROR creating sql incremental model public.silver_transformations ...... [[31mERROR[0m in 1.84s]
[0m04:46:14.363013 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m04:46:14.367918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:46:14.369389 [debug] [MainThread]: Connection 'list_streaming_db' was properly closed.
[0m04:46:14.370855 [debug] [MainThread]: Connection 'model.crypto_transform.silver_transformations' was properly closed.
[0m04:46:14.372386 [info ] [MainThread]: 
[0m04:46:14.373878 [info ] [MainThread]: Finished running 1 view model, 1 incremental model in 0 hours 0 minutes and 8.58 seconds (8.58s).
[0m04:46:14.377064 [debug] [MainThread]: Command end result
[0m04:46:14.508813 [info ] [MainThread]: 
[0m04:46:14.511273 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:46:14.512924 [info ] [MainThread]: 
[0m04:46:14.515002 [error] [MainThread]:   Database Error in model silver_transformations (models/silver/silver_transformations.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled code at target/run/crypto_transform/models/silver/silver_transformations.sql
[0m04:46:14.516458 [info ] [MainThread]: 
[0m04:46:14.519471 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m04:46:14.527100 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.217977, "process_user_time": 5.687046, "process_kernel_time": 2.018844, "process_mem_max_rss": "204972", "process_out_blocks": "1888", "command_success": false, "process_in_blocks": "0"}
[0m04:46:14.530377 [debug] [MainThread]: Command `dbt run` failed at 04:46:14.529944 after 11.22 seconds
[0m04:46:14.531756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d7fcf0130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d7da4aeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d7d7f2d30>]}
[0m04:46:14.533420 [debug] [MainThread]: Flushing usage events
[0m04:47:03.700560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af5a49f54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af5a6040d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af5a2989ac0>]}


============================== 04:47:03.711494 | 7ca50ff5-56bb-464e-b146-77c73f09629e ==============================
[0m04:47:03.711494 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:47:03.712956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:47:05.510347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ca50ff5-56bb-464e-b146-77c73f09629e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af57c110490>]}
[0m04:47:05.612616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ca50ff5-56bb-464e-b146-77c73f09629e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af57c0d2a00>]}
[0m04:47:05.614503 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:47:05.661148 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:47:05.938865 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:47:05.939724 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:47:05.951257 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_transform.gold
[0m04:47:06.015758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ca50ff5-56bb-464e-b146-77c73f09629e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af59ed87bb0>]}
[0m04:47:06.308605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ca50ff5-56bb-464e-b146-77c73f09629e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af5a3c0e280>]}
[0m04:47:06.309727 [info ] [MainThread]: Found 2 models, 1 source, 454 macros
[0m04:47:06.310668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ca50ff5-56bb-464e-b146-77c73f09629e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af5a3b21be0>]}
[0m04:47:06.313255 [info ] [MainThread]: 
[0m04:47:06.314295 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:47:06.321841 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:47:06.345644 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:47:06.346397 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:47:06.347198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:47:07.798069 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.451 seconds
[0m04:47:07.803720 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:47:08.183740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:47:08.204284 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:47:08.205123 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:47:08.205838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:47:09.110072 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.904 seconds
[0m04:47:09.114495 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:47:09.507865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ca50ff5-56bb-464e-b146-77c73f09629e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af59edfd580>]}
[0m04:47:09.509851 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:47:09.510969 [info ] [MainThread]: 
[0m04:47:09.528903 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:47:09.530508 [info ] [Thread-1  ]: 1 of 2 START sql view model public.bronze_data ................................. [RUN]
[0m04:47:09.532556 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:47:09.533634 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:47:09.550604 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:47:09.552286 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:47:09.599318 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:47:09.601505 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:47:09.602280 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m04:47:09.603098 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:47:11.250757 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.647 seconds
[0m04:47:11.350748 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:47:11.770045 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ca50ff5-56bb-464e-b146-77c73f09629e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af57c0e8400>]}
[0m04:47:11.772021 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 2.23s]
[0m04:47:11.773736 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:47:11.776868 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m04:47:11.777947 [info ] [Thread-1  ]: 2 of 2 START sql incremental model public.silver_transformations ............... [RUN]
[0m04:47:11.779189 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.silver_transformations)
[0m04:47:11.780004 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m04:47:11.793710 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m04:47:11.803497 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m04:47:11.935133 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.silver_transformations"
[0m04:47:11.941749 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:47:11.943221 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace transient table streaming_db.public.silver_transformations
         as
        (

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
        );
[0m04:47:11.944363 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:47:13.009941 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0f31f-0001-ba8f-0001-85aa0003837a
[0m04:47:13.011055 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m04:47:13.012357 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m04:47:13.411326 [debug] [Thread-1  ]: Database Error in model silver_transformations (models/silver/silver_transformations.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled code at target/run/crypto_transform/models/silver/silver_transformations.sql
[0m04:47:13.412774 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ca50ff5-56bb-464e-b146-77c73f09629e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af5a3668340>]}
[0m04:47:13.414577 [error] [Thread-1  ]: 2 of 2 ERROR creating sql incremental model public.silver_transformations ...... [[31mERROR[0m in 1.63s]
[0m04:47:13.416167 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m04:47:13.420053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:47:13.420703 [debug] [MainThread]: Connection 'model.crypto_transform.silver_transformations' was properly closed.
[0m04:47:13.421420 [info ] [MainThread]: 
[0m04:47:13.422319 [info ] [MainThread]: Finished running 1 view model, 1 incremental model in 0 hours 0 minutes and 7.11 seconds (7.11s).
[0m04:47:13.424176 [debug] [MainThread]: Command end result
[0m04:47:13.500611 [info ] [MainThread]: 
[0m04:47:13.501862 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:47:13.502652 [info ] [MainThread]: 
[0m04:47:13.503915 [error] [MainThread]:   Database Error in model silver_transformations (models/silver/silver_transformations.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled code at target/run/crypto_transform/models/silver/silver_transformations.sql
[0m04:47:13.504664 [info ] [MainThread]: 
[0m04:47:13.505360 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m04:47:13.507711 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.909224, "process_user_time": 6.418469, "process_kernel_time": 1.800979, "process_mem_max_rss": "204616", "process_out_blocks": "1888", "command_success": false, "process_in_blocks": "0"}
[0m04:47:13.508959 [debug] [MainThread]: Command `dbt run` failed at 04:47:13.508770 after 9.91 seconds
[0m04:47:13.509831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af5a49f54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af59ed90ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af59e8b0880>]}
[0m04:47:13.510554 [debug] [MainThread]: Flushing usage events
[0m04:48:05.593823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7245ac5d0400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7245aa46fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7245aa432670>]}


============================== 04:48:05.604468 | 325c813b-598b-4fd7-9d17-6c826fcfddca ==============================
[0m04:48:05.604468 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:48:05.605843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:48:07.046296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '325c813b-598b-4fd7-9d17-6c826fcfddca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72457ccf1b50>]}
[0m04:48:07.162467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '325c813b-598b-4fd7-9d17-6c826fcfddca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72457ccd0730>]}
[0m04:48:07.164053 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:48:07.201417 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:48:07.475817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:48:07.476852 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:48:07.488504 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_transform.gold
[0m04:48:07.554498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '325c813b-598b-4fd7-9d17-6c826fcfddca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7245a699db20>]}
[0m04:48:07.847740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '325c813b-598b-4fd7-9d17-6c826fcfddca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7245ae716850>]}
[0m04:48:07.849433 [info ] [MainThread]: Found 2 models, 1 source, 454 macros
[0m04:48:07.850627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '325c813b-598b-4fd7-9d17-6c826fcfddca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7245ab740970>]}
[0m04:48:07.854113 [info ] [MainThread]: 
[0m04:48:07.855815 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:48:07.864569 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:48:07.892070 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:48:07.892886 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:48:07.893584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:48:09.333859 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.440 seconds
[0m04:48:09.339140 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:48:09.731569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:48:09.752520 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:48:09.753377 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:48:09.754110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:48:11.202842 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.448 seconds
[0m04:48:11.207527 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:48:11.610011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '325c813b-598b-4fd7-9d17-6c826fcfddca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7245aa4531c0>]}
[0m04:48:11.612129 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:48:11.613292 [info ] [MainThread]: 
[0m04:48:11.633974 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:48:11.635735 [info ] [Thread-1  ]: 1 of 2 START sql view model public.bronze_data ................................. [RUN]
[0m04:48:11.637804 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:48:11.638918 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:48:11.659122 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:48:11.662458 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:48:11.755026 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:48:11.760629 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:48:11.762310 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m04:48:11.763822 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:48:13.417410 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.654 seconds
[0m04:48:13.469220 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:48:13.885145 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '325c813b-598b-4fd7-9d17-6c826fcfddca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7245ac5e1e80>]}
[0m04:48:13.891517 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 2.24s]
[0m04:48:13.893728 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:48:13.897238 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m04:48:13.899007 [info ] [Thread-1  ]: 2 of 2 START sql incremental model public.silver_transformations ............... [RUN]
[0m04:48:13.900961 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.silver_transformations)
[0m04:48:13.901954 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m04:48:13.918021 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m04:48:13.919981 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m04:48:14.025393 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.silver_transformations"
[0m04:48:14.029838 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:48:14.031196 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace transient table streaming_db.public.silver_transformations
         as
        (

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
        );
[0m04:48:14.032613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:48:15.080552 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0f320-0001-ba9c-0001-85aa0003934a
[0m04:48:15.082691 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m04:48:15.084760 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m04:48:15.471185 [debug] [Thread-1  ]: Database Error in model silver_transformations (models/silver/silver_transformations.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled code at target/run/crypto_transform/models/silver/silver_transformations.sql
[0m04:48:15.473116 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '325c813b-598b-4fd7-9d17-6c826fcfddca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7245ac5e1e80>]}
[0m04:48:15.475035 [error] [Thread-1  ]: 2 of 2 ERROR creating sql incremental model public.silver_transformations ...... [[31mERROR[0m in 1.57s]
[0m04:48:15.477148 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m04:48:15.481676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:48:15.482440 [debug] [MainThread]: Connection 'model.crypto_transform.silver_transformations' was properly closed.
[0m04:48:15.483176 [info ] [MainThread]: 
[0m04:48:15.484390 [info ] [MainThread]: Finished running 1 view model, 1 incremental model in 0 hours 0 minutes and 7.63 seconds (7.63s).
[0m04:48:15.486653 [debug] [MainThread]: Command end result
[0m04:48:15.549259 [info ] [MainThread]: 
[0m04:48:15.550541 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:48:15.551413 [info ] [MainThread]: 
[0m04:48:15.552527 [error] [MainThread]:   Database Error in model silver_transformations (models/silver/silver_transformations.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled code at target/run/crypto_transform/models/silver/silver_transformations.sql
[0m04:48:15.553386 [info ] [MainThread]: 
[0m04:48:15.554114 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m04:48:15.556415 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.048746, "process_user_time": 5.716259, "process_kernel_time": 1.910504, "process_mem_max_rss": "204896", "process_out_blocks": "1888", "command_success": false, "process_in_blocks": "0"}
[0m04:48:15.557726 [debug] [MainThread]: Command `dbt run` failed at 04:48:15.557545 after 10.05 seconds
[0m04:48:15.558674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7245ac5d0400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7245aa8f2190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7245a68941c0>]}
[0m04:48:15.559589 [debug] [MainThread]: Flushing usage events
[0m04:49:05.018256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ffcea02a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ffcc96b4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ffcc9fa460>]}


============================== 04:49:05.029850 | 3be8d4de-5a65-43cb-a74e-1ad6bfed2754 ==============================
[0m04:49:05.029850 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:49:05.031307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:49:06.828669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3be8d4de-5a65-43cb-a74e-1ad6bfed2754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ffa4795610>]}
[0m04:49:06.989273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3be8d4de-5a65-43cb-a74e-1ad6bfed2754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ffa471feb0>]}
[0m04:49:06.991018 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:49:07.041716 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:49:07.340185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:49:07.341207 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:49:07.356490 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_transform.gold
[0m04:49:07.433612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3be8d4de-5a65-43cb-a74e-1ad6bfed2754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ffc8d27be0>]}
[0m04:49:07.794376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3be8d4de-5a65-43cb-a74e-1ad6bfed2754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ffc8e64a00>]}
[0m04:49:07.796128 [info ] [MainThread]: Found 2 models, 1 source, 454 macros
[0m04:49:07.797451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3be8d4de-5a65-43cb-a74e-1ad6bfed2754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ffc8d27970>]}
[0m04:49:07.801300 [info ] [MainThread]: 
[0m04:49:07.803299 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:49:07.823286 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:49:07.863754 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:49:07.864697 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:49:07.865466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:49:09.274907 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.409 seconds
[0m04:49:09.280265 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:49:09.697240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:49:09.721635 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:49:09.722636 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:49:09.723301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:49:11.319304 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.596 seconds
[0m04:49:11.324947 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:49:11.733890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3be8d4de-5a65-43cb-a74e-1ad6bfed2754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ffce9eaeb0>]}
[0m04:49:11.736149 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:49:11.737391 [info ] [MainThread]: 
[0m04:49:11.753394 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:49:11.755042 [info ] [Thread-1  ]: 1 of 2 START sql view model public.bronze_data ................................. [RUN]
[0m04:49:11.756908 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:49:11.757748 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:49:11.774537 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:49:11.776042 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:49:11.830911 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:49:11.833572 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:49:11.834738 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m04:49:11.835966 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:49:12.918982 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.083 seconds
[0m04:49:12.976065 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:49:13.381655 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3be8d4de-5a65-43cb-a74e-1ad6bfed2754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ffa46a3790>]}
[0m04:49:13.383580 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.62s]
[0m04:49:13.385567 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:49:13.388193 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m04:49:13.389657 [info ] [Thread-1  ]: 2 of 2 START sql incremental model public.silver_transformations ............... [RUN]
[0m04:49:13.391474 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.silver_transformations)
[0m04:49:13.392390 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m04:49:13.405784 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m04:49:13.407385 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m04:49:13.508254 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.silver_transformations"
[0m04:49:13.511191 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:49:13.512067 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace transient table streaming_db.public.silver_transformations
         as
        (

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
        );
[0m04:49:13.513251 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:49:17.522618 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.009 seconds
[0m04:49:17.545703 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.silver_transformations__dbt_tmp
[0m04:49:17.561570 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:49:17.563128 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
drop view if exists streaming_db.public.silver_transformations__dbt_tmp cascade
[0m04:49:17.788213 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.224 seconds
[0m04:49:17.796087 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m04:49:18.192460 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3be8d4de-5a65-43cb-a74e-1ad6bfed2754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ffcd661280>]}
[0m04:49:18.195110 [info ] [Thread-1  ]: 2 of 2 OK created sql incremental model public.silver_transformations .......... [[32mSUCCESS 1[0m in 4.80s]
[0m04:49:18.197637 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m04:49:18.202584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:49:18.204222 [debug] [MainThread]: Connection 'model.crypto_transform.silver_transformations' was properly closed.
[0m04:49:18.205710 [info ] [MainThread]: 
[0m04:49:18.207140 [info ] [MainThread]: Finished running 1 view model, 1 incremental model in 0 hours 0 minutes and 10.40 seconds (10.40s).
[0m04:49:18.211370 [debug] [MainThread]: Command end result
[0m04:49:18.305782 [info ] [MainThread]: 
[0m04:49:18.307577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:49:18.308784 [info ] [MainThread]: 
[0m04:49:18.310358 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:49:18.312719 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.402508, "process_user_time": 5.971296, "process_kernel_time": 1.906364, "process_mem_max_rss": "203700", "process_out_blocks": "1896", "process_in_blocks": "0"}
[0m04:49:18.314485 [debug] [MainThread]: Command `dbt run` succeeded at 04:49:18.314100 after 13.40 seconds
[0m04:49:18.315906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ffcea02a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ffcdb099a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ffa471feb0>]}
[0m04:49:18.317015 [debug] [MainThread]: Flushing usage events
[0m04:49:26.931405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb9d4131460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb9d20c5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb9d20c5a90>]}


============================== 04:49:26.940757 | 73e0913d-4d54-4bda-81c3-8996d8a8b60d ==============================
[0m04:49:26.940757 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:49:26.941828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:49:28.402620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73e0913d-4d54-4bda-81c3-8996d8a8b60d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb9d1dcd880>]}
[0m04:49:28.512645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73e0913d-4d54-4bda-81c3-8996d8a8b60d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb9d2d603d0>]}
[0m04:49:28.514103 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:49:28.558500 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:49:28.811413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:49:28.812347 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:49:28.823677 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_transform.gold
[0m04:49:28.890263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73e0913d-4d54-4bda-81c3-8996d8a8b60d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb9ce442b50>]}
[0m04:49:29.193748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73e0913d-4d54-4bda-81c3-8996d8a8b60d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb9ce449eb0>]}
[0m04:49:29.195121 [info ] [MainThread]: Found 2 models, 1 source, 454 macros
[0m04:49:29.195993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73e0913d-4d54-4bda-81c3-8996d8a8b60d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb9d1fd1fd0>]}
[0m04:49:29.198717 [info ] [MainThread]: 
[0m04:49:29.199557 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:49:29.202913 [debug] [MainThread]: Command end result
[0m04:49:29.263726 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.440549, "process_user_time": 4.794905, "process_kernel_time": 1.723658, "process_mem_max_rss": "193060", "process_in_blocks": "400", "process_out_blocks": "1816"}
[0m04:49:29.264977 [debug] [MainThread]: Command `dbt test` succeeded at 04:49:29.264798 after 2.44 seconds
[0m04:49:29.265901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb9d4131460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb9d2d79880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb9d1dcd880>]}
[0m04:49:29.266597 [debug] [MainThread]: Flushing usage events
[0m04:50:05.465401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737c3993ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737c378a84f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737c37936460>]}


============================== 04:50:05.475939 | 91b007da-122b-4878-b0f3-71220f8e7613 ==============================
[0m04:50:05.475939 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:50:05.477182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m04:50:07.027873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91b007da-122b-4878-b0f3-71220f8e7613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737c106cc610>]}
[0m04:50:07.128054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91b007da-122b-4878-b0f3-71220f8e7613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737c10656ee0>]}
[0m04:50:07.129915 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:50:07.186676 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:50:07.470000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:50:07.471202 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:50:07.486281 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_transform.gold
[0m04:50:07.550047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91b007da-122b-4878-b0f3-71220f8e7613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737c33c64be0>]}
[0m04:50:07.876379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91b007da-122b-4878-b0f3-71220f8e7613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737c33da2a00>]}
[0m04:50:07.877451 [info ] [MainThread]: Found 2 models, 1 source, 454 macros
[0m04:50:07.878221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91b007da-122b-4878-b0f3-71220f8e7613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737c33c64970>]}
[0m04:50:07.881471 [info ] [MainThread]: 
[0m04:50:07.882942 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:50:07.892933 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:50:07.919680 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:50:07.920643 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:50:07.921366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:50:09.365915 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.444 seconds
[0m04:50:09.370650 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:50:09.753538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:50:09.768889 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:50:09.769667 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:50:09.770285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:50:11.617883 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.847 seconds
[0m04:50:11.622279 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:50:12.320946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91b007da-122b-4878-b0f3-71220f8e7613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737c39927eb0>]}
[0m04:50:12.322777 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:50:12.323949 [info ] [MainThread]: 
[0m04:50:12.340927 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:50:12.342410 [info ] [Thread-1  ]: 1 of 2 START sql view model public.bronze_data ................................. [RUN]
[0m04:50:12.344057 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:50:12.345414 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:50:12.385841 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:50:12.388178 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:50:12.555062 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:50:12.558036 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:50:12.559083 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m04:50:12.559974 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:13.893852 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.334 seconds
[0m04:50:13.936055 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:50:14.335095 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91b007da-122b-4878-b0f3-71220f8e7613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737c10716dc0>]}
[0m04:50:14.337072 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.99s]
[0m04:50:14.338646 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:50:14.341432 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m04:50:14.342498 [info ] [Thread-1  ]: 2 of 2 START sql incremental model public.silver_transformations ............... [RUN]
[0m04:50:14.343637 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.silver_transformations)
[0m04:50:14.344581 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m04:50:14.360340 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m04:50:14.361685 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m04:50:14.421430 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:50:14.422768 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace  temporary view streaming_db.public.silver_transformations__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
        -- INCREMENTAL LOGIC (The most important part):
        -- "Only give me rows that are NEWER than the max time currently in this table"
        AND Trade_Time > (SELECT MAX(Trade_Time) FROM streaming_db.public.silver_transformations)
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
  );
[0m04:50:14.423814 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:15.505822 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.082 seconds
[0m04:50:15.533758 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:50:15.535300 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations__dbt_tmp
[0m04:50:15.782925 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.246 seconds
[0m04:50:15.805570 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:50:15.807981 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations
[0m04:50:16.020434 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.211 seconds
[0m04:50:16.037823 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:50:16.038657 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table "STREAMING_DB"."PUBLIC"."SILVER_TRANSFORMATIONS"
[0m04:50:16.260519 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.220 seconds
[0m04:50:16.319316 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.silver_transformations"
[0m04:50:16.323047 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:50:16.323885 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
-- back compat for old kwarg name
  
  begin;
[0m04:50:16.565276 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.240 seconds
[0m04:50:16.566543 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:50:16.567599 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
merge into streaming_db.public.silver_transformations as DBT_INTERNAL_DEST
        using streaming_db.public.silver_transformations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.trade_id = DBT_INTERNAL_DEST.trade_id
            )

    
    when matched then update set
        "TICKER" = DBT_INTERNAL_SOURCE."TICKER","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TRADE_VALUE_USD" = DBT_INTERNAL_SOURCE."TRADE_VALUE_USD","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID","TRADE_CATEGORY" = DBT_INTERNAL_SOURCE."TRADE_CATEGORY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")
    values
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")

;
[0m04:50:17.445643 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.877 seconds
[0m04:50:17.447541 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:50:17.448958 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
COMMIT
[0m04:50:17.819973 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.370 seconds
[0m04:50:17.839618 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.silver_transformations__dbt_tmp
[0m04:50:17.850215 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:50:17.851021 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
drop view if exists streaming_db.public.silver_transformations__dbt_tmp cascade
[0m04:50:18.097175 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.245 seconds
[0m04:50:18.103050 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m04:50:18.502574 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91b007da-122b-4878-b0f3-71220f8e7613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737c10716dc0>]}
[0m04:50:18.505939 [info ] [Thread-1  ]: 2 of 2 OK created sql incremental model public.silver_transformations .......... [[32mSUCCESS 0[0m in 4.16s]
[0m04:50:18.508911 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m04:50:18.513619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:50:18.514912 [debug] [MainThread]: Connection 'model.crypto_transform.silver_transformations' was properly closed.
[0m04:50:18.516605 [info ] [MainThread]: 
[0m04:50:18.518159 [info ] [MainThread]: Finished running 1 view model, 1 incremental model in 0 hours 0 minutes and 10.63 seconds (10.63s).
[0m04:50:18.522499 [debug] [MainThread]: Command end result
[0m04:50:18.594922 [info ] [MainThread]: 
[0m04:50:18.596415 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:50:18.597691 [info ] [MainThread]: 
[0m04:50:18.598710 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:50:18.600880 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.252842, "process_user_time": 6.058812, "process_kernel_time": 1.804997, "process_mem_max_rss": "204272", "process_out_blocks": "1896", "process_in_blocks": "0"}
[0m04:50:18.602066 [debug] [MainThread]: Command `dbt run` succeeded at 04:50:18.601873 after 13.25 seconds
[0m04:50:18.603035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737c3993ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737c38a059a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737c10656ee0>]}
[0m04:50:18.603997 [debug] [MainThread]: Flushing usage events
[0m04:50:26.507277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75613f4164c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75613d2b33a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75613d2375e0>]}


============================== 04:50:26.516597 | cf06b15a-4a55-40f0-8f22-544ee89fd72a ==============================
[0m04:50:26.516597 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:50:26.517808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:50:28.086804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf06b15a-4a55-40f0-8f22-544ee89fd72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75610fa90b80>]}
[0m04:50:28.191650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf06b15a-4a55-40f0-8f22-544ee89fd72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75613d2bc370>]}
[0m04:50:28.193505 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:50:28.235282 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:50:28.506844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:50:28.507867 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:50:28.519911 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_transform.gold
[0m04:50:28.584796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf06b15a-4a55-40f0-8f22-544ee89fd72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7561397a7b80>]}
[0m04:50:28.904468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf06b15a-4a55-40f0-8f22-544ee89fd72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75613970b430>]}
[0m04:50:28.905557 [info ] [MainThread]: Found 2 models, 1 source, 454 macros
[0m04:50:28.906430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf06b15a-4a55-40f0-8f22-544ee89fd72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7561397ae910>]}
[0m04:50:28.908947 [info ] [MainThread]: 
[0m04:50:28.909840 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:50:28.913696 [debug] [MainThread]: Command end result
[0m04:50:28.964983 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.5473437, "process_user_time": 4.971833, "process_kernel_time": 1.668921, "process_mem_max_rss": "192548", "process_out_blocks": "1816", "process_in_blocks": "0"}
[0m04:50:28.966253 [debug] [MainThread]: Command `dbt test` succeeded at 04:50:28.966041 after 2.55 seconds
[0m04:50:28.967006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75613f4164c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75613d249550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75613d2bc370>]}
[0m04:50:28.967799 [debug] [MainThread]: Flushing usage events
[0m04:51:05.275926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6379d8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db63583cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6357f0670>]}


============================== 04:51:05.285030 | 4e1bb6b4-43ea-413e-abe4-88863fcb1517 ==============================
[0m04:51:05.285030 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:51:05.286082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:51:06.949810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e1bb6b4-43ea-413e-abe4-88863fcb1517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6080d7b50>]}
[0m04:51:07.081319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e1bb6b4-43ea-413e-abe4-88863fcb1517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6080b7730>]}
[0m04:51:07.083398 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:51:07.147688 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:51:07.474518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:51:07.475395 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:51:07.487026 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_transform.gold
[0m04:51:07.556832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e1bb6b4-43ea-413e-abe4-88863fcb1517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db631d28b50>]}
[0m04:51:07.900368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e1bb6b4-43ea-413e-abe4-88863fcb1517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db639ae2850>]}
[0m04:51:07.901717 [info ] [MainThread]: Found 2 models, 1 source, 454 macros
[0m04:51:07.902496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e1bb6b4-43ea-413e-abe4-88863fcb1517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db636b0a9d0>]}
[0m04:51:07.906437 [info ] [MainThread]: 
[0m04:51:07.907662 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:51:07.918992 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m04:51:07.952795 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m04:51:07.953718 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m04:51:07.954421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:51:10.560317 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.605 seconds
[0m04:51:10.565119 [debug] [ThreadPool]: On list_streaming_db: Close
[0m04:51:11.769931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m04:51:11.792666 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m04:51:11.793536 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m04:51:11.794461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:51:13.332868 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.538 seconds
[0m04:51:13.337472 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m04:51:13.721088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e1bb6b4-43ea-413e-abe4-88863fcb1517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6358201c0>]}
[0m04:51:13.723002 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:51:13.724353 [info ] [MainThread]: 
[0m04:51:13.739787 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m04:51:13.741418 [info ] [Thread-1  ]: 1 of 2 START sql view model public.bronze_data ................................. [RUN]
[0m04:51:13.742997 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m04:51:13.743801 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m04:51:13.760997 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m04:51:13.762429 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m04:51:13.831046 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m04:51:13.834397 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m04:51:13.835432 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m04:51:13.836439 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:51:13.976963 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.114 seconds
[0m04:51:14.060623 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m04:51:14.467468 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e1bb6b4-43ea-413e-abe4-88863fcb1517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6379ecee0>]}
[0m04:51:14.469469 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 0.72s]
[0m04:51:14.471550 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m04:51:14.474091 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m04:51:14.476278 [info ] [Thread-1  ]: 2 of 2 START sql incremental model public.silver_transformations ............... [RUN]
[0m04:51:14.477775 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.silver_transformations)
[0m04:51:14.478695 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m04:51:14.496824 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m04:51:14.498211 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m04:51:14.571135 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:51:14.572385 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace  temporary view streaming_db.public.silver_transformations__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
        -- INCREMENTAL LOGIC (The most important part):
        -- "Only give me rows that are NEWER than the max time currently in this table"
        AND Trade_Time > (SELECT MAX(Trade_Time) FROM streaming_db.public.silver_transformations)
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
  );
[0m04:51:14.573295 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:51:15.605329 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.032 seconds
[0m04:51:15.628660 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:51:15.629791 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations__dbt_tmp
[0m04:51:15.866772 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.236 seconds
[0m04:51:15.882670 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:51:15.885416 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations
[0m04:51:16.104052 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.217 seconds
[0m04:51:16.121891 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:51:16.122930 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table "STREAMING_DB"."PUBLIC"."SILVER_TRANSFORMATIONS"
[0m04:51:16.344489 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.220 seconds
[0m04:51:16.398763 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.silver_transformations"
[0m04:51:16.401885 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:51:16.402884 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
-- back compat for old kwarg name
  
  begin;
[0m04:51:16.631036 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.227 seconds
[0m04:51:16.632569 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:51:16.633891 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
merge into streaming_db.public.silver_transformations as DBT_INTERNAL_DEST
        using streaming_db.public.silver_transformations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.trade_id = DBT_INTERNAL_DEST.trade_id
            )

    
    when matched then update set
        "TICKER" = DBT_INTERNAL_SOURCE."TICKER","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TRADE_VALUE_USD" = DBT_INTERNAL_SOURCE."TRADE_VALUE_USD","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID","TRADE_CATEGORY" = DBT_INTERNAL_SOURCE."TRADE_CATEGORY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")
    values
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")

;
[0m04:51:17.411721 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.776 seconds
[0m04:51:17.413956 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:51:17.414915 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
COMMIT
[0m04:51:17.769751 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.354 seconds
[0m04:51:17.786605 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.silver_transformations__dbt_tmp
[0m04:51:17.796985 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m04:51:17.797773 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
drop view if exists streaming_db.public.silver_transformations__dbt_tmp cascade
[0m04:51:18.034850 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.236 seconds
[0m04:51:18.040687 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m04:51:18.448560 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e1bb6b4-43ea-413e-abe4-88863fcb1517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6317c9a90>]}
[0m04:51:18.450624 [info ] [Thread-1  ]: 2 of 2 OK created sql incremental model public.silver_transformations .......... [[32mSUCCESS 0[0m in 3.97s]
[0m04:51:18.452297 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m04:51:18.456316 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:51:18.457501 [debug] [MainThread]: Connection 'model.crypto_transform.silver_transformations' was properly closed.
[0m04:51:18.458683 [info ] [MainThread]: 
[0m04:51:18.459771 [info ] [MainThread]: Finished running 1 view model, 1 incremental model in 0 hours 0 minutes and 10.55 seconds (10.55s).
[0m04:51:18.462352 [debug] [MainThread]: Command end result
[0m04:51:18.536061 [info ] [MainThread]: 
[0m04:51:18.537598 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:51:18.538680 [info ] [MainThread]: 
[0m04:51:18.539512 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:51:18.541630 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.336468, "process_user_time": 6.246794, "process_kernel_time": 1.742148, "process_mem_max_rss": "204112", "process_out_blocks": "1904", "process_in_blocks": "0"}
[0m04:51:18.543033 [debug] [MainThread]: Command `dbt run` succeeded at 04:51:18.542812 after 15.34 seconds
[0m04:51:18.543979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6379d8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db639ae2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6080b7730>]}
[0m04:51:18.544787 [debug] [MainThread]: Flushing usage events
[0m05:19:08.556267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba00a6583d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba008a9eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba0085e9520>]}


============================== 05:19:08.577774 | 07937cbb-f81f-4427-a8a1-00457577e7d0 ==============================
[0m05:19:08.577774 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:19:08.578549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:19:08.640901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03afe2f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03ae2b6ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03addc1520>]}


============================== 05:19:08.665228 | c15b2c5b-1581-47f3-834c-6dc3be40b4b3 ==============================
[0m05:19:08.665228 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:19:08.666618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:19:08.654804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db44c4e3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db42ae83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db42a625e0>]}


============================== 05:19:08.676984 | 7891c054-a707-4594-a175-49ea11a2eb08 ==============================
[0m05:19:08.676984 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:19:08.678243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:19:10.371065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c15b2c5b-1581-47f3-834c-6dc3be40b4b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03adac65e0>]}
[0m05:19:10.399229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07937cbb-f81f-4427-a8a1-00457577e7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba0083b25e0>]}
[0m05:19:10.448908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7891c054-a707-4594-a175-49ea11a2eb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db1c0dbbe0>]}
[0m05:19:10.477656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c15b2c5b-1581-47f3-834c-6dc3be40b4b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03804fba60>]}
[0m05:19:10.479465 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:19:10.507779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07937cbb-f81f-4427-a8a1-00457577e7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fe03dea60>]}
[0m05:19:10.509260 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:19:10.524460 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:19:10.557531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7891c054-a707-4594-a175-49ea11a2eb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db42af3310>]}
[0m05:19:10.559431 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:19:10.560122 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:19:10.609677 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:19:10.815155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m05:19:10.816110 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/gold/dim_symbol.sql
[0m05:19:10.816667 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/gold/fact_trades.sql
[0m05:19:10.817404 [debug] [MainThread]: Partial parsing: added file: crypto_transform://seeds/crypto_metadata.csv
[0m05:19:10.818019 [debug] [MainThread]: Partial parsing: added file: crypto_transform://snapshots/dim_symbol_snapshot.sql
[0m05:19:10.844290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m05:19:10.845739 [debug] [MainThread]: Partial parsing: added file: crypto_transform://seeds/crypto_metadata.csv
[0m05:19:10.846683 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/gold/dim_symbol.sql
[0m05:19:10.847455 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/gold/fact_trades.sql
[0m05:19:10.848233 [debug] [MainThread]: Partial parsing: added file: crypto_transform://snapshots/dim_symbol_snapshot.sql
[0m05:19:10.882665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m05:19:10.884080 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/gold/dim_symbol.sql
[0m05:19:10.884979 [debug] [MainThread]: Partial parsing: added file: crypto_transform://seeds/crypto_metadata.csv
[0m05:19:10.886036 [debug] [MainThread]: Partial parsing: added file: crypto_transform://snapshots/dim_symbol_snapshot.sql
[0m05:19:10.886856 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/gold/fact_trades.sql
[0m05:19:11.531048 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot dim_symbol_snapshot (snapshots/dim_symbol_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m05:19:11.533016 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.995214, "process_user_time": 5.475707, "process_kernel_time": 2.439933, "process_mem_max_rss": "194976", "process_in_blocks": "104", "process_out_blocks": "8", "command_success": false}
[0m05:19:11.534047 [debug] [MainThread]: Command `dbt run` failed at 05:19:11.533838 after 3.00 seconds
[0m05:19:11.534775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03afe2f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03aa1ccdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03a93e5a60>]}
[0m05:19:11.535382 [debug] [MainThread]: Flushing usage events
[0m05:19:11.580020 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot dim_symbol_snapshot (snapshots/dim_symbol_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m05:19:11.581700 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.0069375, "process_user_time": 5.418745, "process_kernel_time": 2.449724, "process_mem_max_rss": "194500", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m05:19:11.583646 [debug] [MainThread]: Command `dbt run` failed at 05:19:11.583438 after 3.01 seconds
[0m05:19:11.584759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db44c4e3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db3efece20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db3ef38940>]}
[0m05:19:11.585762 [debug] [MainThread]: Flushing usage events
[0m05:19:11.608188 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot dim_symbol_snapshot (snapshots/dim_symbol_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m05:19:11.610404 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.1621017, "process_user_time": 5.586444, "process_kernel_time": 2.698472, "process_mem_max_rss": "194056", "process_in_blocks": "1768", "process_out_blocks": "16", "command_success": false}
[0m05:19:11.614343 [debug] [MainThread]: Command `dbt test` failed at 05:19:11.612037 after 3.16 seconds
[0m05:19:11.616267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba00a6583d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba0049f3df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba00493f910>]}
[0m05:19:11.617479 [debug] [MainThread]: Flushing usage events
[0m05:20:06.760478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a209155a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a2070be4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a20714c460>]}


============================== 05:20:06.769058 | 7a93b8ba-bc57-4b47-a11f-cb20b6a20da1 ==============================
[0m05:20:06.769058 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:20:06.769859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:20:08.335037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a93b8ba-bc57-4b47-a11f-cb20b6a20da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a1e062f610>]}
[0m05:20:08.445503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a93b8ba-bc57-4b47-a11f-cb20b6a20da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a1e01a0eb0>]}
[0m05:20:08.446849 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:20:08.477057 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:20:08.675418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m05:20:08.676752 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/gold/fact_trades.sql
[0m05:20:08.677288 [debug] [MainThread]: Partial parsing: added file: crypto_transform://seeds/crypto_metadata.csv
[0m05:20:08.678017 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/gold/dim_symbol.sql
[0m05:20:08.678528 [debug] [MainThread]: Partial parsing: added file: crypto_transform://snapshots/dim_symbol_snapshot.sql
[0m05:20:09.303144 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot dim_symbol_snapshot (snapshots/dim_symbol_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m05:20:09.305021 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.6269379, "process_user_time": 4.853162, "process_kernel_time": 1.606408, "process_mem_max_rss": "194652", "process_in_blocks": "1584", "process_out_blocks": "16", "command_success": false}
[0m05:20:09.306076 [debug] [MainThread]: Command `dbt run` failed at 05:20:09.305844 after 2.63 seconds
[0m05:20:09.306796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a209155a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a2034891f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a2026e09d0>]}
[0m05:20:09.307401 [debug] [MainThread]: Flushing usage events
[0m05:21:05.369780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fcf9f3f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fcf8448ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fcf7ed3520>]}


============================== 05:21:05.379743 | 695b1d09-2975-4cf1-b982-69eee2579807 ==============================
[0m05:21:05.379743 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:21:05.381106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:21:06.906083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '695b1d09-2975-4cf1-b982-69eee2579807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fcf7c9a5e0>]}
[0m05:21:06.998496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '695b1d09-2975-4cf1-b982-69eee2579807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fcd0cdea60>]}
[0m05:21:07.000105 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:21:07.043931 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:21:07.486112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m05:21:07.487464 [debug] [MainThread]: Partial parsing: added file: crypto_transform://snapshots/dim_symbol_snapshot.sql
[0m05:21:07.488309 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/gold/dim_symbol.sql
[0m05:21:07.489105 [debug] [MainThread]: Partial parsing: added file: crypto_transform://seeds/crypto_metadata.csv
[0m05:21:07.489812 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/gold/fact_trades.sql
[0m05:21:08.226170 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot dim_symbol_snapshot (snapshots/dim_symbol_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m05:21:08.227965 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9703856, "process_user_time": 5.600415, "process_kernel_time": 1.724722, "process_mem_max_rss": "194736", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m05:21:08.229048 [debug] [MainThread]: Command `dbt run` failed at 05:21:08.228878 after 2.97 seconds
[0m05:21:08.229938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fcf9f3f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fcf42dfdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fcf34f8a30>]}
[0m05:21:08.230619 [debug] [MainThread]: Flushing usage events
[0m05:22:04.938175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a255a7ebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a253909190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a25469d2e0>]}


============================== 05:22:04.952787 | c4ccb057-819e-483c-82e8-cdb7d01f2bfa ==============================
[0m05:22:04.952787 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:22:04.955067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m05:22:06.723047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4ccb057-819e-483c-82e8-cdb7d01f2bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a22c885910>]}
[0m05:22:06.240911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4ccb057-819e-483c-82e8-cdb7d01f2bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a2546b1dc0>]}
[0m05:22:06.243408 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:22:06.295525 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:22:05.346660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m05:22:05.348243 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/gold/dim_symbol.sql
[0m05:22:05.349428 [debug] [MainThread]: Partial parsing: added file: crypto_transform://snapshots/dim_symbol_snapshot.sql
[0m05:22:05.350741 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/gold/fact_trades.sql
[0m05:22:05.351672 [debug] [MainThread]: Partial parsing: added file: crypto_transform://seeds/crypto_metadata.csv
[0m05:22:06.221283 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot dim_symbol_snapshot (snapshots/dim_symbol_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m05:22:06.223356 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.3427591, "process_user_time": 5.440974, "process_kernel_time": 1.727232, "process_mem_max_rss": "194540", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m05:22:06.224406 [debug] [MainThread]: Command `dbt run` failed at 05:22:06.224232 after 3.34 seconds
[0m05:22:06.225274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a255a7ebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a24fe08d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a24f022940>]}
[0m05:22:06.225947 [debug] [MainThread]: Flushing usage events
[0m05:23:03.089146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a035ab14c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a033915ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a0338d9670>]}


============================== 05:23:03.098509 | de8f21e6-30eb-4674-ba0d-0a9c2d860e8d ==============================
[0m05:23:03.098509 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:23:03.099597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:23:04.571036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de8f21e6-30eb-4674-ba0d-0a9c2d860e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a00c880b50>]}
[0m05:23:04.663290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de8f21e6-30eb-4674-ba0d-0a9c2d860e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a00c859760>]}
[0m05:23:04.664763 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:23:04.707688 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:23:05.000942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m05:23:05.002092 [debug] [MainThread]: Partial parsing: added file: crypto_transform://snapshots/dim_symbol_snapshot.sql
[0m05:23:05.002827 [debug] [MainThread]: Partial parsing: added file: crypto_transform://seeds/crypto_metadata.csv
[0m05:23:05.003859 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/gold/fact_trades.sql
[0m05:23:05.004543 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/gold/dim_symbol.sql
[0m05:23:05.586360 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot dim_symbol_snapshot (snapshots/dim_symbol_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m05:23:05.588340 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5861568, "process_user_time": 4.748259, "process_kernel_time": 1.781083, "process_mem_max_rss": "194900", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m05:23:05.589267 [debug] [MainThread]: Command `dbt run` failed at 05:23:05.589062 after 2.59 seconds
[0m05:23:05.590163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a035ab14c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a02fdd0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a02f068a60>]}
[0m05:23:05.590731 [debug] [MainThread]: Flushing usage events
[0m05:24:05.344158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74567eee8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74567cd49ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74567cd05670>]}


============================== 05:24:05.353161 | a7edcf71-96df-41b3-b46a-6f7e5aa914f0 ==============================
[0m05:24:05.353161 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:24:05.354982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:24:07.032091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7edcf71-96df-41b3-b46a-6f7e5aa914f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74564e5d5b50>]}
[0m05:24:07.129620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7edcf71-96df-41b3-b46a-6f7e5aa914f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74564e5ae760>]}
[0m05:24:07.131272 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:24:07.165974 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:24:07.444476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m05:24:07.446017 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/gold/fact_trades.sql
[0m05:24:07.447565 [debug] [MainThread]: Partial parsing: added file: crypto_transform://seeds/crypto_metadata.csv
[0m05:24:07.448587 [debug] [MainThread]: Partial parsing: added file: crypto_transform://snapshots/dim_symbol_snapshot.sql
[0m05:24:07.449882 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/gold/dim_symbol.sql
[0m05:24:08.236549 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot dim_symbol_snapshot (snapshots/dim_symbol_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m05:24:08.240390 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9915922, "process_user_time": 5.279339, "process_kernel_time": 1.768791, "process_mem_max_rss": "193796", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m05:24:08.241799 [debug] [MainThread]: Command `dbt run` failed at 05:24:08.241564 after 2.99 seconds
[0m05:24:08.243110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74567eee8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745679287250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74567849fa60>]}
[0m05:24:08.244095 [debug] [MainThread]: Flushing usage events
[0m05:25:05.990295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79417e1cf3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79417c658ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79417c163520>]}


============================== 05:25:06.003648 | 1ba687a9-cbdd-432d-9668-c0eb158ce15f ==============================
[0m05:25:06.003648 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:25:06.005340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m05:25:07.656043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ba687a9-cbdd-432d-9668-c0eb158ce15f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79417bf2b5e0>]}
[0m05:25:07.754090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ba687a9-cbdd-432d-9668-c0eb158ce15f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79415476ea60>]}
[0m05:25:07.755684 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:25:07.794946 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:25:08.087058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m05:25:08.088282 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/gold/dim_symbol.sql
[0m05:25:08.089067 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/gold/fact_trades.sql
[0m05:25:08.089822 [debug] [MainThread]: Partial parsing: added file: crypto_transform://snapshots/dim_symbol_snapshot.sql
[0m05:25:08.090606 [debug] [MainThread]: Partial parsing: added file: crypto_transform://seeds/crypto_metadata.csv
[0m05:25:09.231973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ba687a9-cbdd-432d-9668-c0eb158ce15f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7941751cceb0>]}
[0m05:25:09.449967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ba687a9-cbdd-432d-9668-c0eb158ce15f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7941751a5a90>]}
[0m05:25:09.450914 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m05:25:09.451466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ba687a9-cbdd-432d-9668-c0eb158ce15f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7941751524c0>]}
[0m05:25:09.453604 [info ] [MainThread]: 
[0m05:25:09.454472 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:25:09.461116 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m05:25:09.479246 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m05:25:09.479758 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m05:25:09.480315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:25:13.550058 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 4.069 seconds
[0m05:25:13.556488 [debug] [ThreadPool]: On list_streaming_db: Close
[0m05:25:14.369935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m05:25:14.390863 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m05:25:14.391686 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m05:25:14.392470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:25:15.937726 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.545 seconds
[0m05:25:15.948177 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m05:25:16.565920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ba687a9-cbdd-432d-9668-c0eb158ce15f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79417776dc40>]}
[0m05:25:16.567912 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:25:16.569051 [info ] [MainThread]: 
[0m05:25:16.586592 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m05:25:16.590490 [info ] [Thread-1  ]: 1 of 4 START sql view model public.bronze_data ................................. [RUN]
[0m05:25:16.591867 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m05:25:16.592899 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m05:25:16.610438 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m05:25:16.612104 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m05:25:16.666698 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m05:25:16.670225 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m05:25:16.671428 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m05:25:16.672437 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:25:18.883926 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.211 seconds
[0m05:25:18.933566 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m05:25:19.343710 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba687a9-cbdd-432d-9668-c0eb158ce15f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79417e1e3f10>]}
[0m05:25:19.346037 [info ] [Thread-1  ]: 1 of 4 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 2.75s]
[0m05:25:19.347948 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m05:25:19.349264 [debug] [Thread-1  ]: Began running node model.crypto_transform.dim_symbol
[0m05:25:19.351550 [info ] [Thread-1  ]: 2 of 4 START sql table model public.dim_symbol ................................. [RUN]
[0m05:25:19.353334 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.dim_symbol)
[0m05:25:19.354059 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.dim_symbol
[0m05:25:19.359486 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.dim_symbol"
[0m05:25:19.361715 [debug] [Thread-1  ]: Began executing node model.crypto_transform.dim_symbol
[0m05:25:19.400277 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.dim_symbol"
[0m05:25:19.404030 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.dim_symbol"
[0m05:25:19.405418 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.dim_symbol"} */
create or replace transient table streaming_db.public.dim_symbol
         as
        (SELECT
    -- Generate a unique Surrogate Key (INT) for the Fact table to use
    -- We use md5 hash of ticker + valid_from to ensure uniqueness for every version
    MD5(ticker || dbt_valid_from) as symbol_key,
    
    ticker,
    sector,
    risk_level,
    
    -- SCD2 Metadata
    dbt_valid_from as valid_from,
    COALESCE(dbt_valid_to, '9999-12-31'::timestamp) as valid_to,
    
    CASE 
        WHEN dbt_valid_to IS NULL THEN TRUE 
        ELSE FALSE 
    END as is_current

FROM streaming_db.public.dim_symbol_snapshot
        );
[0m05:25:19.406562 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:25:20.342515 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0f345-0001-bab5-0001-85aa00041012
[0m05:25:20.343936 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'STREAMING_DB.PUBLIC.DIM_SYMBOL_SNAPSHOT' does not exist or not authorized.
[0m05:25:20.345451 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: Close
[0m05:25:20.734661 [debug] [Thread-1  ]: Database Error in model dim_symbol (models/gold/dim_symbol.sql)
  002003 (42S02): SQL compilation error:
  Object 'STREAMING_DB.PUBLIC.DIM_SYMBOL_SNAPSHOT' does not exist or not authorized.
  compiled code at target/run/crypto_transform/models/gold/dim_symbol.sql
[0m05:25:20.736426 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba687a9-cbdd-432d-9668-c0eb158ce15f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7941703c2e50>]}
[0m05:25:20.738120 [error] [Thread-1  ]: 2 of 4 ERROR creating sql table model public.dim_symbol ........................ [[31mERROR[0m in 1.38s]
[0m05:25:20.739705 [debug] [Thread-1  ]: Finished running node model.crypto_transform.dim_symbol
[0m05:25:20.741047 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m05:25:20.742512 [info ] [Thread-1  ]: 3 of 4 START sql incremental model public.silver_transformations ............... [RUN]
[0m05:25:20.743664 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.dim_symbol, now model.crypto_transform.silver_transformations)
[0m05:25:20.744507 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m05:25:20.757391 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m05:25:20.758925 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m05:25:20.817401 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:25:20.818411 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace  temporary view streaming_db.public.silver_transformations__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
        -- INCREMENTAL LOGIC (The most important part):
        -- "Only give me rows that are NEWER than the max time currently in this table"
        AND Trade_Time > (SELECT MAX(Trade_Time) FROM streaming_db.public.silver_transformations)
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
  );
[0m05:25:20.819342 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:25:21.961779 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.142 seconds
[0m05:25:21.983858 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:25:21.984763 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations__dbt_tmp
[0m05:25:22.255630 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.270 seconds
[0m05:25:22.265528 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:25:22.266425 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations
[0m05:25:22.546838 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.279 seconds
[0m05:25:22.568520 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:25:22.569693 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table "STREAMING_DB"."PUBLIC"."SILVER_TRANSFORMATIONS"
[0m05:25:23.074393 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.504 seconds
[0m05:25:23.152807 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.silver_transformations"
[0m05:25:23.157769 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:25:23.159024 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
-- back compat for old kwarg name
  
  begin;
[0m05:25:22.814396 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.262 seconds
[0m05:25:22.815598 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:25:22.817206 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
merge into streaming_db.public.silver_transformations as DBT_INTERNAL_DEST
        using streaming_db.public.silver_transformations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.trade_id = DBT_INTERNAL_DEST.trade_id
            )

    
    when matched then update set
        "TICKER" = DBT_INTERNAL_SOURCE."TICKER","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TRADE_VALUE_USD" = DBT_INTERNAL_SOURCE."TRADE_VALUE_USD","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID","TRADE_CATEGORY" = DBT_INTERNAL_SOURCE."TRADE_CATEGORY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")
    values
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")

;
[0m05:25:22.923310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74162f5a5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74162d407ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74162d3c3670>]}


============================== 05:25:22.939173 | b1c77384-431a-4f64-ad79-d2e121098f87 ==============================
[0m05:25:22.939173 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:25:22.940346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:25:24.403762 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 2.915 seconds
[0m05:25:24.405589 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:25:24.406871 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
COMMIT
[0m05:25:24.516404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1c77384-431a-4f64-ad79-d2e121098f87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7415ffc7fb50>]}
[0m05:25:24.610129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1c77384-431a-4f64-ad79-d2e121098f87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7415febee760>]}
[0m05:25:24.611601 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:25:24.656770 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:25:24.963049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:25:24.963868 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:25:24.969036 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.561 seconds
[0m05:25:24.986348 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.silver_transformations__dbt_tmp
[0m05:25:24.997345 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:25:24.998118 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
drop view if exists streaming_db.public.silver_transformations__dbt_tmp cascade
[0m05:25:25.094520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1c77384-431a-4f64-ad79-d2e121098f87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74162988e6d0>]}
[0m05:25:25.464581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1c77384-431a-4f64-ad79-d2e121098f87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7415feac0e20>]}
[0m05:25:25.465637 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m05:25:25.467209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1c77384-431a-4f64-ad79-d2e121098f87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7415feac0400>]}
[0m05:25:25.470561 [info ] [MainThread]: 
[0m05:25:25.472307 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:25:25.474748 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m05:25:25.510868 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m05:25:25.511925 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m05:25:25.512923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:25:25.522039 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.523 seconds
[0m05:25:25.528930 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m05:25:25.901416 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba687a9-cbdd-432d-9668-c0eb158ce15f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7941703c2e80>]}
[0m05:25:25.903557 [info ] [Thread-1  ]: 3 of 4 OK created sql incremental model public.silver_transformations .......... [[32mSUCCESS 0[0m in 5.16s]
[0m05:25:25.907060 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m05:25:25.911757 [debug] [Thread-1  ]: Began running node model.crypto_transform.fact_trades
[0m05:25:25.913173 [info ] [Thread-1  ]: 4 of 4 SKIP relation public.fact_trades ........................................ [[33mSKIP[0m]
[0m05:25:25.914964 [debug] [Thread-1  ]: Finished running node model.crypto_transform.fact_trades
[0m05:25:25.923240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:25:25.924574 [debug] [MainThread]: Connection 'model.crypto_transform.silver_transformations' was properly closed.
[0m05:25:25.926198 [info ] [MainThread]: 
[0m05:25:25.927734 [info ] [MainThread]: Finished running 1 view model, 1 table model, 2 incremental models in 0 hours 0 minutes and 16.47 seconds (16.47s).
[0m05:25:25.931672 [debug] [MainThread]: Command end result
[0m05:25:26.256519 [info ] [MainThread]: 
[0m05:25:26.257535 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:25:26.258374 [info ] [MainThread]: 
[0m05:25:26.259396 [error] [MainThread]:   Database Error in model dim_symbol (models/gold/dim_symbol.sql)
  002003 (42S02): SQL compilation error:
  Object 'STREAMING_DB.PUBLIC.DIM_SYMBOL_SNAPSHOT' does not exist or not authorized.
  compiled code at target/run/crypto_transform/models/gold/dim_symbol.sql
[0m05:25:26.260142 [info ] [MainThread]: 
[0m05:25:26.260798 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m05:25:26.262745 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 22.320663, "process_user_time": 7.309565, "process_kernel_time": 1.913498, "process_mem_max_rss": "214116", "process_in_blocks": "416", "process_out_blocks": "2880", "command_success": false}
[0m05:25:26.263835 [debug] [MainThread]: Command `dbt run` failed at 05:25:26.263659 after 22.32 seconds
[0m05:25:26.264588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79417e1cf3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79417de33130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7941751523d0>]}
[0m05:25:26.265574 [debug] [MainThread]: Flushing usage events
[0m05:25:27.184607 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.671 seconds
[0m05:25:27.189776 [debug] [ThreadPool]: On list_streaming_db: Close
[0m05:25:27.590988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m05:25:27.611449 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m05:25:27.612379 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m05:25:27.613062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:25:28.545506 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.932 seconds
[0m05:25:28.552480 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m05:25:28.941884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1c77384-431a-4f64-ad79-d2e121098f87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74162994a550>]}
[0m05:25:28.943864 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:25:28.945025 [info ] [MainThread]: 
[0m05:25:28.964787 [debug] [Thread-1  ]: Began running node seed.crypto_transform.crypto_metadata
[0m05:25:28.967023 [info ] [Thread-1  ]: 1 of 1 START seed file public.crypto_metadata .................................. [RUN]
[0m05:25:28.968817 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now seed.crypto_transform.crypto_metadata)
[0m05:25:28.970159 [debug] [Thread-1  ]: Began compiling node seed.crypto_transform.crypto_metadata
[0m05:25:28.971156 [debug] [Thread-1  ]: Began executing node seed.crypto_transform.crypto_metadata
[0m05:25:29.064673 [debug] [Thread-1  ]: Using snowflake connection "seed.crypto_transform.crypto_metadata"
[0m05:25:29.066319 [debug] [Thread-1  ]: On seed.crypto_transform.crypto_metadata: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "seed.crypto_transform.crypto_metadata"} */
create table streaming_db.public.crypto_metadata (ticker text,sector text,risk_level text)
[0m05:25:29.067564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:25:30.056024 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.988 seconds
[0m05:25:30.082950 [debug] [Thread-1  ]: Using snowflake connection "seed.crypto_transform.crypto_metadata"
[0m05:25:30.083784 [debug] [Thread-1  ]: On seed.crypto_transform.crypto_metadata: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "seed.crypto_transform.crypto_metadata"} */
BEGIN
[0m05:25:30.306612 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.222 seconds
[0m05:25:30.309543 [debug] [Thread-1  ]: Using snowflake connection "seed.crypto_transform.crypto_metadata"
[0m05:25:30.314587 [debug] [Thread-1  ]: On seed.crypto_transform.crypto_metadata: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "seed.crypto_transform.crypto_metadata"} */
insert into streaming_db.public.crypto_metadata (ticker, sector, risk_level) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)...
[0m05:25:30.822634 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.507 seconds
[0m05:25:30.824464 [debug] [Thread-1  ]: Using snowflake connection "seed.crypto_transform.crypto_metadata"
[0m05:25:30.825460 [debug] [Thread-1  ]: On seed.crypto_transform.crypto_metadata: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "seed.crypto_transform.crypto_metadata"} */
COMMIT
[0m05:25:31.218525 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.392 seconds
[0m05:25:31.232065 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.crypto_transform.crypto_metadata"
[0m05:25:31.276127 [debug] [Thread-1  ]: On seed.crypto_transform.crypto_metadata: Close
[0m05:25:31.680970 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1c77384-431a-4f64-ad79-d2e121098f87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74162f3debb0>]}
[0m05:25:31.682862 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.crypto_metadata .............................. [[32mINSERT 5[0m in 2.71s]
[0m05:25:31.686142 [debug] [Thread-1  ]: Finished running node seed.crypto_transform.crypto_metadata
[0m05:25:31.691253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:25:31.692311 [debug] [MainThread]: Connection 'seed.crypto_transform.crypto_metadata' was properly closed.
[0m05:25:31.693406 [info ] [MainThread]: 
[0m05:25:31.695075 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.22 seconds (6.22s).
[0m05:25:31.699254 [debug] [MainThread]: Command end result
[0m05:25:31.782808 [info ] [MainThread]: 
[0m05:25:31.785753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:25:31.787228 [info ] [MainThread]: 
[0m05:25:31.788481 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:25:31.790842 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 8.978504, "process_user_time": 5.91128, "process_kernel_time": 1.776427, "process_mem_max_rss": "203392", "process_in_blocks": "88", "process_out_blocks": "1880"}
[0m05:25:31.792500 [debug] [MainThread]: Command `dbt seed` succeeded at 05:25:31.792237 after 8.98 seconds
[0m05:25:31.793835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74162f5a5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7415ffcb8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74162f214310>]}
[0m05:25:31.795180 [debug] [MainThread]: Flushing usage events
[0m05:26:05.713710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca99e7c76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca99c6571c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca99e44fa00>]}


============================== 05:26:05.724053 | b867a440-76eb-4d9c-b0e9-7d94e5f44362 ==============================
[0m05:26:05.724053 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:26:05.725209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:26:07.406080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b867a440-76eb-4d9c-b0e9-7d94e5f44362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca97556f640>]}
[0m05:26:07.545964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b867a440-76eb-4d9c-b0e9-7d94e5f44362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca99ccdc0a0>]}
[0m05:26:07.548648 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:26:07.606323 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:26:07.942210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:26:07.943201 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:26:08.120929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b867a440-76eb-4d9c-b0e9-7d94e5f44362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca998a9e370>]}
[0m05:26:08.481667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b867a440-76eb-4d9c-b0e9-7d94e5f44362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca998a3af40>]}
[0m05:26:08.482929 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m05:26:08.483748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b867a440-76eb-4d9c-b0e9-7d94e5f44362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca998ac9940>]}
[0m05:26:08.486370 [info ] [MainThread]: 
[0m05:26:08.487677 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:26:08.498388 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m05:26:08.531647 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m05:26:08.532541 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m05:26:08.533354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:26:10.495411 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.962 seconds
[0m05:26:10.500929 [debug] [ThreadPool]: On list_streaming_db: Close
[0m05:26:10.906763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m05:26:10.940530 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m05:26:10.942508 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m05:26:10.943623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:26:12.212560 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.269 seconds
[0m05:26:12.217564 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m05:26:12.622735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b867a440-76eb-4d9c-b0e9-7d94e5f44362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca97616ab20>]}
[0m05:26:12.624590 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:26:12.625467 [info ] [MainThread]: 
[0m05:26:12.644910 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m05:26:12.647560 [info ] [Thread-1  ]: 1 of 4 START sql view model public.bronze_data ................................. [RUN]
[0m05:26:12.649137 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m05:26:12.650239 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m05:26:12.671673 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m05:26:12.673305 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m05:26:12.739809 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m05:26:12.747288 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m05:26:12.748600 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m05:26:12.749726 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:26:14.028524 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.278 seconds
[0m05:26:14.106914 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m05:26:14.527457 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b867a440-76eb-4d9c-b0e9-7d94e5f44362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca99e7c6df0>]}
[0m05:26:14.529412 [info ] [Thread-1  ]: 1 of 4 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.87s]
[0m05:26:14.531202 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m05:26:14.532480 [debug] [Thread-1  ]: Began running node model.crypto_transform.dim_symbol
[0m05:26:14.534209 [info ] [Thread-1  ]: 2 of 4 START sql table model public.dim_symbol ................................. [RUN]
[0m05:26:14.536701 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.dim_symbol)
[0m05:26:14.538411 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.dim_symbol
[0m05:26:14.548194 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.dim_symbol"
[0m05:26:14.549874 [debug] [Thread-1  ]: Began executing node model.crypto_transform.dim_symbol
[0m05:26:14.591791 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.dim_symbol"
[0m05:26:14.594393 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.dim_symbol"
[0m05:26:14.595323 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.dim_symbol"} */
create or replace transient table streaming_db.public.dim_symbol
         as
        (SELECT
    -- Generate a unique Surrogate Key (INT) for the Fact table to use
    -- We use md5 hash of ticker + valid_from to ensure uniqueness for every version
    MD5(ticker || dbt_valid_from) as symbol_key,
    
    ticker,
    sector,
    risk_level,
    
    -- SCD2 Metadata
    dbt_valid_from as valid_from,
    COALESCE(dbt_valid_to, '9999-12-31'::timestamp) as valid_to,
    
    CASE 
        WHEN dbt_valid_to IS NULL THEN TRUE 
        ELSE FALSE 
    END as is_current

FROM streaming_db.public.dim_symbol_snapshot
        );
[0m05:26:14.596216 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:26:16.297202 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0f346-0001-bab5-0001-85aa0004101a
[0m05:26:16.298313 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'STREAMING_DB.PUBLIC.DIM_SYMBOL_SNAPSHOT' does not exist or not authorized.
[0m05:26:16.299595 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: Close
[0m05:26:16.688949 [debug] [Thread-1  ]: Database Error in model dim_symbol (models/gold/dim_symbol.sql)
  002003 (42S02): SQL compilation error:
  Object 'STREAMING_DB.PUBLIC.DIM_SYMBOL_SNAPSHOT' does not exist or not authorized.
  compiled code at target/run/crypto_transform/models/gold/dim_symbol.sql
[0m05:26:16.690934 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b867a440-76eb-4d9c-b0e9-7d94e5f44362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca9984daeb0>]}
[0m05:26:16.692373 [error] [Thread-1  ]: 2 of 4 ERROR creating sql table model public.dim_symbol ........................ [[31mERROR[0m in 2.15s]
[0m05:26:16.693887 [debug] [Thread-1  ]: Finished running node model.crypto_transform.dim_symbol
[0m05:26:16.695528 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m05:26:16.696984 [info ] [Thread-1  ]: 3 of 4 START sql incremental model public.silver_transformations ............... [RUN]
[0m05:26:16.698058 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.dim_symbol, now model.crypto_transform.silver_transformations)
[0m05:26:16.699012 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m05:26:16.717439 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m05:26:16.718784 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m05:26:16.779398 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:26:16.780502 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace  temporary view streaming_db.public.silver_transformations__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
        -- INCREMENTAL LOGIC (The most important part):
        -- "Only give me rows that are NEWER than the max time currently in this table"
        AND Trade_Time > (SELECT MAX(Trade_Time) FROM streaming_db.public.silver_transformations)
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
  );
[0m05:26:16.781317 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:26:18.023620 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.242 seconds
[0m05:26:18.042493 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:26:18.043405 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations__dbt_tmp
[0m05:26:18.321681 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.277 seconds
[0m05:26:18.337798 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:26:18.339875 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations
[0m05:26:18.604225 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.261 seconds
[0m05:26:18.622358 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:26:18.623322 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table "STREAMING_DB"."PUBLIC"."SILVER_TRANSFORMATIONS"
[0m05:26:18.877802 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.253 seconds
[0m05:26:18.932972 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.silver_transformations"
[0m05:26:18.936339 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:26:18.937144 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
-- back compat for old kwarg name
  
  begin;
[0m05:26:19.194051 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.256 seconds
[0m05:26:19.195805 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:26:19.196854 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
merge into streaming_db.public.silver_transformations as DBT_INTERNAL_DEST
        using streaming_db.public.silver_transformations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.trade_id = DBT_INTERNAL_DEST.trade_id
            )

    
    when matched then update set
        "TICKER" = DBT_INTERNAL_SOURCE."TICKER","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TRADE_VALUE_USD" = DBT_INTERNAL_SOURCE."TRADE_VALUE_USD","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID","TRADE_CATEGORY" = DBT_INTERNAL_SOURCE."TRADE_CATEGORY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")
    values
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")

;
[0m05:26:19.297922 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 2.088 seconds
[0m05:26:19.299644 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:26:19.300923 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
COMMIT
[0m05:26:19.657602 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.355 seconds
[0m05:26:19.677590 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.silver_transformations__dbt_tmp
[0m05:26:19.690301 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:26:19.691588 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
drop view if exists streaming_db.public.silver_transformations__dbt_tmp cascade
[0m05:26:19.937685 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.245 seconds
[0m05:26:19.944087 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m05:26:20.320186 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b867a440-76eb-4d9c-b0e9-7d94e5f44362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca9983cd2e0>]}
[0m05:26:20.322380 [info ] [Thread-1  ]: 3 of 4 OK created sql incremental model public.silver_transformations .......... [[32mSUCCESS 0[0m in 3.62s]
[0m05:26:20.324128 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m05:26:20.327138 [debug] [Thread-1  ]: Began running node model.crypto_transform.fact_trades
[0m05:26:20.328023 [info ] [Thread-1  ]: 4 of 4 SKIP relation public.fact_trades ........................................ [[33mSKIP[0m]
[0m05:26:20.329164 [debug] [Thread-1  ]: Finished running node model.crypto_transform.fact_trades
[0m05:26:20.332874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:26:20.333880 [debug] [MainThread]: Connection 'model.crypto_transform.silver_transformations' was properly closed.
[0m05:26:20.335365 [info ] [MainThread]: 
[0m05:26:20.336418 [info ] [MainThread]: Finished running 1 view model, 1 table model, 2 incremental models in 0 hours 0 minutes and 11.85 seconds (11.85s).
[0m05:26:20.339557 [debug] [MainThread]: Command end result
[0m05:26:20.407466 [info ] [MainThread]: 
[0m05:26:20.408635 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:26:20.409375 [info ] [MainThread]: 
[0m05:26:20.410510 [error] [MainThread]:   Database Error in model dim_symbol (models/gold/dim_symbol.sql)
  002003 (42S02): SQL compilation error:
  Object 'STREAMING_DB.PUBLIC.DIM_SYMBOL_SNAPSHOT' does not exist or not authorized.
  compiled code at target/run/crypto_transform/models/gold/dim_symbol.sql
[0m05:26:20.411389 [info ] [MainThread]: 
[0m05:26:20.412215 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m05:26:20.414182 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 16.797356, "process_user_time": 6.56141, "process_kernel_time": 1.915767, "process_mem_max_rss": "205816", "process_out_blocks": "1976", "command_success": false, "process_in_blocks": "0"}
[0m05:26:20.415450 [debug] [MainThread]: Command `dbt run` failed at 05:26:20.415191 after 16.80 seconds
[0m05:26:20.416468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca99e7c76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca998a3af40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca99d8e3310>]}
[0m05:26:20.417296 [debug] [MainThread]: Flushing usage events
[0m05:27:05.007547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c281b8fba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c28198644f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c28198f2460>]}


============================== 05:27:05.016591 | 2889b11f-074b-4713-8767-aef8580487ca ==============================
[0m05:27:05.016591 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:27:05.017655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:27:06.503063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2889b11f-074b-4713-8767-aef8580487ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c27eaf95610>]}
[0m05:27:06.630588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2889b11f-074b-4713-8767-aef8580487ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c27eaf1feb0>]}
[0m05:27:06.633062 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:27:06.677645 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:27:07.001394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:27:07.002351 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:27:07.140346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2889b11f-074b-4713-8767-aef8580487ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2815b786a0>]}
[0m05:27:07.666774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2889b11f-074b-4713-8767-aef8580487ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2815b57fa0>]}
[0m05:27:07.668123 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m05:27:07.669373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2889b11f-074b-4713-8767-aef8580487ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2815b92940>]}
[0m05:27:07.673973 [info ] [MainThread]: 
[0m05:27:07.675737 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:27:07.686745 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m05:27:07.715318 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m05:27:07.716221 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m05:27:07.716918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:27:09.269782 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.552 seconds
[0m05:27:09.275439 [debug] [ThreadPool]: On list_streaming_db: Close
[0m05:27:09.680609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m05:27:09.704087 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m05:27:09.705119 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m05:27:09.706056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:27:10.981750 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.276 seconds
[0m05:27:10.987189 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m05:27:11.416778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2889b11f-074b-4713-8767-aef8580487ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2815b7b070>]}
[0m05:27:11.419175 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:27:11.420518 [info ] [MainThread]: 
[0m05:27:11.442822 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m05:27:11.445520 [info ] [Thread-1  ]: 1 of 4 START sql view model public.bronze_data ................................. [RUN]
[0m05:27:11.447530 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m05:27:11.448968 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m05:27:11.471906 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m05:27:11.473735 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m05:27:11.538026 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m05:27:11.542664 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m05:27:11.544297 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m05:27:11.545591 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:27:12.580658 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.035 seconds
[0m05:27:12.632031 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m05:27:13.037605 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2889b11f-074b-4713-8767-aef8580487ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c27ef226610>]}
[0m05:27:13.039493 [info ] [Thread-1  ]: 1 of 4 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.59s]
[0m05:27:13.041089 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m05:27:13.042349 [debug] [Thread-1  ]: Began running node model.crypto_transform.dim_symbol
[0m05:27:13.044175 [info ] [Thread-1  ]: 2 of 4 START sql table model public.dim_symbol ................................. [RUN]
[0m05:27:13.045520 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.dim_symbol)
[0m05:27:13.046295 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.dim_symbol
[0m05:27:13.052241 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.dim_symbol"
[0m05:27:13.053681 [debug] [Thread-1  ]: Began executing node model.crypto_transform.dim_symbol
[0m05:27:13.095751 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.dim_symbol"
[0m05:27:13.099040 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.dim_symbol"
[0m05:27:13.100060 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.dim_symbol"} */
create or replace transient table streaming_db.public.dim_symbol
         as
        (SELECT
    -- Generate a unique Surrogate Key (INT) for the Fact table to use
    -- We use md5 hash of ticker + valid_from to ensure uniqueness for every version
    MD5(ticker || dbt_valid_from) as symbol_key,
    
    ticker,
    sector,
    risk_level,
    
    -- SCD2 Metadata
    dbt_valid_from as valid_from,
    COALESCE(dbt_valid_to, '9999-12-31'::timestamp) as valid_to,
    
    CASE 
        WHEN dbt_valid_to IS NULL THEN TRUE 
        ELSE FALSE 
    END as is_current

FROM streaming_db.public.dim_symbol_snapshot
        );
[0m05:27:13.100930 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:27:14.055614 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0f347-0001-baae-0001-85aa0003f02e
[0m05:27:14.057901 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'STREAMING_DB.PUBLIC.DIM_SYMBOL_SNAPSHOT' does not exist or not authorized.
[0m05:27:14.060637 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: Close
[0m05:27:14.684409 [debug] [Thread-1  ]: Database Error in model dim_symbol (models/gold/dim_symbol.sql)
  002003 (42S02): SQL compilation error:
  Object 'STREAMING_DB.PUBLIC.DIM_SYMBOL_SNAPSHOT' does not exist or not authorized.
  compiled code at target/run/crypto_transform/models/gold/dim_symbol.sql
[0m05:27:14.686175 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2889b11f-074b-4713-8767-aef8580487ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c28155fcf10>]}
[0m05:27:14.688446 [error] [Thread-1  ]: 2 of 4 ERROR creating sql table model public.dim_symbol ........................ [[31mERROR[0m in 1.64s]
[0m05:27:14.690271 [debug] [Thread-1  ]: Finished running node model.crypto_transform.dim_symbol
[0m05:27:14.691941 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m05:27:14.693431 [info ] [Thread-1  ]: 3 of 4 START sql incremental model public.silver_transformations ............... [RUN]
[0m05:27:14.695173 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.dim_symbol, now model.crypto_transform.silver_transformations)
[0m05:27:14.697004 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m05:27:14.726463 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m05:27:14.728739 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m05:27:14.808370 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:27:14.809525 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace  temporary view streaming_db.public.silver_transformations__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
        -- INCREMENTAL LOGIC (The most important part):
        -- "Only give me rows that are NEWER than the max time currently in this table"
        AND Trade_Time > (SELECT MAX(Trade_Time) FROM streaming_db.public.silver_transformations)
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
  );
[0m05:27:14.810671 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:27:13.945882 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.177 seconds
[0m05:27:13.963347 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:27:13.964247 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations__dbt_tmp
[0m05:27:14.192957 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.227 seconds
[0m05:27:14.207804 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:27:14.209696 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations
[0m05:27:14.440874 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.230 seconds
[0m05:27:14.471594 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:27:14.473553 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table "STREAMING_DB"."PUBLIC"."SILVER_TRANSFORMATIONS"
[0m05:27:14.732820 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.258 seconds
[0m05:27:14.791536 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.silver_transformations"
[0m05:27:14.794772 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:27:14.795713 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
-- back compat for old kwarg name
  
  begin;
[0m05:27:15.056139 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.259 seconds
[0m05:27:15.057934 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:27:15.058830 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
merge into streaming_db.public.silver_transformations as DBT_INTERNAL_DEST
        using streaming_db.public.silver_transformations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.trade_id = DBT_INTERNAL_DEST.trade_id
            )

    
    when matched then update set
        "TICKER" = DBT_INTERNAL_SOURCE."TICKER","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TRADE_VALUE_USD" = DBT_INTERNAL_SOURCE."TRADE_VALUE_USD","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID","TRADE_CATEGORY" = DBT_INTERNAL_SOURCE."TRADE_CATEGORY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")
    values
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")

;
[0m05:27:16.879868 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.820 seconds
[0m05:27:16.881512 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:27:16.882690 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
COMMIT
[0m05:27:17.240914 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.357 seconds
[0m05:27:17.258461 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.silver_transformations__dbt_tmp
[0m05:27:17.269908 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:27:17.270827 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
drop view if exists streaming_db.public.silver_transformations__dbt_tmp cascade
[0m05:27:17.520005 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.248 seconds
[0m05:27:17.525357 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m05:27:17.900611 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2889b11f-074b-4713-8767-aef8580487ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2815500ca0>]}
[0m05:27:17.902581 [info ] [Thread-1  ]: 3 of 4 OK created sql incremental model public.silver_transformations .......... [[32mSUCCESS 0[0m in 3.21s]
[0m05:27:17.904262 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m05:27:17.906961 [debug] [Thread-1  ]: Began running node model.crypto_transform.fact_trades
[0m05:27:17.908183 [info ] [Thread-1  ]: 4 of 4 SKIP relation public.fact_trades ........................................ [[33mSKIP[0m]
[0m05:27:17.909691 [debug] [Thread-1  ]: Finished running node model.crypto_transform.fact_trades
[0m05:27:17.912711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:27:17.913801 [debug] [MainThread]: Connection 'model.crypto_transform.silver_transformations' was properly closed.
[0m05:27:17.914673 [info ] [MainThread]: 
[0m05:27:17.915445 [info ] [MainThread]: Finished running 1 view model, 1 table model, 2 incremental models in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m05:27:17.917735 [debug] [MainThread]: Command end result
[0m05:27:17.982745 [info ] [MainThread]: 
[0m05:27:17.983920 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:27:17.984538 [info ] [MainThread]: 
[0m05:27:17.985815 [error] [MainThread]:   Database Error in model dim_symbol (models/gold/dim_symbol.sql)
  002003 (42S02): SQL compilation error:
  Object 'STREAMING_DB.PUBLIC.DIM_SYMBOL_SNAPSHOT' does not exist or not authorized.
  compiled code at target/run/crypto_transform/models/gold/dim_symbol.sql
[0m05:27:17.986576 [info ] [MainThread]: 
[0m05:27:17.987388 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m05:27:17.989778 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.124435, "process_user_time": 6.138745, "process_kernel_time": 1.88225, "process_mem_max_rss": "206136", "process_out_blocks": "1968", "command_success": false, "process_in_blocks": "0"}
[0m05:27:17.991110 [debug] [MainThread]: Command `dbt run` failed at 05:27:17.990791 after 15.13 seconds
[0m05:27:17.992053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c281b8fba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c281b5292e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2815b57fd0>]}
[0m05:27:17.992895 [debug] [MainThread]: Flushing usage events
[0m05:28:04.862893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5376713460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a53745ed3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a53745635e0>]}


============================== 05:28:04.871891 | a14f13fa-ac97-47ee-ba46-27929b0b56c0 ==============================
[0m05:28:04.871891 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:28:04.873089 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m05:28:06.332256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a14f13fa-ac97-47ee-ba46-27929b0b56c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a534d4a2b80>]}
[0m05:28:06.427387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a14f13fa-ac97-47ee-ba46-27929b0b56c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a53745f9370>]}
[0m05:28:06.428931 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:28:06.467102 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:28:06.806398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:28:06.807212 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:28:06.942897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a14f13fa-ac97-47ee-ba46-27929b0b56c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a53709fd730>]}
[0m05:28:07.300376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a14f13fa-ac97-47ee-ba46-27929b0b56c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a53709d6b50>]}
[0m05:28:07.301471 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m05:28:07.302245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a14f13fa-ac97-47ee-ba46-27929b0b56c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5370a17910>]}
[0m05:28:07.304844 [info ] [MainThread]: 
[0m05:28:07.306174 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:28:07.316405 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m05:28:07.342405 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m05:28:07.343102 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m05:28:07.343744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:28:08.816053 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.472 seconds
[0m05:28:08.821653 [debug] [ThreadPool]: On list_streaming_db: Close
[0m05:28:09.221529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m05:28:09.243335 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m05:28:09.244096 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m05:28:09.244818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:28:10.404781 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.160 seconds
[0m05:28:10.411714 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m05:28:10.805917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a14f13fa-ac97-47ee-ba46-27929b0b56c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5376437a90>]}
[0m05:28:10.807897 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:28:10.808919 [info ] [MainThread]: 
[0m05:28:10.825376 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m05:28:10.827504 [info ] [Thread-1  ]: 1 of 4 START sql view model public.bronze_data ................................. [RUN]
[0m05:28:10.828725 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m05:28:10.829752 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m05:28:10.850926 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m05:28:10.853279 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m05:28:10.912797 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m05:28:10.915650 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m05:28:10.916445 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m05:28:10.917259 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:28:10.184126 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.243 seconds
[0m05:28:10.233789 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m05:28:10.619866 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14f13fa-ac97-47ee-ba46-27929b0b56c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a53763e0d00>]}
[0m05:28:10.621911 [info ] [Thread-1  ]: 1 of 4 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in -0.21s]
[0m05:28:10.623870 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m05:28:10.625077 [debug] [Thread-1  ]: Began running node model.crypto_transform.dim_symbol
[0m05:28:10.627179 [info ] [Thread-1  ]: 2 of 4 START sql table model public.dim_symbol ................................. [RUN]
[0m05:28:10.628951 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.dim_symbol)
[0m05:28:10.629830 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.dim_symbol
[0m05:28:10.636413 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.dim_symbol"
[0m05:28:10.637922 [debug] [Thread-1  ]: Began executing node model.crypto_transform.dim_symbol
[0m05:28:10.681573 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.dim_symbol"
[0m05:28:10.684445 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.dim_symbol"
[0m05:28:10.685354 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.dim_symbol"} */
create or replace transient table streaming_db.public.dim_symbol
         as
        (SELECT
    -- Generate a unique Surrogate Key (INT) for the Fact table to use
    -- We use md5 hash of ticker + valid_from to ensure uniqueness for every version
    MD5(ticker || dbt_valid_from) as symbol_key,
    
    ticker,
    sector,
    risk_level,
    
    -- SCD2 Metadata
    dbt_valid_from as valid_from,
    COALESCE(dbt_valid_to, '9999-12-31'::timestamp) as valid_to,
    
    CASE 
        WHEN dbt_valid_to IS NULL THEN TRUE 
        ELSE FALSE 
    END as is_current

FROM streaming_db.public.dim_symbol_snapshot
        );
[0m05:28:10.686085 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:28:11.591672 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0f348-0001-ba8e-0001-85aa00042026
[0m05:28:11.593302 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'STREAMING_DB.PUBLIC.DIM_SYMBOL_SNAPSHOT' does not exist or not authorized.
[0m05:28:11.595344 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: Close
[0m05:28:11.987723 [debug] [Thread-1  ]: Database Error in model dim_symbol (models/gold/dim_symbol.sql)
  002003 (42S02): SQL compilation error:
  Object 'STREAMING_DB.PUBLIC.DIM_SYMBOL_SNAPSHOT' does not exist or not authorized.
  compiled code at target/run/crypto_transform/models/gold/dim_symbol.sql
[0m05:28:11.989413 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14f13fa-ac97-47ee-ba46-27929b0b56c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5370399e50>]}
[0m05:28:11.991111 [error] [Thread-1  ]: 2 of 4 ERROR creating sql table model public.dim_symbol ........................ [[31mERROR[0m in 1.36s]
[0m05:28:11.992634 [debug] [Thread-1  ]: Finished running node model.crypto_transform.dim_symbol
[0m05:28:11.993933 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m05:28:11.995497 [info ] [Thread-1  ]: 3 of 4 START sql incremental model public.silver_transformations ............... [RUN]
[0m05:28:11.996564 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.dim_symbol, now model.crypto_transform.silver_transformations)
[0m05:28:11.997387 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m05:28:12.015931 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m05:28:12.017208 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m05:28:12.079141 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:28:12.080283 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace  temporary view streaming_db.public.silver_transformations__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
        -- INCREMENTAL LOGIC (The most important part):
        -- "Only give me rows that are NEWER than the max time currently in this table"
        AND Trade_Time > (SELECT MAX(Trade_Time) FROM streaming_db.public.silver_transformations)
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
  );
[0m05:28:12.081104 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:28:13.092072 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.011 seconds
[0m05:28:13.111467 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:28:13.112290 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations__dbt_tmp
[0m05:28:13.348811 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.235 seconds
[0m05:28:13.359009 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:28:13.360158 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations
[0m05:28:13.597308 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.236 seconds
[0m05:28:13.618136 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:28:13.620109 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table "STREAMING_DB"."PUBLIC"."SILVER_TRANSFORMATIONS"
[0m05:28:13.855941 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.234 seconds
[0m05:28:13.923448 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.silver_transformations"
[0m05:28:13.927490 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:28:13.928726 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
-- back compat for old kwarg name
  
  begin;
[0m05:28:14.176133 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.246 seconds
[0m05:28:14.177912 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:28:14.179971 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
merge into streaming_db.public.silver_transformations as DBT_INTERNAL_DEST
        using streaming_db.public.silver_transformations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.trade_id = DBT_INTERNAL_DEST.trade_id
            )

    
    when matched then update set
        "TICKER" = DBT_INTERNAL_SOURCE."TICKER","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TRADE_VALUE_USD" = DBT_INTERNAL_SOURCE."TRADE_VALUE_USD","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID","TRADE_CATEGORY" = DBT_INTERNAL_SOURCE."TRADE_CATEGORY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")
    values
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")

;
[0m05:28:16.828112 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 2.647 seconds
[0m05:28:16.829865 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:28:16.831532 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
COMMIT
[0m05:28:17.240381 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.407 seconds
[0m05:28:17.264933 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.silver_transformations__dbt_tmp
[0m05:28:17.279610 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:28:17.280547 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
drop view if exists streaming_db.public.silver_transformations__dbt_tmp cascade
[0m05:28:17.570618 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.289 seconds
[0m05:28:17.576145 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m05:28:17.969769 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14f13fa-ac97-47ee-ba46-27929b0b56c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5370399e50>]}
[0m05:28:17.971804 [info ] [Thread-1  ]: 3 of 4 OK created sql incremental model public.silver_transformations .......... [[32mSUCCESS 0[0m in 5.97s]
[0m05:28:17.973796 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m05:28:17.985597 [debug] [Thread-1  ]: Began running node model.crypto_transform.fact_trades
[0m05:28:17.987182 [info ] [Thread-1  ]: 4 of 4 SKIP relation public.fact_trades ........................................ [[33mSKIP[0m]
[0m05:28:17.988491 [debug] [Thread-1  ]: Finished running node model.crypto_transform.fact_trades
[0m05:28:17.992811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:28:17.993759 [debug] [MainThread]: Connection 'model.crypto_transform.silver_transformations' was properly closed.
[0m05:28:17.994980 [info ] [MainThread]: 
[0m05:28:17.996224 [info ] [MainThread]: Finished running 1 view model, 1 table model, 2 incremental models in 0 hours 0 minutes and 10.69 seconds (10.69s).
[0m05:28:17.999926 [debug] [MainThread]: Command end result
[0m05:28:18.068419 [info ] [MainThread]: 
[0m05:28:18.069443 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:28:18.070243 [info ] [MainThread]: 
[0m05:28:18.071716 [error] [MainThread]:   Database Error in model dim_symbol (models/gold/dim_symbol.sql)
  002003 (42S02): SQL compilation error:
  Object 'STREAMING_DB.PUBLIC.DIM_SYMBOL_SNAPSHOT' does not exist or not authorized.
  compiled code at target/run/crypto_transform/models/gold/dim_symbol.sql
[0m05:28:18.072896 [info ] [MainThread]: 
[0m05:28:18.073796 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m05:28:18.076260 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.282662, "process_user_time": 5.937819, "process_kernel_time": 1.714169, "process_mem_max_rss": "206092", "process_out_blocks": "1976", "command_success": false, "process_in_blocks": "0"}
[0m05:28:18.077993 [debug] [MainThread]: Command `dbt run` failed at 05:28:18.077751 after 15.28 seconds
[0m05:28:18.079175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5376713460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a53763aa4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5374c84130>]}
[0m05:28:18.080307 [debug] [MainThread]: Flushing usage events
[0m05:28:39.899386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db9f84ba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db9d6567c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db9d6564c0>]}


============================== 05:28:39.909585 | cc0cf56d-ab86-48d3-9c21-53317d60984c ==============================
[0m05:28:39.909585 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:28:39.911868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:28:41.341349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc0cf56d-ab86-48d3-9c21-53317d60984c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db6ff6e3d0>]}
[0m05:28:41.442399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc0cf56d-ab86-48d3-9c21-53317d60984c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db9e472070>]}
[0m05:28:41.444620 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:28:41.493245 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:28:41.799198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:28:41.800020 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:28:41.970283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc0cf56d-ab86-48d3-9c21-53317d60984c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db99b20640>]}
[0m05:28:42.330099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc0cf56d-ab86-48d3-9c21-53317d60984c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db99b4b490>]}
[0m05:28:42.331264 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m05:28:42.332366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc0cf56d-ab86-48d3-9c21-53317d60984c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db99b4bc40>]}
[0m05:28:42.335221 [info ] [MainThread]: 
[0m05:28:42.337047 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:28:42.339363 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m05:28:42.373588 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m05:28:42.374409 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m05:28:42.375106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:29:04.899966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ded23baa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ded03234f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ded03b1460>]}


============================== 05:29:04.908584 | 64630ed3-efa2-4902-bca7-4496462857f3 ==============================
[0m05:29:04.908584 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:29:04.909516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:29:06.458587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64630ed3-efa2-4902-bca7-4496462857f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72dea915a610>]}
[0m05:29:06.585635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64630ed3-efa2-4902-bca7-4496462857f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72dea90e3eb0>]}
[0m05:29:06.587432 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:29:06.634404 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:29:06.962023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:29:06.963606 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:29:07.087116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64630ed3-efa2-4902-bca7-4496462857f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72decc6346a0>]}
[0m05:29:07.449984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64630ed3-efa2-4902-bca7-4496462857f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72decc616fa0>]}
[0m05:29:07.451150 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m05:29:07.451887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64630ed3-efa2-4902-bca7-4496462857f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72decc650940>]}
[0m05:29:07.454350 [info ] [MainThread]: 
[0m05:29:07.455425 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:29:07.465219 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m05:29:07.492163 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m05:29:07.492925 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m05:29:07.493635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:29:14.852810 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m05:29:14.854061 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m05:29:14.855441 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m05:29:14.856503 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m05:29:14.857604 [debug] [ThreadPool]: On list_streaming_db: No close available on handle
[0m05:29:14.859715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:29:14.860781 [debug] [MainThread]: Connection 'list_streaming_db' was properly closed.
[0m05:29:14.861732 [info ] [MainThread]: 
[0m05:29:14.862578 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 32.53 seconds (32.53s).
[0m05:29:14.864326 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "streaming_db"
  Database Error
    250001: Could not connect to Snowflake backend after 1 attempt(s).Aborting
[0m05:29:14.866865 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 36.675285, "process_user_time": 5.13941, "process_kernel_time": 1.874145, "process_mem_max_rss": "194076", "process_in_blocks": "8", "process_out_blocks": "952", "command_success": false}
[0m05:29:14.868047 [debug] [MainThread]: Command `dbt snapshot` failed at 05:29:14.867749 after 36.68 seconds
[0m05:29:14.868929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db9f84ba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db9e47a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db99b4bb80>]}
[0m05:29:14.869788 [debug] [MainThread]: Flushing usage events
[0m05:29:14.884272 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m05:29:15.878242 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m05:29:15.880110 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m05:29:15.883102 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m05:29:15.890353 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m05:29:15.891812 [debug] [ThreadPool]: On list_streaming_db: No close available on handle
[0m05:29:15.895438 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:29:15.896277 [debug] [MainThread]: Connection 'list_streaming_db' was properly closed.
[0m05:29:15.897186 [info ] [MainThread]: 
[0m05:29:15.900123 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 8.44 seconds (8.44s).
[0m05:29:15.901480 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "streaming_db"
  Database Error
    250001: Could not connect to Snowflake backend after 1 attempt(s).Aborting
[0m05:29:15.909514 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.7033415, "process_user_time": 5.019826, "process_kernel_time": 1.542426, "process_mem_max_rss": "194256", "process_out_blocks": "952", "command_success": false, "process_in_blocks": "0"}
[0m05:29:15.912825 [debug] [MainThread]: Command `dbt run` failed at 05:29:15.911837 after 12.71 seconds
[0m05:29:15.913904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ded23baa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ded4392130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72decc650ac0>]}
[0m05:29:15.915015 [debug] [MainThread]: Flushing usage events
[0m05:29:15.939528 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m05:29:42.126574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78313280c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7831307a0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783130c56a30>]}


============================== 05:29:42.135462 | b3648da8-304d-40c6-b78b-e2e0079af6a0 ==============================
[0m05:29:42.135462 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:29:42.136737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:29:43.620856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3648da8-304d-40c6-b78b-e2e0079af6a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783130680700>]}
[0m05:29:43.761674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3648da8-304d-40c6-b78b-e2e0079af6a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783108515fd0>]}
[0m05:29:43.763596 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:29:43.812884 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:29:44.097927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:29:44.098619 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:29:44.206405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3648da8-304d-40c6-b78b-e2e0079af6a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78312cafa6d0>]}
[0m05:29:44.627065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3648da8-304d-40c6-b78b-e2e0079af6a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78312cb14460>]}
[0m05:29:44.627970 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m05:29:44.628764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3648da8-304d-40c6-b78b-e2e0079af6a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78312cb14c70>]}
[0m05:29:44.631094 [info ] [MainThread]: 
[0m05:29:44.632133 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:29:44.634318 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m05:29:44.662064 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m05:29:44.662848 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m05:29:44.663417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:29:45.360816 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.305 seconds
[0m05:29:45.366753 [debug] [ThreadPool]: On list_streaming_db: Close
[0m05:29:45.742615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m05:29:45.766299 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m05:29:45.767302 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m05:29:45.768018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:29:46.825918 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.058 seconds
[0m05:29:46.829888 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m05:29:47.185707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3648da8-304d-40c6-b78b-e2e0079af6a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78312cbbe1c0>]}
[0m05:29:47.187166 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:29:47.187947 [info ] [MainThread]: 
[0m05:29:47.205756 [debug] [Thread-1  ]: Began running node snapshot.crypto_transform.dim_symbol_snapshot
[0m05:29:47.207392 [info ] [Thread-1  ]: 1 of 1 START snapshot public.dim_symbol_snapshot ............................... [RUN]
[0m05:29:47.209311 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now snapshot.crypto_transform.dim_symbol_snapshot)
[0m05:29:47.210189 [debug] [Thread-1  ]: Began compiling node snapshot.crypto_transform.dim_symbol_snapshot
[0m05:29:47.230676 [debug] [Thread-1  ]: Began executing node snapshot.crypto_transform.dim_symbol_snapshot
[0m05:29:47.401659 [debug] [Thread-1  ]: Using snowflake connection "snapshot.crypto_transform.dim_symbol_snapshot"
[0m05:29:47.402728 [debug] [Thread-1  ]: On snapshot.crypto_transform.dim_symbol_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "snapshot.crypto_transform.dim_symbol_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "snapshot.crypto_transform.dim_symbol_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(ticker as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to
    from (
        



SELECT * FROM streaming_db.public.crypto_metadata

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m05:29:47.403469 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:29:48.957137 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.553 seconds
[0m05:29:48.965817 [debug] [Thread-1  ]: Using snowflake connection "snapshot.crypto_transform.dim_symbol_snapshot"
[0m05:29:48.966557 [debug] [Thread-1  ]: On snapshot.crypto_transform.dim_symbol_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "snapshot.crypto_transform.dim_symbol_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "snapshot.crypto_transform.dim_symbol_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:29:49.303321 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.336 seconds
[0m05:29:49.305601 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.crypto_transform.dim_symbol_snapshot"
[0m05:29:49.309980 [debug] [Thread-1  ]: Using snowflake connection "snapshot.crypto_transform.dim_symbol_snapshot"
[0m05:29:49.310822 [debug] [Thread-1  ]: On snapshot.crypto_transform.dim_symbol_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "snapshot.crypto_transform.dim_symbol_snapshot"} */
create or replace transient table streaming_db.public.dim_symbol_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(ticker as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to
    from (
        



SELECT * FROM streaming_db.public.crypto_metadata

    ) sbq



        );
[0m05:29:50.326013 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.014 seconds
[0m05:29:50.365474 [debug] [Thread-1  ]: On snapshot.crypto_transform.dim_symbol_snapshot: Close
[0m05:29:50.717559 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3648da8-304d-40c6-b78b-e2e0079af6a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78310a1adf10>]}
[0m05:29:50.720221 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public.dim_symbol_snapshot ............................... [[32mSUCCESS 1[0m in 3.51s]
[0m05:29:50.722599 [debug] [Thread-1  ]: Finished running node snapshot.crypto_transform.dim_symbol_snapshot
[0m05:29:50.726613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:29:50.727617 [debug] [MainThread]: Connection 'snapshot.crypto_transform.dim_symbol_snapshot' was properly closed.
[0m05:29:50.728663 [info ] [MainThread]: 
[0m05:29:50.729752 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.10 seconds (6.10s).
[0m05:29:50.731992 [debug] [MainThread]: Command end result
[0m05:29:50.803372 [info ] [MainThread]: 
[0m05:29:50.805166 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:29:50.806954 [info ] [MainThread]: 
[0m05:29:50.809724 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:29:50.813375 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 10.385703, "process_user_time": 5.81807, "process_kernel_time": 1.946071, "process_mem_max_rss": "204456", "process_out_blocks": "1896", "process_in_blocks": "0"}
[0m05:29:50.815154 [debug] [MainThread]: Command `dbt snapshot` succeeded at 05:29:50.814927 after 10.39 seconds
[0m05:29:50.815995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78313280c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783108537dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783108515fd0>]}
[0m05:29:50.816802 [debug] [MainThread]: Flushing usage events
[0m05:30:05.452433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a77afa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a55bb700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a55bbfa0>]}


============================== 05:30:05.462965 | 4485c2fd-edda-4d5e-b61b-a9a5056004d4 ==============================
[0m05:30:05.462965 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:30:05.464049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:30:07.182217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4485c2fd-edda-4d5e-b61b-a9a5056004d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff177ec4f70>]}
[0m05:30:07.293849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4485c2fd-edda-4d5e-b61b-a9a5056004d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff177ec4e80>]}
[0m05:30:07.295441 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:30:07.334467 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:30:07.679920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:30:07.680918 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:30:07.838383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4485c2fd-edda-4d5e-b61b-a9a5056004d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a1a863d0>]}
[0m05:30:08.277068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4485c2fd-edda-4d5e-b61b-a9a5056004d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a1a24fd0>]}
[0m05:30:08.278760 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m05:30:08.279745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4485c2fd-edda-4d5e-b61b-a9a5056004d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a1ab1940>]}
[0m05:30:08.283790 [info ] [MainThread]: 
[0m05:30:08.286455 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:30:08.297157 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m05:30:08.326176 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m05:30:08.327131 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m05:30:08.327972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:30:09.819865 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.492 seconds
[0m05:30:09.826555 [debug] [ThreadPool]: On list_streaming_db: Close
[0m05:30:10.253616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m05:30:10.284374 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m05:30:10.285334 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m05:30:10.286657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:30:12.030388 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.743 seconds
[0m05:30:12.034954 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m05:30:12.437868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4485c2fd-edda-4d5e-b61b-a9a5056004d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a52ce880>]}
[0m05:30:12.440053 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:30:12.441424 [info ] [MainThread]: 
[0m05:30:12.457905 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m05:30:12.459468 [info ] [Thread-1  ]: 1 of 4 START sql view model public.bronze_data ................................. [RUN]
[0m05:30:12.460990 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m05:30:12.462402 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m05:30:12.483776 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m05:30:12.485653 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m05:30:12.547530 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m05:30:12.550215 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m05:30:12.551170 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m05:30:12.552030 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:30:13.562385 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.010 seconds
[0m05:30:13.645197 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m05:30:14.062797 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4485c2fd-edda-4d5e-b61b-a9a5056004d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a57bd250>]}
[0m05:30:14.064889 [info ] [Thread-1  ]: 1 of 4 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.60s]
[0m05:30:14.066727 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m05:30:14.067954 [debug] [Thread-1  ]: Began running node model.crypto_transform.dim_symbol
[0m05:30:14.069385 [info ] [Thread-1  ]: 2 of 4 START sql table model public.dim_symbol ................................. [RUN]
[0m05:30:14.071243 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.dim_symbol)
[0m05:30:14.072204 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.dim_symbol
[0m05:30:14.078329 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.dim_symbol"
[0m05:30:14.079622 [debug] [Thread-1  ]: Began executing node model.crypto_transform.dim_symbol
[0m05:30:14.122389 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.dim_symbol"
[0m05:30:14.125002 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.dim_symbol"
[0m05:30:14.126296 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.dim_symbol"} */
create or replace transient table streaming_db.public.dim_symbol
         as
        (SELECT
    -- Generate a unique Surrogate Key (INT) for the Fact table to use
    -- We use md5 hash of ticker + valid_from to ensure uniqueness for every version
    MD5(ticker || dbt_valid_from) as symbol_key,
    
    ticker,
    sector,
    risk_level,
    
    -- SCD2 Metadata
    dbt_valid_from as valid_from,
    COALESCE(dbt_valid_to, '9999-12-31'::timestamp) as valid_to,
    
    CASE 
        WHEN dbt_valid_to IS NULL THEN TRUE 
        ELSE FALSE 
    END as is_current

FROM streaming_db.public.dim_symbol_snapshot
        );
[0m05:30:14.127530 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:30:15.781310 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.654 seconds
[0m05:30:15.787579 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: Close
[0m05:30:16.225427 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4485c2fd-edda-4d5e-b61b-a9a5056004d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a13b61f0>]}
[0m05:30:16.227844 [info ] [Thread-1  ]: 2 of 4 OK created sql table model public.dim_symbol ............................ [[32mSUCCESS 1[0m in 2.15s]
[0m05:30:16.229516 [debug] [Thread-1  ]: Finished running node model.crypto_transform.dim_symbol
[0m05:30:16.230950 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m05:30:16.232588 [info ] [Thread-1  ]: 3 of 4 START sql incremental model public.silver_transformations ............... [RUN]
[0m05:30:16.234335 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.dim_symbol, now model.crypto_transform.silver_transformations)
[0m05:30:16.235782 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m05:30:16.253938 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m05:30:16.255261 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m05:30:16.319849 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:30:16.321137 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace  temporary view streaming_db.public.silver_transformations__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
        -- INCREMENTAL LOGIC (The most important part):
        -- "Only give me rows that are NEWER than the max time currently in this table"
        AND Trade_Time > (SELECT MAX(Trade_Time) FROM streaming_db.public.silver_transformations)
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
  );
[0m05:30:16.322146 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:30:17.707449 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.385 seconds
[0m05:30:17.730163 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:30:17.731300 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations__dbt_tmp
[0m05:30:17.982687 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.250 seconds
[0m05:30:17.996760 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:30:17.998350 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations
[0m05:30:18.229850 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.230 seconds
[0m05:30:18.247996 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:30:18.248965 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table "STREAMING_DB"."PUBLIC"."SILVER_TRANSFORMATIONS"
[0m05:30:18.506135 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.256 seconds
[0m05:30:18.579156 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.silver_transformations"
[0m05:30:18.583344 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:30:18.584493 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
-- back compat for old kwarg name
  
  begin;
[0m05:30:18.863201 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.277 seconds
[0m05:30:18.865095 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:30:18.866563 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
merge into streaming_db.public.silver_transformations as DBT_INTERNAL_DEST
        using streaming_db.public.silver_transformations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.trade_id = DBT_INTERNAL_DEST.trade_id
            )

    
    when matched then update set
        "TICKER" = DBT_INTERNAL_SOURCE."TICKER","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TRADE_VALUE_USD" = DBT_INTERNAL_SOURCE."TRADE_VALUE_USD","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID","TRADE_CATEGORY" = DBT_INTERNAL_SOURCE."TRADE_CATEGORY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")
    values
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")

;
[0m05:30:21.030506 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 2.162 seconds
[0m05:30:21.032453 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:30:21.033465 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
COMMIT
[0m05:30:21.362656 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.328 seconds
[0m05:30:21.380407 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.silver_transformations__dbt_tmp
[0m05:30:21.392233 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:30:21.393119 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
drop view if exists streaming_db.public.silver_transformations__dbt_tmp cascade
[0m05:30:21.657828 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.263 seconds
[0m05:30:21.664621 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m05:30:22.085050 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4485c2fd-edda-4d5e-b61b-a9a5056004d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a13b6fd0>]}
[0m05:30:22.087177 [info ] [Thread-1  ]: 3 of 4 OK created sql incremental model public.silver_transformations .......... [[32mSUCCESS 0[0m in 5.85s]
[0m05:30:22.088733 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m05:30:22.091421 [debug] [Thread-1  ]: Began running node model.crypto_transform.fact_trades
[0m05:30:22.092733 [info ] [Thread-1  ]: 4 of 4 START sql incremental model public.fact_trades .......................... [RUN]
[0m05:30:22.093961 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.silver_transformations, now model.crypto_transform.fact_trades)
[0m05:30:22.094971 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.fact_trades
[0m05:30:22.103588 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.fact_trades"
[0m05:30:22.105281 [debug] [Thread-1  ]: Began executing node model.crypto_transform.fact_trades
[0m05:30:22.115894 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.fact_trades"
[0m05:30:22.119307 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m05:30:22.120231 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
create or replace transient table streaming_db.public.fact_trades
         as
        (

SELECT
    -- Create a deterministic unique ID for the Fact
    MD5(s.trade_id || s.trade_time) as fact_id,
    
    -- Foreign Key to the Dimension (SCD2 Link)
    d.symbol_key,
    
    -- Fact Measures
    s.trade_time,
    s.price,
    s.quantity,
    (s.price * s.quantity) as total_amount_usd,
    
    -- Degenerate Dimensions (IDs usually left in Fact)
    s.trade_id,
    s.buyer_order_id,
    s.seller_order_id

FROM streaming_db.public.silver_transformations s
-- JOIN Logic for SCD Type 2:
-- Match Ticker AND ensure Trade Time falls between the Dimension's validity window
LEFT JOIN streaming_db.public.dim_symbol d 
    ON s.ticker = d.ticker 
    AND s.trade_time >= d.valid_from 
    AND s.trade_time < d.valid_to


        );
[0m05:30:22.121163 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:30:24.909419 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.788 seconds
[0m05:30:24.918044 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.fact_trades__dbt_tmp
[0m05:30:24.920352 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m05:30:24.921558 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
drop view if exists streaming_db.public.fact_trades__dbt_tmp cascade
[0m05:30:25.148938 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.226 seconds
[0m05:30:25.155002 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: Close
[0m05:30:25.552871 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4485c2fd-edda-4d5e-b61b-a9a5056004d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a13b6fd0>]}
[0m05:30:25.554822 [info ] [Thread-1  ]: 4 of 4 OK created sql incremental model public.fact_trades ..................... [[32mSUCCESS 1[0m in 3.46s]
[0m05:30:25.556377 [debug] [Thread-1  ]: Finished running node model.crypto_transform.fact_trades
[0m05:30:25.560078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:30:25.561155 [debug] [MainThread]: Connection 'model.crypto_transform.fact_trades' was properly closed.
[0m05:30:25.562349 [info ] [MainThread]: 
[0m05:30:25.563182 [info ] [MainThread]: Finished running 1 view model, 1 table model, 2 incremental models in 0 hours 0 minutes and 17.28 seconds (17.28s).
[0m05:30:25.565604 [debug] [MainThread]: Command end result
[0m05:30:25.633573 [info ] [MainThread]: 
[0m05:30:25.634816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:30:25.635771 [info ] [MainThread]: 
[0m05:30:25.636669 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:30:25.638790 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.296272, "process_user_time": 6.660395, "process_kernel_time": 1.872294, "process_mem_max_rss": "204912", "process_out_blocks": "1984", "process_in_blocks": "0"}
[0m05:30:25.639979 [debug] [MainThread]: Command `dbt run` succeeded at 05:30:25.639800 after 20.30 seconds
[0m05:30:25.640845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a77afa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a63d69d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff177ec4e80>]}
[0m05:30:25.641713 [debug] [MainThread]: Flushing usage events
[0m05:30:32.617150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe059cf6370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe057b923a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe057b155e0>]}


============================== 05:30:32.625122 | fb675822-ba1d-4773-8b37-d9e1657ccc05 ==============================
[0m05:30:32.625122 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:30:32.626353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:30:32.047430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb675822-ba1d-4773-8b37-d9e1657ccc05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe030a53be0>]}
[0m05:30:32.135145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb675822-ba1d-4773-8b37-d9e1657ccc05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe057b9d3a0>]}
[0m05:30:32.136542 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:30:32.172872 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:30:32.461614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:30:32.462375 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:30:32.580859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb675822-ba1d-4773-8b37-d9e1657ccc05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe053fa2730>]}
[0m05:30:33.039560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb675822-ba1d-4773-8b37-d9e1657ccc05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe057b0bee0>]}
[0m05:30:33.040854 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m05:30:33.041636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb675822-ba1d-4773-8b37-d9e1657ccc05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe053fccaf0>]}
[0m05:30:33.043759 [info ] [MainThread]: 
[0m05:30:33.044571 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m05:30:33.047407 [debug] [MainThread]: Command end result
[0m05:30:33.094060 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.5151832, "process_user_time": 4.894489, "process_kernel_time": 1.743636, "process_mem_max_rss": "192608", "process_out_blocks": "1848", "process_in_blocks": "0"}
[0m05:30:33.095203 [debug] [MainThread]: Command `dbt test` succeeded at 05:30:33.095039 after 2.52 seconds
[0m05:30:33.095959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe059cf6370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe05994f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe053fccbb0>]}
[0m05:30:33.096633 [debug] [MainThread]: Flushing usage events
[0m05:31:15.999449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766b7ea364c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766b7c89cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766b7c85e670>]}


============================== 05:31:16.008441 | afb70c03-5212-4edc-a951-ef174142e4e1 ==============================
[0m05:31:16.008441 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:31:16.010103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:31:17.748078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afb70c03-5212-4edc-a951-ef174142e4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766b547d5b50>]}
[0m05:31:17.875429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afb70c03-5212-4edc-a951-ef174142e4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766b547a8760>]}
[0m05:31:17.877831 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:31:17.918580 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:31:18.220313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:31:18.221263 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:31:18.339382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afb70c03-5212-4edc-a951-ef174142e4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766b78ce36d0>]}
[0m05:31:18.713138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afb70c03-5212-4edc-a951-ef174142e4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766b78cbfd60>]}
[0m05:31:18.714552 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m05:31:18.715367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afb70c03-5212-4edc-a951-ef174142e4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766b78cfb910>]}
[0m05:31:18.718425 [info ] [MainThread]: 
[0m05:31:18.719598 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:31:18.729944 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m05:31:18.760182 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m05:31:18.761578 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m05:31:18.762274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:31:20.184951 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.422 seconds
[0m05:31:20.192210 [debug] [ThreadPool]: On list_streaming_db: Close
[0m05:31:20.569933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m05:31:20.589694 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m05:31:20.590414 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m05:31:20.591105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:31:22.119517 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.528 seconds
[0m05:31:22.125315 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m05:31:22.855572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afb70c03-5212-4edc-a951-ef174142e4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766b7ca6f820>]}
[0m05:31:22.857747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:31:22.858739 [info ] [MainThread]: 
[0m05:31:22.874087 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m05:31:22.875472 [info ] [Thread-1  ]: 1 of 4 START sql view model public.bronze_data ................................. [RUN]
[0m05:31:22.876724 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m05:31:22.877889 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m05:31:22.897687 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m05:31:22.899227 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m05:31:22.988223 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m05:31:22.991194 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m05:31:22.992052 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m05:31:22.993134 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:31:24.266161 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.273 seconds
[0m05:31:24.312159 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m05:31:24.709750 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb70c03-5212-4edc-a951-ef174142e4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766b55851070>]}
[0m05:31:24.713110 [info ] [Thread-1  ]: 1 of 4 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.83s]
[0m05:31:24.717186 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m05:31:24.719100 [debug] [Thread-1  ]: Began running node model.crypto_transform.dim_symbol
[0m05:31:24.721843 [info ] [Thread-1  ]: 2 of 4 START sql table model public.dim_symbol ................................. [RUN]
[0m05:31:24.723953 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.dim_symbol)
[0m05:31:24.725506 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.dim_symbol
[0m05:31:24.739745 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.dim_symbol"
[0m05:31:24.742140 [debug] [Thread-1  ]: Began executing node model.crypto_transform.dim_symbol
[0m05:31:24.815022 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.dim_symbol"
[0m05:31:24.817797 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.dim_symbol"
[0m05:31:24.818898 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.dim_symbol"} */
create or replace transient table streaming_db.public.dim_symbol
         as
        (SELECT
    -- Generate a unique Surrogate Key (INT) for the Fact table to use
    -- We use md5 hash of ticker + valid_from to ensure uniqueness for every version
    MD5(ticker || dbt_valid_from) as symbol_key,
    
    ticker,
    sector,
    risk_level,
    
    -- SCD2 Metadata
    dbt_valid_from as valid_from,
    COALESCE(dbt_valid_to, '9999-12-31'::timestamp) as valid_to,
    
    CASE 
        WHEN dbt_valid_to IS NULL THEN TRUE 
        ELSE FALSE 
    END as is_current

FROM streaming_db.public.dim_symbol_snapshot
        );
[0m05:31:24.819715 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:31:26.181209 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.361 seconds
[0m05:31:26.190752 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: Close
[0m05:31:26.578843 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb70c03-5212-4edc-a951-ef174142e4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766b78833af0>]}
[0m05:31:26.581034 [info ] [Thread-1  ]: 2 of 4 OK created sql table model public.dim_symbol ............................ [[32mSUCCESS 1[0m in 1.85s]
[0m05:31:26.582744 [debug] [Thread-1  ]: Finished running node model.crypto_transform.dim_symbol
[0m05:31:26.583937 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m05:31:26.585362 [info ] [Thread-1  ]: 3 of 4 START sql incremental model public.silver_transformations ............... [RUN]
[0m05:31:26.586566 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.dim_symbol, now model.crypto_transform.silver_transformations)
[0m05:31:26.587713 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m05:31:26.607331 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m05:31:26.610043 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m05:31:26.682749 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:31:26.684911 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace  temporary view streaming_db.public.silver_transformations__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
        -- INCREMENTAL LOGIC (The most important part):
        -- "Only give me rows that are NEWER than the max time currently in this table"
        AND Trade_Time > (SELECT MAX(Trade_Time) FROM streaming_db.public.silver_transformations)
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
  );
[0m05:31:26.686688 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:31:28.568854 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.882 seconds
[0m05:31:28.586052 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:31:28.586949 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations__dbt_tmp
[0m05:31:28.804409 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.216 seconds
[0m05:31:28.814188 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:31:28.814986 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations
[0m05:31:29.021566 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.206 seconds
[0m05:31:29.036755 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:31:29.037622 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table "STREAMING_DB"."PUBLIC"."SILVER_TRANSFORMATIONS"
[0m05:31:29.303505 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.265 seconds
[0m05:31:29.360226 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.silver_transformations"
[0m05:31:29.363666 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:31:29.364674 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
-- back compat for old kwarg name
  
  begin;
[0m05:31:29.624416 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.259 seconds
[0m05:31:29.626134 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:31:29.627161 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
merge into streaming_db.public.silver_transformations as DBT_INTERNAL_DEST
        using streaming_db.public.silver_transformations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.trade_id = DBT_INTERNAL_DEST.trade_id
            )

    
    when matched then update set
        "TICKER" = DBT_INTERNAL_SOURCE."TICKER","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TRADE_VALUE_USD" = DBT_INTERNAL_SOURCE."TRADE_VALUE_USD","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID","TRADE_CATEGORY" = DBT_INTERNAL_SOURCE."TRADE_CATEGORY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")
    values
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")

;
[0m05:31:28.631750 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.155 seconds
[0m05:31:28.633306 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:31:28.634256 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
COMMIT
[0m05:31:29.020388 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.385 seconds
[0m05:31:29.038317 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.silver_transformations__dbt_tmp
[0m05:31:29.050059 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m05:31:29.050884 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
drop view if exists streaming_db.public.silver_transformations__dbt_tmp cascade
[0m05:31:29.281955 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.230 seconds
[0m05:31:29.289463 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m05:31:29.658483 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb70c03-5212-4edc-a951-ef174142e4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766b78833af0>]}
[0m05:31:29.660566 [info ] [Thread-1  ]: 3 of 4 OK created sql incremental model public.silver_transformations .......... [[32mSUCCESS 0[0m in 3.07s]
[0m05:31:29.662274 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m05:31:29.664834 [debug] [Thread-1  ]: Began running node model.crypto_transform.fact_trades
[0m05:31:29.665992 [info ] [Thread-1  ]: 4 of 4 START sql incremental model public.fact_trades .......................... [RUN]
[0m05:31:29.667214 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.silver_transformations, now model.crypto_transform.fact_trades)
[0m05:31:29.667966 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.fact_trades
[0m05:31:29.675576 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.fact_trades"
[0m05:31:29.676943 [debug] [Thread-1  ]: Began executing node model.crypto_transform.fact_trades
[0m05:31:29.684518 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m05:31:29.685484 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
create or replace  temporary view streaming_db.public.fact_trades__dbt_tmp
  
   as (
    

SELECT
    -- Create a deterministic unique ID for the Fact
    MD5(s.trade_id || s.trade_time) as fact_id,
    
    -- Foreign Key to the Dimension (SCD2 Link)
    d.symbol_key,
    
    -- Fact Measures
    s.trade_time,
    s.price,
    s.quantity,
    (s.price * s.quantity) as total_amount_usd,
    
    -- Degenerate Dimensions (IDs usually left in Fact)
    s.trade_id,
    s.buyer_order_id,
    s.seller_order_id

FROM streaming_db.public.silver_transformations s
-- JOIN Logic for SCD Type 2:
-- Match Ticker AND ensure Trade Time falls between the Dimension's validity window
LEFT JOIN streaming_db.public.dim_symbol d 
    ON s.ticker = d.ticker 
    AND s.trade_time >= d.valid_from 
    AND s.trade_time < d.valid_to


WHERE s.trade_time > (SELECT MAX(trade_time) FROM streaming_db.public.fact_trades)

  );
[0m05:31:29.686399 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:31:31.045356 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.359 seconds
[0m05:31:31.053558 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m05:31:31.054785 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table streaming_db.public.fact_trades__dbt_tmp
[0m05:31:31.294696 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.239 seconds
[0m05:31:31.304141 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m05:31:31.304959 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table streaming_db.public.fact_trades
[0m05:31:31.543270 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.237 seconds
[0m05:31:31.555642 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m05:31:31.556593 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table "STREAMING_DB"."PUBLIC"."FACT_TRADES"
[0m05:31:31.800415 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.243 seconds
[0m05:31:31.811086 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.fact_trades"
[0m05:31:31.813744 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m05:31:31.814432 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
-- back compat for old kwarg name
  
  begin;
[0m05:31:32.082381 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.267 seconds
[0m05:31:32.084569 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m05:31:32.085656 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
merge into streaming_db.public.fact_trades as DBT_INTERNAL_DEST
        using streaming_db.public.fact_trades__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.fact_id = DBT_INTERNAL_DEST.fact_id
            )

    
    when matched then update set
        "FACT_ID" = DBT_INTERNAL_SOURCE."FACT_ID","SYMBOL_KEY" = DBT_INTERNAL_SOURCE."SYMBOL_KEY","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TOTAL_AMOUNT_USD" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT_USD","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID"
    

    when not matched then insert
        ("FACT_ID", "SYMBOL_KEY", "TRADE_TIME", "PRICE", "QUANTITY", "TOTAL_AMOUNT_USD", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID")
    values
        ("FACT_ID", "SYMBOL_KEY", "TRADE_TIME", "PRICE", "QUANTITY", "TOTAL_AMOUNT_USD", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID")

;
[0m05:31:32.850071 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.763 seconds
[0m05:31:32.852176 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m05:31:32.853415 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
COMMIT
[0m05:31:33.217088 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.362 seconds
[0m05:31:33.224960 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.fact_trades__dbt_tmp
[0m05:31:33.227031 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m05:31:33.227972 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
drop view if exists streaming_db.public.fact_trades__dbt_tmp cascade
[0m05:31:33.480223 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.251 seconds
[0m05:31:33.485655 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: Close
[0m05:31:33.948626 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb70c03-5212-4edc-a951-ef174142e4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766b787f1f10>]}
[0m05:31:33.950956 [info ] [Thread-1  ]: 4 of 4 OK created sql incremental model public.fact_trades ..................... [[32mSUCCESS 0[0m in 4.28s]
[0m05:31:33.953066 [debug] [Thread-1  ]: Finished running node model.crypto_transform.fact_trades
[0m05:31:33.956250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:31:33.956883 [debug] [MainThread]: Connection 'model.crypto_transform.fact_trades' was properly closed.
[0m05:31:33.958079 [info ] [MainThread]: 
[0m05:31:33.958941 [info ] [MainThread]: Finished running 1 view model, 1 table model, 2 incremental models in 0 hours 0 minutes and 15.24 seconds (15.24s).
[0m05:31:33.961827 [debug] [MainThread]: Command end result
[0m05:31:34.044660 [info ] [MainThread]: 
[0m05:31:34.047863 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:31:34.049377 [info ] [MainThread]: 
[0m05:31:34.050833 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:31:34.055017 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.306755, "process_user_time": 6.540044, "process_kernel_time": 1.867504, "process_mem_max_rss": "205712", "process_out_blocks": "2000", "process_in_blocks": "0"}
[0m05:31:34.056657 [debug] [MainThread]: Command `dbt run` succeeded at 05:31:34.056428 after 20.31 seconds
[0m05:31:34.058213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766b7ea364c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766b78cbfd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766b547a8760>]}
[0m05:31:34.059561 [debug] [MainThread]: Flushing usage events
[0m05:31:46.379304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c93cd93190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c93adb7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c93ba249d0>]}


============================== 05:31:46.388467 | 717afa48-46d4-4164-8115-929d1139583e ==============================
[0m05:31:46.388467 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:31:46.389715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:31:47.936602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '717afa48-46d4-4164-8115-929d1139583e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c93ac08250>]}
[0m05:31:48.027518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '717afa48-46d4-4164-8115-929d1139583e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c9140491c0>]}
[0m05:31:48.029093 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:31:48.064286 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:31:48.349086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:31:48.350001 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:31:48.472869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '717afa48-46d4-4164-8115-929d1139583e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c9370446d0>]}
[0m05:31:48.870359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '717afa48-46d4-4164-8115-929d1139583e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c93abf7b20>]}
[0m05:31:48.871613 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m05:31:48.872644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '717afa48-46d4-4164-8115-929d1139583e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c93abf7940>]}
[0m05:31:48.875297 [info ] [MainThread]: 
[0m05:31:48.876071 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m05:31:48.879901 [debug] [MainThread]: Command end result
[0m05:31:48.956224 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.6629994, "process_user_time": 5.174642, "process_kernel_time": 1.495443, "process_mem_max_rss": "192696", "process_out_blocks": "1864", "process_in_blocks": "0"}
[0m05:31:48.957629 [debug] [MainThread]: Command `dbt test` succeeded at 05:31:48.957403 after 2.66 seconds
[0m05:31:48.958462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c93cd93190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c93abc9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c9140491c0>]}
[0m05:31:48.959183 [debug] [MainThread]: Flushing usage events
[0m15:56:03.638814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c61a64130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c5feedac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c5f9f8520>]}
[0m15:56:03.638893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75297e37aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75297c2e34f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75297c371460>]}


============================== 15:56:03.647803 | bad6ab3b-19f0-4736-9dcd-8b17e95d3f67 ==============================
[0m15:56:03.647803 [info ] [MainThread]: Running with dbt=1.8.7


============================== 15:56:03.647803 | d4a43553-ea1f-4bf3-a3ce-2018a13a0525 ==============================
[0m15:56:03.647803 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:56:03.648597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:56:03.648601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:56:04.903242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bad6ab3b-19f0-4736-9dcd-8b17e95d3f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c5f7bd5e0>]}
[0m15:56:04.903250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4a43553-ea1f-4bf3-a3ce-2018a13a0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75295511b610>]}
[0m15:56:04.966224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4a43553-ea1f-4bf3-a3ce-2018a13a0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7529550a2ee0>]}
[0m15:56:04.967607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bad6ab3b-19f0-4736-9dcd-8b17e95d3f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c31117a60>]}
[0m15:56:04.967941 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:56:04.968773 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:56:04.995432 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:56:04.995510 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:56:05.283232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:56:05.283243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:56:05.283968 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/gold/gold_consumption_view.sql
[0m15:56:05.284008 [debug] [MainThread]: Partial parsing: added file: crypto_transform://models/gold/gold_consumption_view.sql
[0m15:56:05.702214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bad6ab3b-19f0-4736-9dcd-8b17e95d3f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c5f8d9850>]}
[0m15:56:05.704914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4a43553-ea1f-4bf3-a3ce-2018a13a0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75297858c970>]}
[0m15:56:05.858859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4a43553-ea1f-4bf3-a3ce-2018a13a0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75297790d370>]}
[0m15:56:05.858858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bad6ab3b-19f0-4736-9dcd-8b17e95d3f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c5b02b3d0>]}
[0m15:56:05.859549 [info ] [MainThread]: Found 5 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m15:56:05.859545 [info ] [MainThread]: Found 5 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m15:56:05.860008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bad6ab3b-19f0-4736-9dcd-8b17e95d3f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c5beaddc0>]}
[0m15:56:05.860032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4a43553-ea1f-4bf3-a3ce-2018a13a0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752978796fa0>]}
[0m15:56:05.861832 [info ] [MainThread]: 
[0m15:56:05.861839 [info ] [MainThread]: 
[0m15:56:05.862636 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:56:05.862627 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:56:05.868580 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m15:56:05.868667 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m15:56:05.884622 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m15:56:05.884706 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m15:56:05.885188 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m15:56:05.885241 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m15:56:05.885632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:05.885650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:08.417876 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.532 seconds
[0m15:56:08.420842 [debug] [ThreadPool]: On list_streaming_db: Close
[0m15:56:08.422929 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.537 seconds
[0m15:56:08.425819 [debug] [ThreadPool]: On list_streaming_db: Close
[0m15:56:08.855145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m15:56:08.867322 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m15:56:08.867796 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m15:56:08.868179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:08.882491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m15:56:08.894980 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m15:56:08.895488 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m15:56:08.895892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:09.846614 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.978 seconds
[0m15:56:09.849384 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m15:56:10.064841 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.169 seconds
[0m15:56:10.068089 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m15:56:10.301921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bad6ab3b-19f0-4736-9dcd-8b17e95d3f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c38888e50>]}
[0m15:56:10.302973 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:56:10.303546 [info ] [MainThread]: 
[0m15:56:10.313287 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m15:56:10.313959 [info ] [Thread-1  ]: 1 of 5 START sql view model public.bronze_data ................................. [RUN]
[0m15:56:10.314557 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m15:56:10.314990 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m15:56:10.324381 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m15:56:10.325291 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m15:56:10.353799 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m15:56:10.355114 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m15:56:10.355588 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m15:56:10.356046 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:56:10.534409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4a43553-ea1f-4bf3-a3ce-2018a13a0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752955163dc0>]}
[0m15:56:10.536085 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:56:10.536725 [info ] [MainThread]: 
[0m15:56:10.546857 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m15:56:10.547541 [info ] [Thread-1  ]: 1 of 5 START sql view model public.bronze_data ................................. [RUN]
[0m15:56:10.548171 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m15:56:10.548728 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m15:56:10.558900 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m15:56:10.559658 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m15:56:10.588663 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m15:56:10.590007 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m15:56:10.590501 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m15:56:10.590997 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:56:11.375000 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.019 seconds
[0m15:56:11.402914 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m15:56:11.795790 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bad6ab3b-19f0-4736-9dcd-8b17e95d3f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c3941ff40>]}
[0m15:56:11.796780 [info ] [Thread-1  ]: 1 of 5 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.48s]
[0m15:56:11.797827 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m15:56:11.798408 [debug] [Thread-1  ]: Began running node model.crypto_transform.dim_symbol
[0m15:56:11.799239 [info ] [Thread-1  ]: 2 of 5 START sql table model public.dim_symbol ................................. [RUN]
[0m15:56:11.800304 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.dim_symbol)
[0m15:56:11.800828 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.dim_symbol
[0m15:56:11.804367 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.dim_symbol"
[0m15:56:11.805683 [debug] [Thread-1  ]: Began executing node model.crypto_transform.dim_symbol
[0m15:56:11.828400 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.dim_symbol"
[0m15:56:11.829685 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.dim_symbol"
[0m15:56:11.830188 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.dim_symbol"} */
create or replace transient table streaming_db.public.dim_symbol
         as
        (SELECT
    -- Generate a unique Surrogate Key (INT) for the Fact table to use
    -- We use md5 hash of ticker + valid_from to ensure uniqueness for every version
    MD5(ticker || dbt_valid_from) as symbol_key,
    
    ticker,
    sector,
    risk_level,
    
    -- SCD2 Metadata
    dbt_valid_from as valid_from,
    COALESCE(dbt_valid_to, '9999-12-31'::timestamp) as valid_to,
    
    CASE 
        WHEN dbt_valid_to IS NULL THEN TRUE 
        ELSE FALSE 
    END as is_current

FROM streaming_db.public.dim_symbol_snapshot
        );
[0m15:56:11.830635 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:56:11.932772 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.342 seconds
[0m15:56:11.964118 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m15:56:12.410923 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4a43553-ea1f-4bf3-a3ce-2018a13a0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752955cfbee0>]}
[0m15:56:12.411959 [info ] [Thread-1  ]: 1 of 5 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.86s]
[0m15:56:12.412826 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m15:56:12.413566 [debug] [Thread-1  ]: Began running node model.crypto_transform.dim_symbol
[0m15:56:12.414368 [info ] [Thread-1  ]: 2 of 5 START sql table model public.dim_symbol ................................. [RUN]
[0m15:56:12.415417 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.dim_symbol)
[0m15:56:12.416073 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.dim_symbol
[0m15:56:12.419908 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.dim_symbol"
[0m15:56:12.420664 [debug] [Thread-1  ]: Began executing node model.crypto_transform.dim_symbol
[0m15:56:12.443094 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.dim_symbol"
[0m15:56:12.444240 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.dim_symbol"
[0m15:56:12.444763 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.dim_symbol"} */
create or replace transient table streaming_db.public.dim_symbol
         as
        (SELECT
    -- Generate a unique Surrogate Key (INT) for the Fact table to use
    -- We use md5 hash of ticker + valid_from to ensure uniqueness for every version
    MD5(ticker || dbt_valid_from) as symbol_key,
    
    ticker,
    sector,
    risk_level,
    
    -- SCD2 Metadata
    dbt_valid_from as valid_from,
    COALESCE(dbt_valid_to, '9999-12-31'::timestamp) as valid_to,
    
    CASE 
        WHEN dbt_valid_to IS NULL THEN TRUE 
        ELSE FALSE 
    END as is_current

FROM streaming_db.public.dim_symbol_snapshot
        );
[0m15:56:12.445334 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:56:13.765405 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.874 seconds
[0m15:56:13.768723 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: Close
[0m15:56:13.796447 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.290 seconds
[0m15:56:13.799660 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: Close
[0m15:56:14.176251 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bad6ab3b-19f0-4736-9dcd-8b17e95d3f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c61a78f10>]}
[0m15:56:14.177482 [info ] [Thread-1  ]: 2 of 5 OK created sql table model public.dim_symbol ............................ [[32mSUCCESS 1[0m in 2.38s]
[0m15:56:14.178612 [debug] [Thread-1  ]: Finished running node model.crypto_transform.dim_symbol
[0m15:56:14.179292 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m15:56:14.180223 [info ] [Thread-1  ]: 3 of 5 START sql incremental model public.silver_transformations ............... [RUN]
[0m15:56:14.180886 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.dim_symbol, now model.crypto_transform.silver_transformations)
[0m15:56:14.181430 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m15:56:14.187209 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4a43553-ea1f-4bf3-a3ce-2018a13a0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75297790d6a0>]}
[0m15:56:14.188255 [info ] [Thread-1  ]: 2 of 5 OK created sql table model public.dim_symbol ............................ [[32mSUCCESS 1[0m in 1.77s]
[0m15:56:14.189045 [debug] [Thread-1  ]: Finished running node model.crypto_transform.dim_symbol
[0m15:56:14.189661 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m15:56:14.190495 [info ] [Thread-1  ]: 3 of 5 START sql incremental model public.silver_transformations ............... [RUN]
[0m15:56:14.191138 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.dim_symbol, now model.crypto_transform.silver_transformations)
[0m15:56:14.191609 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m15:56:14.192829 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m15:56:14.193756 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m15:56:14.201806 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m15:56:14.202713 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m15:56:14.229852 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:56:14.230599 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace  temporary view streaming_db.public.silver_transformations__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
        -- INCREMENTAL LOGIC (The most important part):
        -- "Only give me rows that are NEWER than the max time currently in this table"
        AND Trade_Time > (SELECT MAX(Trade_Time) FROM streaming_db.public.silver_transformations)
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
  );
[0m15:56:14.231114 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:56:14.242594 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:56:14.243377 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace  temporary view streaming_db.public.silver_transformations__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
        -- INCREMENTAL LOGIC (The most important part):
        -- "Only give me rows that are NEWER than the max time currently in this table"
        AND Trade_Time > (SELECT MAX(Trade_Time) FROM streaming_db.public.silver_transformations)
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
  );
[0m15:56:14.243994 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:56:15.610643 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.367 seconds
[0m15:56:15.622492 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:56:15.623085 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations__dbt_tmp
[0m15:56:15.645393 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.414 seconds
[0m15:56:15.656009 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:56:15.656548 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations__dbt_tmp
[0m15:56:15.878764 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.255 seconds
[0m15:56:15.883537 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.226 seconds
[0m15:56:15.884320 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:56:15.884946 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations
[0m15:56:15.889195 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:56:15.889747 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations
[0m15:56:16.107181 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.222 seconds
[0m15:56:16.107447 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.217 seconds
[0m15:56:16.118336 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:56:16.118370 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:56:16.118991 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table "STREAMING_DB"."PUBLIC"."SILVER_TRANSFORMATIONS"
[0m15:56:16.119008 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table "STREAMING_DB"."PUBLIC"."SILVER_TRANSFORMATIONS"
[0m15:56:16.395027 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.275 seconds
[0m15:56:16.419043 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.300 seconds
[0m15:56:16.428013 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.silver_transformations"
[0m15:56:16.429784 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:56:16.430351 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
-- back compat for old kwarg name
  
  begin;
[0m15:56:16.451349 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.silver_transformations"
[0m15:56:16.453100 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:56:16.453935 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
-- back compat for old kwarg name
  
  begin;
[0m15:56:16.701985 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.271 seconds
[0m15:56:16.703030 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:56:16.703710 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
merge into streaming_db.public.silver_transformations as DBT_INTERNAL_DEST
        using streaming_db.public.silver_transformations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.trade_id = DBT_INTERNAL_DEST.trade_id
            )

    
    when matched then update set
        "TICKER" = DBT_INTERNAL_SOURCE."TICKER","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TRADE_VALUE_USD" = DBT_INTERNAL_SOURCE."TRADE_VALUE_USD","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID","TRADE_CATEGORY" = DBT_INTERNAL_SOURCE."TRADE_CATEGORY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")
    values
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")

;
[0m15:56:16.704867 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.250 seconds
[0m15:56:16.705654 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:56:16.706453 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
merge into streaming_db.public.silver_transformations as DBT_INTERNAL_DEST
        using streaming_db.public.silver_transformations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.trade_id = DBT_INTERNAL_DEST.trade_id
            )

    
    when matched then update set
        "TICKER" = DBT_INTERNAL_SOURCE."TICKER","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TRADE_VALUE_USD" = DBT_INTERNAL_SOURCE."TRADE_VALUE_USD","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID","TRADE_CATEGORY" = DBT_INTERNAL_SOURCE."TRADE_CATEGORY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")
    values
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")

;
[0m15:56:18.075805 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.369 seconds
[0m15:56:18.076848 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:56:18.077449 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
COMMIT
[0m15:56:18.438714 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.361 seconds
[0m15:56:18.449366 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.silver_transformations__dbt_tmp
[0m15:56:18.455853 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:56:18.456370 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
drop view if exists streaming_db.public.silver_transformations__dbt_tmp cascade
[0m15:56:18.731492 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.275 seconds
[0m15:56:18.734675 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m15:56:19.180846 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bad6ab3b-19f0-4736-9dcd-8b17e95d3f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c3941ff40>]}
[0m15:56:19.182014 [info ] [Thread-1  ]: 3 of 5 OK created sql incremental model public.silver_transformations .......... [[32mSUCCESS 0[0m in 5.00s]
[0m15:56:19.183024 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m15:56:19.184726 [debug] [Thread-1  ]: Began running node model.crypto_transform.fact_trades
[0m15:56:19.185373 [info ] [Thread-1  ]: 4 of 5 START sql incremental model public.fact_trades .......................... [RUN]
[0m15:56:19.186274 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.silver_transformations, now model.crypto_transform.fact_trades)
[0m15:56:19.186848 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.fact_trades
[0m15:56:19.192141 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.fact_trades"
[0m15:56:19.192946 [debug] [Thread-1  ]: Began executing node model.crypto_transform.fact_trades
[0m15:56:19.198136 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:56:19.198722 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
create or replace  temporary view streaming_db.public.fact_trades__dbt_tmp
  
   as (
    

SELECT
    -- Create a deterministic unique ID for the Fact
    MD5(s.trade_id || s.trade_time) as fact_id,
    
    -- Foreign Key to the Dimension (SCD2 Link)
    d.symbol_key,
    
    -- Fact Measures
    s.trade_time,
    s.price,
    s.quantity,
    (s.price * s.quantity) as total_amount_usd,
    
    -- Degenerate Dimensions (IDs usually left in Fact)
    s.trade_id,
    s.buyer_order_id,
    s.seller_order_id

FROM streaming_db.public.silver_transformations s
-- JOIN Logic for SCD Type 2:
-- Match Ticker AND ensure Trade Time falls between the Dimension's validity window
LEFT JOIN streaming_db.public.dim_symbol d 
    ON s.ticker = d.ticker 
    AND s.trade_time >= d.valid_from 
    AND s.trade_time < d.valid_to


WHERE s.trade_time > (SELECT MAX(trade_time) FROM streaming_db.public.fact_trades)

  );
[0m15:56:19.199205 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:56:19.936022 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 3.232 seconds
[0m15:56:19.937017 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:56:19.937678 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
COMMIT
[0m15:56:20.284969 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.347 seconds
[0m15:56:20.295854 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.silver_transformations__dbt_tmp
[0m15:56:20.302307 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:56:20.302805 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
drop view if exists streaming_db.public.silver_transformations__dbt_tmp cascade
[0m15:56:20.669102 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.366 seconds
[0m15:56:20.672490 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m15:56:20.742829 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.544 seconds
[0m15:56:20.747343 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:56:20.747911 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table streaming_db.public.fact_trades__dbt_tmp
[0m15:56:21.045423 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.297 seconds
[0m15:56:21.052698 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:56:21.053731 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table streaming_db.public.fact_trades
[0m15:56:21.079127 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4a43553-ea1f-4bf3-a3ce-2018a13a0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752970774fa0>]}
[0m15:56:21.080670 [info ] [Thread-1  ]: 3 of 5 OK created sql incremental model public.silver_transformations .......... [[32mSUCCESS 0[0m in 6.89s]
[0m15:56:21.082475 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m15:56:21.085012 [debug] [Thread-1  ]: Began running node model.crypto_transform.fact_trades
[0m15:56:21.085955 [info ] [Thread-1  ]: 4 of 5 START sql incremental model public.fact_trades .......................... [RUN]
[0m15:56:21.087162 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.silver_transformations, now model.crypto_transform.fact_trades)
[0m15:56:21.088117 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.fact_trades
[0m15:56:21.096663 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.fact_trades"
[0m15:56:21.098604 [debug] [Thread-1  ]: Began executing node model.crypto_transform.fact_trades
[0m15:56:21.111066 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:56:21.112227 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
create or replace  temporary view streaming_db.public.fact_trades__dbt_tmp
  
   as (
    

SELECT
    -- Create a deterministic unique ID for the Fact
    MD5(s.trade_id || s.trade_time) as fact_id,
    
    -- Foreign Key to the Dimension (SCD2 Link)
    d.symbol_key,
    
    -- Fact Measures
    s.trade_time,
    s.price,
    s.quantity,
    (s.price * s.quantity) as total_amount_usd,
    
    -- Degenerate Dimensions (IDs usually left in Fact)
    s.trade_id,
    s.buyer_order_id,
    s.seller_order_id

FROM streaming_db.public.silver_transformations s
-- JOIN Logic for SCD Type 2:
-- Match Ticker AND ensure Trade Time falls between the Dimension's validity window
LEFT JOIN streaming_db.public.dim_symbol d 
    ON s.ticker = d.ticker 
    AND s.trade_time >= d.valid_from 
    AND s.trade_time < d.valid_to


WHERE s.trade_time > (SELECT MAX(trade_time) FROM streaming_db.public.fact_trades)

  );
[0m15:56:21.113159 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:56:21.288653 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.234 seconds
[0m15:56:21.293942 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:56:21.294661 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table "STREAMING_DB"."PUBLIC"."FACT_TRADES"
[0m15:56:21.506349 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.211 seconds
[0m15:56:21.513340 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.fact_trades"
[0m15:56:21.515103 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:56:21.515686 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
-- back compat for old kwarg name
  
  begin;
[0m15:56:21.752766 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.236 seconds
[0m15:56:21.753623 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:56:21.754326 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
merge into streaming_db.public.fact_trades as DBT_INTERNAL_DEST
        using streaming_db.public.fact_trades__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.fact_id = DBT_INTERNAL_DEST.fact_id
            )

    
    when matched then update set
        "FACT_ID" = DBT_INTERNAL_SOURCE."FACT_ID","SYMBOL_KEY" = DBT_INTERNAL_SOURCE."SYMBOL_KEY","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TOTAL_AMOUNT_USD" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT_USD","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID"
    

    when not matched then insert
        ("FACT_ID", "SYMBOL_KEY", "TRADE_TIME", "PRICE", "QUANTITY", "TOTAL_AMOUNT_USD", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID")
    values
        ("FACT_ID", "SYMBOL_KEY", "TRADE_TIME", "PRICE", "QUANTITY", "TOTAL_AMOUNT_USD", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID")

;
[0m15:56:22.081946 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.969 seconds
[0m15:56:22.086327 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:56:22.086877 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table streaming_db.public.fact_trades__dbt_tmp
[0m15:56:22.313866 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.226 seconds
[0m15:56:22.319204 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:56:22.319767 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table streaming_db.public.fact_trades
[0m15:56:22.537365 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.217 seconds
[0m15:56:22.542693 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:56:22.543243 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table "STREAMING_DB"."PUBLIC"."FACT_TRADES"
[0m15:56:22.760897 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.217 seconds
[0m15:56:22.768048 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.fact_trades"
[0m15:56:22.769663 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:56:22.770155 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
-- back compat for old kwarg name
  
  begin;
[0m15:56:23.017205 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.246 seconds
[0m15:56:23.017989 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:56:23.018589 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
merge into streaming_db.public.fact_trades as DBT_INTERNAL_DEST
        using streaming_db.public.fact_trades__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.fact_id = DBT_INTERNAL_DEST.fact_id
            )

    
    when matched then update set
        "FACT_ID" = DBT_INTERNAL_SOURCE."FACT_ID","SYMBOL_KEY" = DBT_INTERNAL_SOURCE."SYMBOL_KEY","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TOTAL_AMOUNT_USD" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT_USD","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID"
    

    when not matched then insert
        ("FACT_ID", "SYMBOL_KEY", "TRADE_TIME", "PRICE", "QUANTITY", "TOTAL_AMOUNT_USD", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID")
    values
        ("FACT_ID", "SYMBOL_KEY", "TRADE_TIME", "PRICE", "QUANTITY", "TOTAL_AMOUNT_USD", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID")

;
[0m15:56:23.254843 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.500 seconds
[0m15:56:23.255721 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:56:23.256301 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
COMMIT
[0m15:56:33.979870 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 10.723 seconds
[0m15:56:33.984457 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.fact_trades__dbt_tmp
[0m15:56:33.985733 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:56:33.986317 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
drop view if exists streaming_db.public.fact_trades__dbt_tmp cascade
[0m15:56:34.329852 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.343 seconds
[0m15:56:34.333072 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: Close
[0m15:56:34.723242 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bad6ab3b-19f0-4736-9dcd-8b17e95d3f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c53df30d0>]}
[0m15:56:34.724371 [info ] [Thread-1  ]: 4 of 5 OK created sql incremental model public.fact_trades ..................... [[32mSUCCESS 0[0m in 15.54s]
[0m15:56:34.725458 [debug] [Thread-1  ]: Finished running node model.crypto_transform.fact_trades
[0m15:56:34.726652 [debug] [Thread-1  ]: Began running node model.crypto_transform.gold_consumption_view
[0m15:56:34.727866 [info ] [Thread-1  ]: 5 of 5 START sql view model public.gold_consumption_view ....................... [RUN]
[0m15:56:34.728630 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.fact_trades, now model.crypto_transform.gold_consumption_view)
[0m15:56:34.729180 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.gold_consumption_view
[0m15:56:34.733682 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.gold_consumption_view"
[0m15:56:34.734540 [debug] [Thread-1  ]: Began executing node model.crypto_transform.gold_consumption_view
[0m15:56:34.738969 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.gold_consumption_view"
[0m15:56:34.740052 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.gold_consumption_view"
[0m15:56:34.740547 [debug] [Thread-1  ]: On model.crypto_transform.gold_consumption_view: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.gold_consumption_view"} */
create or replace   view streaming_db.public.gold_consumption_view
  
   as (
    

SELECT
    -- 1. Fact Data (Measures)
    f.trade_time,
    f.ticker,
    f.price,
    f.quantity,
    f.total_amount_usd,
    
    -- 2. Dimension Data (Context)
    -- We act as if these columns always belonged to the trade
    d.sector,
    d.risk_level,
    
    -- 3. Metadata (Optional)
    f.fact_id,
    f.buyer_order_id,
    f.seller_order_id

FROM streaming_db.public.fact_trades f
-- The Join is already done HERE so users don't have to do it
LEFT JOIN streaming_db.public.dim_symbol d 
    ON f.symbol_key = d.symbol_key
  );
[0m15:56:34.740978 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:56:35.860762 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0f5bc-0001-ba7e-0001-85aa0004a09e
[0m15:56:35.861424 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 4
invalid identifier 'F.TICKER'
[0m15:56:35.862198 [debug] [Thread-1  ]: On model.crypto_transform.gold_consumption_view: Close
[0m15:56:36.231172 [debug] [Thread-1  ]: Database Error in model gold_consumption_view (models/gold/gold_consumption_view.sql)
  000904 (42000): SQL compilation error: error line 9 at position 4
  invalid identifier 'F.TICKER'
  compiled code at target/run/crypto_transform/models/gold/gold_consumption_view.sql
[0m15:56:36.231918 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bad6ab3b-19f0-4736-9dcd-8b17e95d3f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c53e7c8e0>]}
[0m15:56:36.232709 [error] [Thread-1  ]: 5 of 5 ERROR creating sql view model public.gold_consumption_view .............. [[31mERROR[0m in 1.50s]
[0m15:56:36.233523 [debug] [Thread-1  ]: Finished running node model.crypto_transform.gold_consumption_view
[0m15:56:36.235599 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:36.235997 [debug] [MainThread]: Connection 'model.crypto_transform.gold_consumption_view' was properly closed.
[0m15:56:36.236513 [info ] [MainThread]: 
[0m15:56:36.237007 [info ] [MainThread]: Finished running 2 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 30.37 seconds (30.37s).
[0m15:56:36.238584 [debug] [MainThread]: Command end result
[0m15:56:36.273937 [info ] [MainThread]: 
[0m15:56:36.274666 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:56:36.275112 [info ] [MainThread]: 
[0m15:56:36.275641 [error] [MainThread]:   Database Error in model gold_consumption_view (models/gold/gold_consumption_view.sql)
  000904 (42000): SQL compilation error: error line 9 at position 4
  invalid identifier 'F.TICKER'
  compiled code at target/run/crypto_transform/models/gold/gold_consumption_view.sql
[0m15:56:36.276107 [info ] [MainThread]: 
[0m15:56:36.276528 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m15:56:36.277672 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 32.65509, "process_user_time": 4.5061, "process_kernel_time": 1.216123, "process_mem_max_rss": "207964", "process_in_blocks": "25032", "process_out_blocks": "2920", "command_success": false}
[0m15:56:36.278462 [debug] [MainThread]: Command `dbt run` failed at 15:56:36.278342 after 32.66 seconds
[0m15:56:36.279021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c61a64130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c5beadfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c5f7bd5e0>]}
[0m15:56:36.279470 [debug] [MainThread]: Flushing usage events
[0m15:56:36.971180 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 13.952 seconds
[0m15:56:36.972799 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:56:36.973896 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
COMMIT
[0m15:56:38.994611 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.020 seconds
[0m15:56:39.001054 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.fact_trades__dbt_tmp
[0m15:56:39.002830 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:56:39.003400 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
drop view if exists streaming_db.public.fact_trades__dbt_tmp cascade
[0m15:56:42.240958 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.237 seconds
[0m15:56:42.244522 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: Close
[0m15:56:42.638615 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4a43553-ea1f-4bf3-a3ce-2018a13a0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7529707a0dc0>]}
[0m15:56:42.640150 [info ] [Thread-1  ]: 4 of 5 OK created sql incremental model public.fact_trades ..................... [[32mSUCCESS 0[0m in 21.55s]
[0m15:56:42.641253 [debug] [Thread-1  ]: Finished running node model.crypto_transform.fact_trades
[0m15:56:42.643100 [debug] [Thread-1  ]: Began running node model.crypto_transform.gold_consumption_view
[0m15:56:42.644204 [info ] [Thread-1  ]: 5 of 5 START sql view model public.gold_consumption_view ....................... [RUN]
[0m15:56:42.646594 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.fact_trades, now model.crypto_transform.gold_consumption_view)
[0m15:56:42.647324 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.gold_consumption_view
[0m15:56:42.653347 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.gold_consumption_view"
[0m15:56:42.655222 [debug] [Thread-1  ]: Began executing node model.crypto_transform.gold_consumption_view
[0m15:56:42.664409 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.gold_consumption_view"
[0m15:56:42.667313 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.gold_consumption_view"
[0m15:56:42.668286 [debug] [Thread-1  ]: On model.crypto_transform.gold_consumption_view: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.gold_consumption_view"} */
create or replace   view streaming_db.public.gold_consumption_view
  
   as (
    

SELECT
    -- 1. Fact Data (Measures)
    f.trade_time,
    f.ticker,
    f.price,
    f.quantity,
    f.total_amount_usd,
    
    -- 2. Dimension Data (Context)
    -- We act as if these columns always belonged to the trade
    d.sector,
    d.risk_level,
    
    -- 3. Metadata (Optional)
    f.fact_id,
    f.buyer_order_id,
    f.seller_order_id

FROM streaming_db.public.fact_trades f
-- The Join is already done HERE so users don't have to do it
LEFT JOIN streaming_db.public.dim_symbol d 
    ON f.symbol_key = d.symbol_key
  );
[0m15:56:42.669115 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:56:44.026821 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0f5bc-0001-bad2-0001-85aa0004e086
[0m15:56:44.027468 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 4
invalid identifier 'F.TICKER'
[0m15:56:44.028116 [debug] [Thread-1  ]: On model.crypto_transform.gold_consumption_view: Close
[0m15:56:44.526112 [debug] [Thread-1  ]: Database Error in model gold_consumption_view (models/gold/gold_consumption_view.sql)
  000904 (42000): SQL compilation error: error line 9 at position 4
  invalid identifier 'F.TICKER'
  compiled code at target/run/crypto_transform/models/gold/gold_consumption_view.sql
[0m15:56:44.527164 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4a43553-ea1f-4bf3-a3ce-2018a13a0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752970730700>]}
[0m15:56:44.528026 [error] [Thread-1  ]: 5 of 5 ERROR creating sql view model public.gold_consumption_view .............. [[31mERROR[0m in 1.88s]
[0m15:56:44.529034 [debug] [Thread-1  ]: Finished running node model.crypto_transform.gold_consumption_view
[0m15:56:44.531170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:44.531645 [debug] [MainThread]: Connection 'model.crypto_transform.gold_consumption_view' was properly closed.
[0m15:56:44.532248 [info ] [MainThread]: 
[0m15:56:44.532983 [info ] [MainThread]: Finished running 2 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 38.67 seconds (38.67s).
[0m15:56:44.534919 [debug] [MainThread]: Command end result
[0m15:56:44.579567 [info ] [MainThread]: 
[0m15:56:44.580354 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:56:44.580807 [info ] [MainThread]: 
[0m15:56:44.581428 [error] [MainThread]:   Database Error in model gold_consumption_view (models/gold/gold_consumption_view.sql)
  000904 (42000): SQL compilation error: error line 9 at position 4
  invalid identifier 'F.TICKER'
  compiled code at target/run/crypto_transform/models/gold/gold_consumption_view.sql
[0m15:56:44.581869 [info ] [MainThread]: 
[0m15:56:44.582348 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m15:56:44.583652 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 40.87535, "process_user_time": 4.612177, "process_kernel_time": 1.232354, "process_mem_max_rss": "208796", "process_in_blocks": "32280", "process_out_blocks": "2416", "command_success": false}
[0m15:56:44.584415 [debug] [MainThread]: Command `dbt run` failed at 15:56:44.584297 after 40.88 seconds
[0m15:56:44.584941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75297e37aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7529550a2ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75297792f340>]}
[0m15:56:44.585450 [debug] [MainThread]: Flushing usage events
[0m15:56:52.979631 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m15:57:03.581398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da23d6c14c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da23b55e3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da23b4d85e0>]}


============================== 15:57:03.587240 | b27dc13e-f58c-4d2a-bb06-2eb7ba051bd5 ==============================
[0m15:57:03.587240 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:57:03.587856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m15:57:04.454363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b27dc13e-f58c-4d2a-bb06-2eb7ba051bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da20d90abe0>]}
[0m15:57:04.513510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b27dc13e-f58c-4d2a-bb06-2eb7ba051bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da23b5683a0>]}
[0m15:57:04.514558 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:57:04.538960 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:57:04.813459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:57:04.814071 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:57:04.889909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b27dc13e-f58c-4d2a-bb06-2eb7ba051bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da237974cd0>]}
[0m15:57:05.117331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b27dc13e-f58c-4d2a-bb06-2eb7ba051bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da237945880>]}
[0m15:57:05.117972 [info ] [MainThread]: Found 5 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m15:57:05.118422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b27dc13e-f58c-4d2a-bb06-2eb7ba051bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da237a69460>]}
[0m15:57:05.120097 [info ] [MainThread]: 
[0m15:57:05.120776 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:57:05.126707 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m15:57:05.142699 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m15:57:05.143136 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m15:57:05.143559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:06.551101 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.407 seconds
[0m15:57:06.554097 [debug] [ThreadPool]: On list_streaming_db: Close
[0m15:57:21.533998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m15:57:21.550162 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m15:57:21.550747 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m15:57:21.551204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:22.665439 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.114 seconds
[0m15:57:22.668507 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m15:57:23.050617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b27dc13e-f58c-4d2a-bb06-2eb7ba051bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da23bd89a90>]}
[0m15:57:23.051962 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:23.052710 [info ] [MainThread]: 
[0m15:57:23.063756 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m15:57:23.064718 [info ] [Thread-1  ]: 1 of 5 START sql view model public.bronze_data ................................. [RUN]
[0m15:57:23.065430 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m15:57:23.065964 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m15:57:23.076696 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m15:57:23.077573 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m15:57:23.107463 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m15:57:23.108963 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m15:57:23.109421 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m15:57:23.109887 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:57:46.255078 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 23.061 seconds
[0m15:57:46.283296 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m15:57:46.706355 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27dc13e-f58c-4d2a-bb06-2eb7ba051bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da237474850>]}
[0m15:57:46.707537 [info ] [Thread-1  ]: 1 of 5 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 23.64s]
[0m15:57:46.713470 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m15:57:46.714141 [debug] [Thread-1  ]: Began running node model.crypto_transform.dim_symbol
[0m15:57:46.715189 [info ] [Thread-1  ]: 2 of 5 START sql table model public.dim_symbol ................................. [RUN]
[0m15:57:46.716200 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.dim_symbol)
[0m15:57:46.716865 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.dim_symbol
[0m15:57:46.720896 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.dim_symbol"
[0m15:57:46.721692 [debug] [Thread-1  ]: Began executing node model.crypto_transform.dim_symbol
[0m15:57:46.746873 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.dim_symbol"
[0m15:57:46.748296 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.dim_symbol"
[0m15:57:46.748776 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.dim_symbol"} */
create or replace transient table streaming_db.public.dim_symbol
         as
        (SELECT
    -- Generate a unique Surrogate Key (INT) for the Fact table to use
    -- We use md5 hash of ticker + valid_from to ensure uniqueness for every version
    MD5(ticker || dbt_valid_from) as symbol_key,
    
    ticker,
    sector,
    risk_level,
    
    -- SCD2 Metadata
    dbt_valid_from as valid_from,
    COALESCE(dbt_valid_to, '9999-12-31'::timestamp) as valid_to,
    
    CASE 
        WHEN dbt_valid_to IS NULL THEN TRUE 
        ELSE FALSE 
    END as is_current

FROM streaming_db.public.dim_symbol_snapshot
        );
[0m15:57:46.749310 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:57:48.407247 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.658 seconds
[0m15:57:48.411186 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: Close
[0m15:58:03.148586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b466b80da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4669619700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4669619fa0>]}


============================== 15:58:03.154537 | 96efb54a-9d6a-4bc3-b982-ca7bee8aac0e ==============================
[0m15:58:03.154537 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:58:03.155160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:58:04.062934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96efb54a-9d6a-4bc3-b982-ca7bee8aac0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b463bf24f70>]}
[0m15:58:04.121981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96efb54a-9d6a-4bc3-b982-ca7bee8aac0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b463bf24e80>]}
[0m15:58:04.123039 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:58:04.147021 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:58:04.340787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:04.341514 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:04.418978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96efb54a-9d6a-4bc3-b982-ca7bee8aac0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4665aa7c10>]}
[0m15:58:04.647553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96efb54a-9d6a-4bc3-b982-ca7bee8aac0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4665a7adc0>]}
[0m15:58:04.648238 [info ] [MainThread]: Found 5 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m15:58:04.648763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96efb54a-9d6a-4bc3-b982-ca7bee8aac0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b463ad62190>]}
[0m15:58:04.650623 [info ] [MainThread]: 
[0m15:58:04.651335 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:58:04.657533 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m15:58:04.675286 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m15:58:04.675884 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m15:58:04.676335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:04.892498 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27dc13e-f58c-4d2a-bb06-2eb7ba051bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da23f6f56a0>]}
[0m15:58:04.894330 [info ] [Thread-1  ]: 2 of 5 OK created sql table model public.dim_symbol ............................ [[32mSUCCESS 1[0m in 18.18s]
[0m15:58:04.895683 [debug] [Thread-1  ]: Finished running node model.crypto_transform.dim_symbol
[0m15:58:04.896740 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m15:58:04.897943 [info ] [Thread-1  ]: 3 of 5 START sql incremental model public.silver_transformations ............... [RUN]
[0m15:58:04.898808 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.dim_symbol, now model.crypto_transform.silver_transformations)
[0m15:58:04.899383 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m15:58:04.910892 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m15:58:04.911864 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m15:58:04.954926 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:58:04.955712 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace  temporary view streaming_db.public.silver_transformations__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
        -- INCREMENTAL LOGIC (The most important part):
        -- "Only give me rows that are NEWER than the max time currently in this table"
        AND Trade_Time > (SELECT MAX(Trade_Time) FROM streaming_db.public.silver_transformations)
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
  );
[0m15:58:04.956447 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:58:06.232335 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.556 seconds
[0m15:58:06.235503 [debug] [ThreadPool]: On list_streaming_db: Close
[0m15:58:07.052219 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.096 seconds
[0m15:58:07.055951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m15:58:07.064745 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:58:07.065389 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations__dbt_tmp
[0m15:58:07.068566 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m15:58:07.069153 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m15:58:07.069566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:07.299077 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.233 seconds
[0m15:58:07.304512 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:58:07.305132 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations
[0m15:58:10.101582 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 2.796 seconds
[0m15:58:10.113550 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:58:10.114160 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table "STREAMING_DB"."PUBLIC"."SILVER_TRANSFORMATIONS"
[0m15:58:10.345227 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.230 seconds
[0m15:58:10.379583 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.silver_transformations"
[0m15:58:10.381540 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:58:10.382157 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
-- back compat for old kwarg name
  
  begin;
[0m15:58:10.616010 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.233 seconds
[0m15:58:10.616998 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:58:10.617709 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
merge into streaming_db.public.silver_transformations as DBT_INTERNAL_DEST
        using streaming_db.public.silver_transformations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.trade_id = DBT_INTERNAL_DEST.trade_id
            )

    
    when matched then update set
        "TICKER" = DBT_INTERNAL_SOURCE."TICKER","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TRADE_VALUE_USD" = DBT_INTERNAL_SOURCE."TRADE_VALUE_USD","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID","TRADE_CATEGORY" = DBT_INTERNAL_SOURCE."TRADE_CATEGORY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")
    values
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")

;
[0m15:58:10.819308 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3.750 seconds
[0m15:58:10.822088 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m15:58:11.198379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96efb54a-9d6a-4bc3-b982-ca7bee8aac0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b463f19db50>]}
[0m15:58:11.199955 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:58:11.201945 [info ] [MainThread]: 
[0m15:58:11.217367 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m15:58:11.218777 [info ] [Thread-1  ]: 1 of 5 START sql view model public.bronze_data ................................. [RUN]
[0m15:58:11.220111 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m15:58:11.222000 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m15:58:11.241885 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m15:58:11.243182 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m15:58:11.280123 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m15:58:11.281912 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m15:58:11.282555 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m15:58:11.283043 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:58:11.346997 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.729 seconds
[0m15:58:11.347989 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:58:11.348516 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
COMMIT
[0m15:58:11.717874 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.369 seconds
[0m15:58:11.728280 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.silver_transformations__dbt_tmp
[0m15:58:11.734755 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:58:11.735266 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
drop view if exists streaming_db.public.silver_transformations__dbt_tmp cascade
[0m15:58:11.986177 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.250 seconds
[0m15:58:11.990038 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m15:58:20.576355 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 9.277 seconds
[0m15:58:20.577197 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27dc13e-f58c-4d2a-bb06-2eb7ba051bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da23bd89a90>]}
[0m15:58:20.578286 [info ] [Thread-1  ]: 3 of 5 OK created sql incremental model public.silver_transformations .......... [[32mSUCCESS 0[0m in 15.68s]
[0m15:58:20.579122 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m15:58:20.580672 [debug] [Thread-1  ]: Began running node model.crypto_transform.fact_trades
[0m15:58:20.581343 [info ] [Thread-1  ]: 4 of 5 START sql incremental model public.fact_trades .......................... [RUN]
[0m15:58:20.582017 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.silver_transformations, now model.crypto_transform.fact_trades)
[0m15:58:20.582488 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.fact_trades
[0m15:58:20.587334 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.fact_trades"
[0m15:58:20.588099 [debug] [Thread-1  ]: Began executing node model.crypto_transform.fact_trades
[0m15:58:20.592383 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:58:20.592888 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
create or replace  temporary view streaming_db.public.fact_trades__dbt_tmp
  
   as (
    

SELECT
    -- Create a deterministic unique ID for the Fact
    MD5(s.trade_id || s.trade_time) as fact_id,
    
    -- Foreign Key to the Dimension (SCD2 Link)
    d.symbol_key,
    
    -- Fact Measures
    s.trade_time,
    s.price,
    s.quantity,
    (s.price * s.quantity) as total_amount_usd,
    
    -- Degenerate Dimensions (IDs usually left in Fact)
    s.trade_id,
    s.buyer_order_id,
    s.seller_order_id

FROM streaming_db.public.silver_transformations s
-- JOIN Logic for SCD Type 2:
-- Match Ticker AND ensure Trade Time falls between the Dimension's validity window
LEFT JOIN streaming_db.public.dim_symbol d 
    ON s.ticker = d.ticker 
    AND s.trade_time >= d.valid_from 
    AND s.trade_time < d.valid_to


WHERE s.trade_time > (SELECT MAX(trade_time) FROM streaming_db.public.fact_trades)

  );
[0m15:58:20.593321 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:58:20.604746 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m15:58:19.165524 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96efb54a-9d6a-4bc3-b982-ca7bee8aac0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46655b74f0>]}
[0m15:58:19.167006 [info ] [Thread-1  ]: 1 of 5 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 7.94s]
[0m15:58:19.168045 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m15:58:19.168792 [debug] [Thread-1  ]: Began running node model.crypto_transform.dim_symbol
[0m15:58:19.169817 [info ] [Thread-1  ]: 2 of 5 START sql table model public.dim_symbol ................................. [RUN]
[0m15:58:19.170944 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.dim_symbol)
[0m15:58:19.171486 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.dim_symbol
[0m15:58:19.174935 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.dim_symbol"
[0m15:58:19.175642 [debug] [Thread-1  ]: Began executing node model.crypto_transform.dim_symbol
[0m15:58:19.199630 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.dim_symbol"
[0m15:58:19.201074 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.dim_symbol"
[0m15:58:19.201633 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.dim_symbol"} */
create or replace transient table streaming_db.public.dim_symbol
         as
        (SELECT
    -- Generate a unique Surrogate Key (INT) for the Fact table to use
    -- We use md5 hash of ticker + valid_from to ensure uniqueness for every version
    MD5(ticker || dbt_valid_from) as symbol_key,
    
    ticker,
    sector,
    risk_level,
    
    -- SCD2 Metadata
    dbt_valid_from as valid_from,
    COALESCE(dbt_valid_to, '9999-12-31'::timestamp) as valid_to,
    
    CASE 
        WHEN dbt_valid_to IS NULL THEN TRUE 
        ELSE FALSE 
    END as is_current

FROM streaming_db.public.dim_symbol_snapshot
        );
[0m15:58:19.202131 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:58:40.374521 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 19.633 seconds
[0m15:58:40.378818 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:58:40.379403 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table streaming_db.public.fact_trades__dbt_tmp
[0m15:58:40.605947 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.226 seconds
[0m15:58:40.611640 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:58:40.612206 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table streaming_db.public.fact_trades
[0m15:58:40.835279 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.223 seconds
[0m15:58:40.843033 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:58:40.843772 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table "STREAMING_DB"."PUBLIC"."FACT_TRADES"
[0m15:58:41.060298 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.216 seconds
[0m15:58:41.079025 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.fact_trades"
[0m15:58:41.082490 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:58:41.083591 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
-- back compat for old kwarg name
  
  begin;
[0m15:58:41.328189 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.244 seconds
[0m15:58:41.328971 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:58:41.329587 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
merge into streaming_db.public.fact_trades as DBT_INTERNAL_DEST
        using streaming_db.public.fact_trades__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.fact_id = DBT_INTERNAL_DEST.fact_id
            )

    
    when matched then update set
        "FACT_ID" = DBT_INTERNAL_SOURCE."FACT_ID","SYMBOL_KEY" = DBT_INTERNAL_SOURCE."SYMBOL_KEY","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TOTAL_AMOUNT_USD" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT_USD","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID"
    

    when not matched then insert
        ("FACT_ID", "SYMBOL_KEY", "TRADE_TIME", "PRICE", "QUANTITY", "TOTAL_AMOUNT_USD", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID")
    values
        ("FACT_ID", "SYMBOL_KEY", "TRADE_TIME", "PRICE", "QUANTITY", "TOTAL_AMOUNT_USD", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID")

;
[0m15:59:03.830058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7851a4654190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7851a2c5eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7851a2629520>]}


============================== 15:59:03.836365 | 09f43936-e180-44d4-9ad0-cde40c83828c ==============================
[0m15:59:03.836365 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:59:03.837101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:59:04.769040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09f43936-e180-44d4-9ad0-cde40c83828c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7851a23f05e0>]}
[0m15:59:04.800367 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 23.506 seconds
[0m15:59:04.801301 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:59:04.801803 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
COMMIT
[0m15:59:04.804507 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 40.367 seconds
[0m15:59:04.808419 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: Close
[0m15:59:04.830564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09f43936-e180-44d4-9ad0-cde40c83828c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785174d45a60>]}
[0m15:59:04.831728 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:59:04.858088 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:59:05.049323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:59:05.049924 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:59:05.123081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09f43936-e180-44d4-9ad0-cde40c83828c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78519e945ca0>]}
[0m15:59:05.142252 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.340 seconds
[0m15:59:05.146884 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.fact_trades__dbt_tmp
[0m15:59:05.148096 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m15:59:05.148687 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
drop view if exists streaming_db.public.fact_trades__dbt_tmp cascade
[0m15:59:05.175122 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96efb54a-9d6a-4bc3-b982-ca7bee8aac0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b463bf022b0>]}
[0m15:59:05.176150 [info ] [Thread-1  ]: 2 of 5 OK created sql table model public.dim_symbol ............................ [[32mSUCCESS 1[0m in 46.00s]
[0m15:59:05.177277 [debug] [Thread-1  ]: Finished running node model.crypto_transform.dim_symbol
[0m15:59:05.177935 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m15:59:05.178954 [info ] [Thread-1  ]: 3 of 5 START sql incremental model public.silver_transformations ............... [RUN]
[0m15:59:05.179649 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.dim_symbol, now model.crypto_transform.silver_transformations)
[0m15:59:05.180231 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m15:59:05.191314 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m15:59:05.192254 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m15:59:05.229010 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:59:05.229726 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace  temporary view streaming_db.public.silver_transformations__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
        -- INCREMENTAL LOGIC (The most important part):
        -- "Only give me rows that are NEWER than the max time currently in this table"
        AND Trade_Time > (SELECT MAX(Trade_Time) FROM streaming_db.public.silver_transformations)
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
  );
[0m15:59:05.230333 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:59:05.368641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09f43936-e180-44d4-9ad0-cde40c83828c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78519e91a700>]}
[0m15:59:05.369422 [info ] [MainThread]: Found 5 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m15:59:05.369931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09f43936-e180-44d4-9ad0-cde40c83828c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785174cc17f0>]}
[0m15:59:05.371655 [info ] [MainThread]: 
[0m15:59:05.372386 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:59:05.378420 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m15:59:05.394325 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m15:59:05.394747 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m15:59:05.395180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:05.524399 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.375 seconds
[0m15:59:05.528138 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: Close
[0m15:59:05.973305 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27dc13e-f58c-4d2a-bb06-2eb7ba051bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da23799e880>]}
[0m15:59:05.974501 [info ] [Thread-1  ]: 4 of 5 OK created sql incremental model public.fact_trades ..................... [[32mSUCCESS 0[0m in 45.39s]
[0m15:59:05.975307 [debug] [Thread-1  ]: Finished running node model.crypto_transform.fact_trades
[0m15:59:05.976624 [debug] [Thread-1  ]: Began running node model.crypto_transform.gold_consumption_view
[0m15:59:05.977950 [info ] [Thread-1  ]: 5 of 5 START sql view model public.gold_consumption_view ....................... [RUN]
[0m15:59:05.978608 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.fact_trades, now model.crypto_transform.gold_consumption_view)
[0m15:59:05.979194 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.gold_consumption_view
[0m15:59:05.983775 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.gold_consumption_view"
[0m15:59:05.984541 [debug] [Thread-1  ]: Began executing node model.crypto_transform.gold_consumption_view
[0m15:59:05.988736 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.gold_consumption_view"
[0m15:59:05.989975 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.gold_consumption_view"
[0m15:59:05.990502 [debug] [Thread-1  ]: On model.crypto_transform.gold_consumption_view: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.gold_consumption_view"} */
create or replace   view streaming_db.public.gold_consumption_view
  
   as (
    

SELECT
    -- 1. Fact Data (Measures)
    f.trade_time,
    f.ticker,
    f.price,
    f.quantity,
    f.total_amount_usd,
    
    -- 2. Dimension Data (Context)
    -- We act as if these columns always belonged to the trade
    d.sector,
    d.risk_level,
    
    -- 3. Metadata (Optional)
    f.fact_id,
    f.buyer_order_id,
    f.seller_order_id

FROM streaming_db.public.fact_trades f
-- The Join is already done HERE so users don't have to do it
LEFT JOIN streaming_db.public.dim_symbol d 
    ON f.symbol_key = d.symbol_key
  );
[0m15:59:05.990955 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:59:12.750363 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 7.355 seconds
[0m15:59:12.753491 [debug] [ThreadPool]: On list_streaming_db: Close
[0m15:59:12.827324 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 7.597 seconds
[0m15:59:12.838925 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:59:12.839558 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations__dbt_tmp
[0m15:59:13.083762 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.244 seconds
[0m15:59:13.089463 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:59:13.090028 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations
[0m15:59:13.154025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m15:59:13.232119 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m15:59:13.232750 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m15:59:13.233266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:15.284087 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 2.130 seconds
[0m15:59:14.609628 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:59:14.610186 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table "STREAMING_DB"."PUBLIC"."SILVER_TRANSFORMATIONS"
[0m15:59:14.624816 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0f5bf-0001-bad1-0001-85aa000460ca
[0m15:59:14.625486 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 4
invalid identifier 'F.TICKER'
[0m15:59:14.626114 [debug] [Thread-1  ]: On model.crypto_transform.gold_consumption_view: Close
[0m15:59:14.846395 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.236 seconds
[0m15:59:14.878713 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.silver_transformations"
[0m15:59:14.880748 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:59:14.881294 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
-- back compat for old kwarg name
  
  begin;
[0m15:59:15.098754 [debug] [Thread-1  ]: Database Error in model gold_consumption_view (models/gold/gold_consumption_view.sql)
  000904 (42000): SQL compilation error: error line 9 at position 4
  invalid identifier 'F.TICKER'
  compiled code at target/run/crypto_transform/models/gold/gold_consumption_view.sql
[0m15:59:15.099570 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27dc13e-f58c-4d2a-bb06-2eb7ba051bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da23b536e50>]}
[0m15:59:15.100469 [error] [Thread-1  ]: 5 of 5 ERROR creating sql view model public.gold_consumption_view .............. [[31mERROR[0m in 9.12s]
[0m15:59:15.101384 [debug] [Thread-1  ]: Finished running node model.crypto_transform.gold_consumption_view
[0m15:59:15.103753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:15.104290 [debug] [MainThread]: Connection 'model.crypto_transform.gold_consumption_view' was properly closed.
[0m15:59:15.104908 [info ] [MainThread]: 
[0m15:59:15.105471 [info ] [MainThread]: Finished running 2 view models, 1 table model, 2 incremental models in 0 hours 2 minutes and 9.98 seconds (129.98s).
[0m15:59:15.107360 [debug] [MainThread]: Command end result
[0m15:59:15.134146 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.252 seconds
[0m15:59:15.134985 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:59:15.135561 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
merge into streaming_db.public.silver_transformations as DBT_INTERNAL_DEST
        using streaming_db.public.silver_transformations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.trade_id = DBT_INTERNAL_DEST.trade_id
            )

    
    when matched then update set
        "TICKER" = DBT_INTERNAL_SOURCE."TICKER","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TRADE_VALUE_USD" = DBT_INTERNAL_SOURCE."TRADE_VALUE_USD","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID","TRADE_CATEGORY" = DBT_INTERNAL_SOURCE."TRADE_CATEGORY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")
    values
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")

;
[0m15:59:15.145699 [info ] [MainThread]: 
[0m15:59:15.146420 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:59:15.146919 [info ] [MainThread]: 
[0m15:59:15.147607 [error] [MainThread]:   Database Error in model gold_consumption_view (models/gold/gold_consumption_view.sql)
  000904 (42000): SQL compilation error: error line 9 at position 4
  invalid identifier 'F.TICKER'
  compiled code at target/run/crypto_transform/models/gold/gold_consumption_view.sql
[0m15:59:15.148079 [info ] [MainThread]: 
[0m15:59:15.148818 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m15:59:15.150991 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 131.96475, "process_user_time": 4.137173, "process_kernel_time": 1.546379, "process_mem_max_rss": "206072", "process_in_blocks": "1456", "process_out_blocks": "2072", "command_success": false}
[0m15:59:15.151804 [debug] [MainThread]: Command `dbt run` failed at 15:59:15.151689 after 131.97 seconds
[0m15:59:15.152450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da23d6c14c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da23d324160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da23f6f56a0>]}
[0m15:59:15.152898 [debug] [MainThread]: Flushing usage events
[0m15:59:18.911199 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 6.364 seconds
[0m15:59:18.913649 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m15:59:24.439130 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m15:59:50.565565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09f43936-e180-44d4-9ad0-cde40c83828c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7851a32f0a30>]}
[0m15:59:50.566529 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:59:50.567071 [info ] [MainThread]: 
[0m15:59:50.577135 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m15:59:50.577980 [info ] [Thread-1  ]: 1 of 5 START sql view model public.bronze_data ................................. [RUN]
[0m15:59:50.578664 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m15:59:50.579116 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m15:59:50.589559 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m15:59:50.590464 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m15:59:50.620830 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m15:59:50.622288 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m15:59:50.622757 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m15:59:50.623212 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:59:50.857744 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 35.114 seconds
[0m15:59:50.858588 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:59:50.859087 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
COMMIT
[0m15:59:51.229496 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.370 seconds
[0m15:59:51.240527 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.silver_transformations__dbt_tmp
[0m15:59:51.247617 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m15:59:51.248301 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
drop view if exists streaming_db.public.silver_transformations__dbt_tmp cascade
[0m15:59:51.540145 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.291 seconds
[0m15:59:51.546037 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m16:00:03.315770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec317c5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec2f72e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec2f7bc460>]}


============================== 16:00:03.320921 | e4aac8ae-88f9-47e5-8d50-f5be70e5412f ==============================
[0m16:00:03.320921 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:00:03.321486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:00:03.940777 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 13.317 seconds
[0m16:00:03.966610 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m16:00:04.198112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4aac8ae-88f9-47e5-8d50-f5be70e5412f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec0856f610>]}
[0m16:00:04.255837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4aac8ae-88f9-47e5-8d50-f5be70e5412f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec084f9ee0>]}
[0m16:00:04.256929 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:00:04.284174 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:00:04.454449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:04.455000 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:04.521481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4aac8ae-88f9-47e5-8d50-f5be70e5412f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec2ba4cc70>]}
[0m16:00:04.732801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4aac8ae-88f9-47e5-8d50-f5be70e5412f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec2ba1c790>]}
[0m16:00:04.733511 [info ] [MainThread]: Found 5 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m16:00:04.733976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4aac8ae-88f9-47e5-8d50-f5be70e5412f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec084b2a30>]}
[0m16:00:04.735696 [info ] [MainThread]: 
[0m16:00:04.736375 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:00:04.741724 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m16:00:04.757370 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m16:00:04.757833 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m16:00:04.758205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:04.826582 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96efb54a-9d6a-4bc3-b982-ca7bee8aac0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b463f19db50>]}
[0m16:00:04.827684 [info ] [Thread-1  ]: 3 of 5 OK created sql incremental model public.silver_transformations .......... [[32mSUCCESS 0[0m in 59.65s]
[0m16:00:04.828513 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m16:00:04.829525 [debug] [Thread-1  ]: Began running node model.crypto_transform.fact_trades
[0m16:00:04.830517 [info ] [Thread-1  ]: 4 of 5 START sql incremental model public.fact_trades .......................... [RUN]
[0m16:00:04.831165 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.silver_transformations, now model.crypto_transform.fact_trades)
[0m16:00:04.831758 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.fact_trades
[0m16:00:04.836256 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.fact_trades"
[0m16:00:04.836956 [debug] [Thread-1  ]: Began executing node model.crypto_transform.fact_trades
[0m16:00:04.841167 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:00:04.841689 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
create or replace  temporary view streaming_db.public.fact_trades__dbt_tmp
  
   as (
    

SELECT
    -- Create a deterministic unique ID for the Fact
    MD5(s.trade_id || s.trade_time) as fact_id,
    
    -- Foreign Key to the Dimension (SCD2 Link)
    d.symbol_key,
    
    -- Fact Measures
    s.trade_time,
    s.price,
    s.quantity,
    (s.price * s.quantity) as total_amount_usd,
    
    -- Degenerate Dimensions (IDs usually left in Fact)
    s.trade_id,
    s.buyer_order_id,
    s.seller_order_id

FROM streaming_db.public.silver_transformations s
-- JOIN Logic for SCD Type 2:
-- Match Ticker AND ensure Trade Time falls between the Dimension's validity window
LEFT JOIN streaming_db.public.dim_symbol d 
    ON s.ticker = d.ticker 
    AND s.trade_time >= d.valid_from 
    AND s.trade_time < d.valid_to


WHERE s.trade_time > (SELECT MAX(trade_time) FROM streaming_db.public.fact_trades)

  );
[0m16:00:04.842118 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:01:03.425938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be53cad1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be53a8de700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be53a8defa0>]}


============================== 16:01:03.431633 | ac8e62ea-0110-4b93-90dd-678bbe17a211 ==============================
[0m16:01:03.431633 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:01:03.432267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m16:01:04.392040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac8e62ea-0110-4b93-90dd-678bbe17a211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be50d1ddf70>]}
[0m16:01:04.452919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac8e62ea-0110-4b93-90dd-678bbe17a211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be50d1dde80>]}
[0m16:01:04.453937 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:01:04.477177 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:01:04.653488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:01:04.654347 [debug] [MainThread]: Partial parsing: updated file: crypto_transform://models/gold/gold_consumption_view.sql
[0m16:01:05.021267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac8e62ea-0110-4b93-90dd-678bbe17a211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be53a8e6cd0>]}
[0m16:01:05.166021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac8e62ea-0110-4b93-90dd-678bbe17a211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be536081340>]}
[0m16:01:05.166762 [info ] [MainThread]: Found 5 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m16:01:05.167247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac8e62ea-0110-4b93-90dd-678bbe17a211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be536eebe20>]}
[0m16:01:05.169089 [info ] [MainThread]: 
[0m16:01:05.169800 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:01:05.175737 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m16:01:05.194513 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m16:01:05.195164 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m16:01:05.195705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:13.975300 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 8.651 seconds
[0m16:01:13.978589 [debug] [ThreadPool]: On list_streaming_db: Close
[0m16:01:14.387178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m16:01:14.400465 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m16:01:14.401019 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m16:01:14.401420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:17.161026 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.759 seconds
[0m16:01:17.162886 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09f43936-e180-44d4-9ad0-cde40c83828c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78517c03af40>]}
[0m16:01:17.163903 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m16:01:17.163951 [info ] [Thread-1  ]: 1 of 5 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 86.58s]
[0m16:01:17.164776 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m16:01:17.165594 [debug] [Thread-1  ]: Began running node model.crypto_transform.dim_symbol
[0m16:01:17.166551 [info ] [Thread-1  ]: 2 of 5 START sql table model public.dim_symbol ................................. [RUN]
[0m16:01:17.167581 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.dim_symbol)
[0m16:01:17.168129 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.dim_symbol
[0m16:01:17.172108 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.dim_symbol"
[0m16:01:17.173043 [debug] [Thread-1  ]: Began executing node model.crypto_transform.dim_symbol
[0m16:01:17.196753 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.dim_symbol"
[0m16:01:17.198096 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.dim_symbol"
[0m16:01:17.198578 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.dim_symbol"} */
create or replace transient table streaming_db.public.dim_symbol
         as
        (SELECT
    -- Generate a unique Surrogate Key (INT) for the Fact table to use
    -- We use md5 hash of ticker + valid_from to ensure uniqueness for every version
    MD5(ticker || dbt_valid_from) as symbol_key,
    
    ticker,
    sector,
    risk_level,
    
    -- SCD2 Metadata
    dbt_valid_from as valid_from,
    COALESCE(dbt_valid_to, '9999-12-31'::timestamp) as valid_to,
    
    CASE 
        WHEN dbt_valid_to IS NULL THEN TRUE 
        ELSE FALSE 
    END as is_current

FROM streaming_db.public.dim_symbol_snapshot
        );
[0m16:01:17.199042 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:01:17.643268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac8e62ea-0110-4b93-90dd-678bbe17a211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be50d1d1d90>]}
[0m16:01:17.644555 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:01:17.645134 [info ] [MainThread]: 
[0m16:01:17.654850 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m16:01:17.655589 [info ] [Thread-1  ]: 1 of 5 START sql view model public.bronze_data ................................. [RUN]
[0m16:01:17.656219 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m16:01:17.656958 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m16:01:17.665981 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m16:01:17.667263 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m16:01:17.696730 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m16:01:17.698054 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m16:01:17.698516 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m16:01:17.698963 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:01:18.317666 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 73.007 seconds
[0m16:01:18.322092 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:01:18.322685 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table streaming_db.public.fact_trades__dbt_tmp
[0m16:01:18.572487 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.249 seconds
[0m16:01:18.577757 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:01:18.578415 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table streaming_db.public.fact_trades
[0m16:01:18.844613 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.266 seconds
[0m16:01:18.852817 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:01:18.853486 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table "STREAMING_DB"."PUBLIC"."FACT_TRADES"
[0m16:01:19.047398 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.848 seconds
[0m16:01:19.050810 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: Close
[0m16:01:19.082100 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.228 seconds
[0m16:01:19.089533 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.fact_trades"
[0m16:01:19.091367 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:01:19.091948 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
-- back compat for old kwarg name
  
  begin;
[0m16:01:19.362648 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.270 seconds
[0m16:01:19.363436 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:01:19.363999 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
merge into streaming_db.public.fact_trades as DBT_INTERNAL_DEST
        using streaming_db.public.fact_trades__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.fact_id = DBT_INTERNAL_DEST.fact_id
            )

    
    when matched then update set
        "FACT_ID" = DBT_INTERNAL_SOURCE."FACT_ID","SYMBOL_KEY" = DBT_INTERNAL_SOURCE."SYMBOL_KEY","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TOTAL_AMOUNT_USD" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT_USD","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID"
    

    when not matched then insert
        ("FACT_ID", "SYMBOL_KEY", "TRADE_TIME", "PRICE", "QUANTITY", "TOTAL_AMOUNT_USD", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID")
    values
        ("FACT_ID", "SYMBOL_KEY", "TRADE_TIME", "PRICE", "QUANTITY", "TOTAL_AMOUNT_USD", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID")

;
[0m16:01:19.450560 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09f43936-e180-44d4-9ad0-cde40c83828c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7851a2c44cd0>]}
[0m16:01:19.451672 [info ] [Thread-1  ]: 2 of 5 OK created sql table model public.dim_symbol ............................ [[32mSUCCESS 1[0m in 2.28s]
[0m16:01:19.452671 [debug] [Thread-1  ]: Finished running node model.crypto_transform.dim_symbol
[0m16:01:19.453337 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m16:01:19.454213 [info ] [Thread-1  ]: 3 of 5 START sql incremental model public.silver_transformations ............... [RUN]
[0m16:01:19.454974 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.dim_symbol, now model.crypto_transform.silver_transformations)
[0m16:01:19.455526 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m16:01:19.466274 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m16:01:19.467030 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m16:01:19.502197 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:01:19.502887 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace  temporary view streaming_db.public.silver_transformations__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
        -- INCREMENTAL LOGIC (The most important part):
        -- "Only give me rows that are NEWER than the max time currently in this table"
        AND Trade_Time > (SELECT MAX(Trade_Time) FROM streaming_db.public.silver_transformations)
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
  );
[0m16:01:19.503416 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:01:38.571606 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 20.873 seconds
[0m16:01:38.602561 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m16:01:41.554265 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8e62ea-0110-4b93-90dd-678bbe17a211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be514461eb0>]}
[0m16:01:41.555629 [info ] [Thread-1  ]: 1 of 5 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 23.90s]
[0m16:01:41.556806 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m16:01:41.557486 [debug] [Thread-1  ]: Began running node model.crypto_transform.dim_symbol
[0m16:01:41.558418 [info ] [Thread-1  ]: 2 of 5 START sql table model public.dim_symbol ................................. [RUN]
[0m16:01:41.559353 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.dim_symbol)
[0m16:01:41.559878 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.dim_symbol
[0m16:01:41.563309 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.dim_symbol"
[0m16:01:41.563998 [debug] [Thread-1  ]: Began executing node model.crypto_transform.dim_symbol
[0m16:01:41.586548 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.dim_symbol"
[0m16:01:41.587714 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.dim_symbol"
[0m16:01:41.588263 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.dim_symbol"} */
create or replace transient table streaming_db.public.dim_symbol
         as
        (SELECT
    -- Generate a unique Surrogate Key (INT) for the Fact table to use
    -- We use md5 hash of ticker + valid_from to ensure uniqueness for every version
    MD5(ticker || dbt_valid_from) as symbol_key,
    
    ticker,
    sector,
    risk_level,
    
    -- SCD2 Metadata
    dbt_valid_from as valid_from,
    COALESCE(dbt_valid_to, '9999-12-31'::timestamp) as valid_to,
    
    CASE 
        WHEN dbt_valid_to IS NULL THEN TRUE 
        ELSE FALSE 
    END as is_current

FROM streaming_db.public.dim_symbol_snapshot
        );
[0m16:01:41.588842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:01:42.720437 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 97.493 seconds
[0m16:01:42.723490 [debug] [ThreadPool]: On list_streaming_db: Close
[0m16:01:44.550958 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 24.931 seconds
[0m16:01:44.562743 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:01:44.563370 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations__dbt_tmp
[0m16:01:44.568787 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.864 seconds
[0m16:01:44.571441 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: Close
[0m16:02:04.025318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df76ae2c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df7692f3ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df768dfe520>]}


============================== 16:02:04.031076 | 3b199662-79bc-4f82-86ad-8492be21d9fd ==============================
[0m16:02:04.031076 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:02:04.031755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:02:04.935759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b199662-79bc-4f82-86ad-8492be21d9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df768bc45e0>]}
[0m16:02:04.992093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b199662-79bc-4f82-86ad-8492be21d9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df73b53da60>]}
[0m16:02:04.993044 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:02:05.021328 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:02:05.198309 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:02:05.198884 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:02:05.269369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b199662-79bc-4f82-86ad-8492be21d9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df76515ee50>]}
[0m16:02:05.498467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b199662-79bc-4f82-86ad-8492be21d9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df7650f0700>]}
[0m16:02:05.499133 [info ] [MainThread]: Found 5 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m16:02:05.499615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b199662-79bc-4f82-86ad-8492be21d9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df73b48c820>]}
[0m16:02:05.501190 [info ] [MainThread]: 
[0m16:02:05.501896 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:02:05.507652 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m16:02:05.523491 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m16:02:05.523982 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m16:02:05.524412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:39.717164 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: None
[0m16:02:39.717962 [debug] [Thread-1  ]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations__dbt_tmp
[0m16:02:39.718517 [debug] [Thread-1  ]: Snowflake adapter: Rolling back transaction.
[0m16:02:39.719339 [debug] [Thread-1  ]: Snowflake adapter: Error running SQL: macro get_columns_in_relation
[0m16:02:39.719832 [debug] [Thread-1  ]: Snowflake adapter: Rolling back transaction.
[0m16:02:39.720423 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m16:02:44.710654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m16:02:44.723353 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m16:02:44.723818 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m16:02:44.724186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:53.341678 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: None
[0m16:02:53.342497 [debug] [Thread-1  ]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
merge into streaming_db.public.fact_trades as DBT_INTERNAL_DEST
        using streaming_db.public.fact_trades__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.fact_id = DBT_INTERNAL_DEST.fact_id
            )

    
    when matched then update set
        "FACT_ID" = DBT_INTERNAL_SOURCE."FACT_ID","SYMBOL_KEY" = DBT_INTERNAL_SOURCE."SYMBOL_KEY","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TOTAL_AMOUNT_USD" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT_USD","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID"
    

    when not matched then insert
        ("FACT_ID", "SYMBOL_KEY", "TRADE_TIME", "PRICE", "QUANTITY", "TOTAL_AMOUNT_USD", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID")
    values
        ("FACT_ID", "SYMBOL_KEY", "TRADE_TIME", "PRICE", "QUANTITY", "TOTAL_AMOUNT_USD", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID")

;
[0m16:02:53.343247 [debug] [Thread-1  ]: Snowflake adapter: Rolling back transaction.
[0m16:02:53.344190 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: Close
[0m16:03:04.401569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd530b664c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd52ea023a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd52e9885e0>]}


============================== 16:03:04.407381 | fc9279e8-a3b6-4315-832e-1d254b73d482 ==============================
[0m16:03:04.407381 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:03:04.407964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m16:03:05.337307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc9279e8-a3b6-4315-832e-1d254b73d482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd5011cfbe0>]}
[0m16:03:05.393443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc9279e8-a3b6-4315-832e-1d254b73d482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd52ea0c340>]}
[0m16:03:05.394646 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:03:05.419449 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:03:05.621771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:03:05.622417 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:03:05.698556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc9279e8-a3b6-4315-832e-1d254b73d482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd52ae1ad90>]}
[0m16:03:05.941839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc9279e8-a3b6-4315-832e-1d254b73d482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd52ade9880>]}
[0m16:03:05.942614 [info ] [MainThread]: Found 5 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m16:03:05.943235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc9279e8-a3b6-4315-832e-1d254b73d482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd52af0c460>]}
[0m16:03:05.945199 [info ] [MainThread]: 
[0m16:03:05.946014 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:03:05.952872 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m16:03:05.970131 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m16:03:05.970694 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m16:03:05.971223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:09.043180 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m16:03:09.043832 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:03:09.044429 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m16:03:09.044822 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:03:09.045416 [debug] [ThreadPool]: On list_streaming_db: No close available on handle
[0m16:03:09.046345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:09.046869 [debug] [MainThread]: Connection 'list_streaming_db' was properly closed.
[0m16:03:09.047317 [info ] [MainThread]: 
[0m16:03:09.047942 [info ] [MainThread]: Finished running  in 0 hours 1 minutes and 3.55 seconds (63.55s).
[0m16:03:09.048677 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "streaming_db"
  Database Error
    250001: Could not connect to Snowflake backend after 1 attempt(s).Aborting
[0m16:03:09.050505 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 64.966286, "process_user_time": 3.196623, "process_kernel_time": 1.51419, "process_mem_max_rss": "197872", "process_in_blocks": "7512", "process_out_blocks": "960", "command_success": false}
[0m16:03:09.051232 [debug] [MainThread]: Command `dbt run` failed at 16:03:09.051116 after 64.97 seconds
[0m16:03:09.051703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df76ae2c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df76aa7b040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df768ccda60>]}
[0m16:03:09.052204 [debug] [MainThread]: Flushing usage events
[0m16:03:15.448676 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m16:03:36.712101 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8e62ea-0110-4b93-90dd-678bbe17a211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be5337d9be0>]}
[0m16:03:36.713400 [info ] [Thread-1  ]: 2 of 5 OK created sql table model public.dim_symbol ............................ [[32mSUCCESS 1[0m in 115.15s]
[0m16:03:36.714393 [debug] [Thread-1  ]: Finished running node model.crypto_transform.dim_symbol
[0m16:03:36.715175 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m16:03:36.715989 [info ] [Thread-1  ]: 3 of 5 START sql incremental model public.silver_transformations ............... [RUN]
[0m16:03:36.716787 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.dim_symbol, now model.crypto_transform.silver_transformations)
[0m16:03:36.717408 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m16:03:36.728006 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m16:03:36.728770 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m16:03:36.768458 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:03:36.769250 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace  temporary view streaming_db.public.silver_transformations__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
        -- INCREMENTAL LOGIC (The most important part):
        -- "Only give me rows that are NEWER than the max time currently in this table"
        AND Trade_Time > (SELECT MAX(Trade_Time) FROM streaming_db.public.silver_transformations)
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
  );
[0m16:03:36.769879 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:03:49.633919 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m16:03:49.634511 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:03:49.635092 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:03:49.635547 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:03:49.636104 [debug] [ThreadPool]: On list_streaming_db_public: No close available on handle
[0m16:03:49.637088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:49.637591 [debug] [MainThread]: Connection 'list_streaming_db_public' was properly closed.
[0m16:03:49.638305 [info ] [MainThread]: 
[0m16:03:49.638865 [info ] [MainThread]: Finished running  in 0 hours 3 minutes and 44.90 seconds (224.90s).
[0m16:03:49.639529 [error] [MainThread]: Encountered an error:
Database Error
  250001: Could not connect to Snowflake backend after 1 attempt(s).Aborting
[0m16:03:49.640897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 225.56734, "process_user_time": 3.399207, "process_kernel_time": 1.557423, "process_mem_max_rss": "207052", "process_in_blocks": "32", "process_out_blocks": "976", "command_success": false}
[0m16:03:49.641661 [debug] [MainThread]: Command `dbt run` failed at 16:03:49.641540 after 225.57 seconds
[0m16:03:49.642256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec317c5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec2b3a2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec2ba1c1f0>]}
[0m16:03:49.642751 [debug] [MainThread]: Flushing usage events
[0m16:03:54.887248 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m16:04:04.231101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7754d66a8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7754d4b32ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7754d463d520>]}


============================== 16:04:04.241016 | e86468d4-6461-48ee-bbaa-a46844f03871 ==============================
[0m16:04:04.241016 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:04:04.242177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:04:05.161609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e86468d4-6461-48ee-bbaa-a46844f03871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7754d43435e0>]}
[0m16:04:05.218075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e86468d4-6461-48ee-bbaa-a46844f03871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7754ad432a60>]}
[0m16:04:05.219294 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:04:05.242649 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:04:05.427704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:04:05.428417 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:04:05.514676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e86468d4-6461-48ee-bbaa-a46844f03871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7754d0955d60>]}
[0m16:04:05.753129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e86468d4-6461-48ee-bbaa-a46844f03871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7754d092e700>]}
[0m16:04:05.753898 [info ] [MainThread]: Found 5 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m16:04:05.754433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e86468d4-6461-48ee-bbaa-a46844f03871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7754ac3aa820>]}
[0m16:04:05.756146 [info ] [MainThread]: 
[0m16:04:05.756893 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:04:05.763770 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m16:04:05.782687 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m16:04:05.783433 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m16:04:05.783922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:09.402260 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m16:04:09.403079 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:04:09.403853 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m16:04:09.404356 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:04:09.405037 [debug] [ThreadPool]: On list_streaming_db: No close available on handle
[0m16:04:09.406220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:09.406759 [debug] [MainThread]: Connection 'list_streaming_db' was properly closed.
[0m16:04:09.407295 [info ] [MainThread]: 
[0m16:04:09.407915 [info ] [MainThread]: Finished running  in 0 hours 1 minutes and 3.46 seconds (63.46s).
[0m16:04:09.408610 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "streaming_db"
  Database Error
    250001: Could not connect to Snowflake backend after 1 attempt(s).Aborting
[0m16:04:09.409912 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 64.95051, "process_user_time": 3.1063, "process_kernel_time": 1.478615, "process_mem_max_rss": "198068", "process_in_blocks": "2048", "process_out_blocks": "952", "command_success": false}
[0m16:04:09.410682 [debug] [MainThread]: Command `dbt run` failed at 16:04:09.410563 after 64.95 seconds
[0m16:04:09.411290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd530b664c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd52af0c460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd52ae42580>]}
[0m16:04:09.411783 [debug] [MainThread]: Flushing usage events
[0m16:04:14.702155 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m16:04:40.439559 [debug] [Thread-1  ]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace  temporary view streaming_db.public.silver_transformations__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
        -- INCREMENTAL LOGIC (The most important part):
        -- "Only give me rows that are NEWER than the max time currently in this table"
        AND Trade_Time > (SELECT MAX(Trade_Time) FROM streaming_db.public.silver_transformations)
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
  );
[0m16:04:40.440282 [debug] [Thread-1  ]: Snowflake adapter: Rolling back transaction.
[0m16:04:40.440930 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: No close available on handle
[0m16:04:40.442438 [debug] [Thread-1  ]: Database Error in model silver_transformations (models/silver/silver_transformations.sql)
  250001: Could not connect to Snowflake backend after 1 attempt(s).Aborting
[0m16:04:40.443089 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8e62ea-0110-4b93-90dd-678bbe17a211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be52ec9b4c0>]}
[0m16:04:40.443870 [error] [Thread-1  ]: 3 of 5 ERROR creating sql incremental model public.silver_transformations ...... [[31mERROR[0m in 63.73s]
[0m16:04:40.444720 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m16:04:40.446257 [debug] [Thread-1  ]: Began running node model.crypto_transform.fact_trades
[0m16:04:40.447180 [info ] [Thread-1  ]: 4 of 5 SKIP relation public.fact_trades ........................................ [[33mSKIP[0m]
[0m16:04:40.447836 [debug] [Thread-1  ]: Finished running node model.crypto_transform.fact_trades
[0m16:04:40.449058 [debug] [Thread-1  ]: Began running node model.crypto_transform.gold_consumption_view
[0m16:04:40.449784 [info ] [Thread-1  ]: 5 of 5 SKIP relation public.gold_consumption_view .............................. [[33mSKIP[0m]
[0m16:04:40.450320 [debug] [Thread-1  ]: Finished running node model.crypto_transform.gold_consumption_view
[0m16:04:40.452644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:40.453188 [debug] [MainThread]: Connection 'model.crypto_transform.silver_transformations' was properly closed.
[0m16:04:40.453843 [info ] [MainThread]: 
[0m16:04:40.454373 [info ] [MainThread]: Finished running 2 view models, 1 table model, 2 incremental models in 0 hours 3 minutes and 35.28 seconds (215.28s).
[0m16:04:40.455584 [debug] [MainThread]: Command end result
[0m16:04:40.495112 [info ] [MainThread]: 
[0m16:04:40.495768 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:04:40.496211 [info ] [MainThread]: 
[0m16:04:40.496749 [error] [MainThread]:   Database Error in model silver_transformations (models/silver/silver_transformations.sql)
  250001: Could not connect to Snowflake backend after 1 attempt(s).Aborting
[0m16:04:40.497194 [info ] [MainThread]: 
[0m16:04:40.497728 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
[0m16:04:40.498992 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 216.63353, "process_user_time": 3.729035, "process_kernel_time": 1.776304, "process_mem_max_rss": "212220", "process_in_blocks": "7872", "process_out_blocks": "2904", "command_success": false}
[0m16:04:40.499725 [debug] [MainThread]: Command `dbt run` failed at 16:04:40.499584 after 216.63 seconds
[0m16:04:40.500529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be53cad1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be536eebd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be52ed584c0>]}
[0m16:04:40.501164 [debug] [MainThread]: Flushing usage events
[0m16:04:43.521889 [debug] [Thread-1  ]: Runtime Error in model silver_transformations (models/silver/silver_transformations.sql)
  250003: Failed to get the response. Hanging? method: post, url: https://DMJRCZZ-JX62496.snowflakecomputing.com:443/queries/v1/query-request?requestId=e1e80909-b28c-4513-917b-146443479d31&clientStartTime=1765382504564&retryCount=1&retryReason=None&request_guid=c84ee175-d0e1-4162-8d31-8df2eef25a2b
[0m16:04:43.523090 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09f43936-e180-44d4-9ad0-cde40c83828c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78519e222eb0>]}
[0m16:04:43.524049 [error] [Thread-1  ]: 3 of 5 ERROR creating sql incremental model public.silver_transformations ...... [[31mERROR[0m in 204.07s]
[0m16:04:43.525180 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m16:04:43.526824 [debug] [Thread-1  ]: Began running node model.crypto_transform.fact_trades
[0m16:04:43.527422 [info ] [Thread-1  ]: 4 of 5 SKIP relation public.fact_trades ........................................ [[33mSKIP[0m]
[0m16:04:43.528171 [debug] [Thread-1  ]: Finished running node model.crypto_transform.fact_trades
[0m16:04:43.529483 [debug] [Thread-1  ]: Began running node model.crypto_transform.gold_consumption_view
[0m16:04:43.530014 [info ] [Thread-1  ]: 5 of 5 SKIP relation public.gold_consumption_view .............................. [[33mSKIP[0m]
[0m16:04:43.530609 [debug] [Thread-1  ]: Finished running node model.crypto_transform.gold_consumption_view
[0m16:04:43.532484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:43.532904 [debug] [MainThread]: Connection 'model.crypto_transform.silver_transformations' was properly closed.
[0m16:04:43.533613 [info ] [MainThread]: 
[0m16:04:43.534186 [info ] [MainThread]: Finished running 2 view models, 1 table model, 2 incremental models in 0 hours 5 minutes and 38.16 seconds (338.16s).
[0m16:04:43.535488 [debug] [MainThread]: Command end result
[0m16:04:43.574827 [info ] [MainThread]: 
[0m16:04:43.575531 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:04:43.575965 [info ] [MainThread]: 
[0m16:04:43.576509 [error] [MainThread]:   Runtime Error in model silver_transformations (models/silver/silver_transformations.sql)
  250003: Failed to get the response. Hanging? method: post, url: https://DMJRCZZ-JX62496.snowflakecomputing.com:443/queries/v1/query-request?requestId=e1e80909-b28c-4513-917b-146443479d31&clientStartTime=1765382504564&retryCount=1&retryReason=None&request_guid=c84ee175-d0e1-4162-8d31-8df2eef25a2b
[0m16:04:43.576951 [info ] [MainThread]: 
[0m16:04:43.577477 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
[0m16:04:43.578754 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 338.99823, "process_user_time": 3.828273, "process_kernel_time": 1.702784, "process_mem_max_rss": "209200", "process_in_blocks": "4160", "process_out_blocks": "1960", "command_success": false}
[0m16:04:43.579502 [debug] [MainThread]: Command `dbt run` failed at 16:04:43.579383 after 339.00 seconds
[0m16:04:43.580019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7851a4654190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7851a37c7a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78519e9614c0>]}
[0m16:04:43.580461 [debug] [MainThread]: Flushing usage events
[0m16:04:48.541877 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m16:04:49.537544 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m16:05:23.964524 [debug] [Thread-1  ]: Runtime Error in model fact_trades (models/gold/fact_trades.sql)
  250003: Failed to get the response. Hanging? method: post, url: https://DMJRCZZ-JX62496.snowflakecomputing.com:443/queries/v1/query-request?requestId=04bc5bc1-0ae2-43c0-a5ba-6ebfa43087f0&clientStartTime=1765382479364&retryCount=1&retryReason=None&request_guid=90790404-b958-405a-a068-3ec1414ee91a
[0m16:05:23.965522 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96efb54a-9d6a-4bc3-b982-ca7bee8aac0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4665349b20>]}
[0m16:05:23.966440 [error] [Thread-1  ]: 4 of 5 ERROR creating sql incremental model public.fact_trades ................. [[31mERROR[0m in 319.13s]
[0m16:05:23.967381 [debug] [Thread-1  ]: Finished running node model.crypto_transform.fact_trades
[0m16:05:23.968761 [debug] [Thread-1  ]: Began running node model.crypto_transform.gold_consumption_view
[0m16:05:23.969243 [info ] [Thread-1  ]: 5 of 5 SKIP relation public.gold_consumption_view .............................. [[33mSKIP[0m]
[0m16:05:23.970022 [debug] [Thread-1  ]: Finished running node model.crypto_transform.gold_consumption_view
[0m16:05:23.972306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:23.972744 [debug] [MainThread]: Connection 'model.crypto_transform.fact_trades' was properly closed.
[0m16:05:23.973298 [info ] [MainThread]: 
[0m16:05:23.973773 [info ] [MainThread]: Finished running 2 view models, 1 table model, 2 incremental models in 0 hours 7 minutes and 19.32 seconds (439.32s).
[0m16:05:23.975289 [debug] [MainThread]: Command end result
[0m16:05:24.011781 [info ] [MainThread]: 
[0m16:05:24.012491 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:05:24.012993 [info ] [MainThread]: 
[0m16:05:24.013582 [error] [MainThread]:   Runtime Error in model fact_trades (models/gold/fact_trades.sql)
  250003: Failed to get the response. Hanging? method: post, url: https://DMJRCZZ-JX62496.snowflakecomputing.com:443/queries/v1/query-request?requestId=04bc5bc1-0ae2-43c0-a5ba-6ebfa43087f0&clientStartTime=1765382479364&retryCount=1&retryReason=None&request_guid=90790404-b958-405a-a068-3ec1414ee91a
[0m16:05:24.014007 [info ] [MainThread]: 
[0m16:05:24.014457 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m16:05:24.015748 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 439.95215, "process_user_time": 4.159759, "process_kernel_time": 1.727837, "process_mem_max_rss": "211112", "process_in_blocks": "80", "process_out_blocks": "2024", "command_success": false}
[0m16:05:24.016455 [debug] [MainThread]: Command `dbt run` failed at 16:05:24.016339 after 439.95 seconds
[0m16:05:24.017013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b466b80da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b463bf24f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b466a4479d0>]}
[0m16:05:24.017453 [debug] [MainThread]: Flushing usage events
[0m16:07:10.553723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b44472190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b421c8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b421c8d90>]}


============================== 16:07:10.579409 | acb7cf8d-7d4f-4ecd-8313-9df88c163f3d ==============================
[0m16:07:10.579409 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:07:10.580233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:07:12.934767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acb7cf8d-7d4f-4ecd-8313-9df88c163f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b421dae50>]}
[0m16:07:13.006699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acb7cf8d-7d4f-4ecd-8313-9df88c163f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b17aa6b20>]}
[0m16:07:13.008052 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:07:13.043568 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:07:13.324916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:07:13.325727 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:07:13.606225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acb7cf8d-7d4f-4ecd-8313-9df88c163f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b17b5da30>]}
[0m16:07:13.771518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acb7cf8d-7d4f-4ecd-8313-9df88c163f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b17aaa790>]}
[0m16:07:13.772195 [info ] [MainThread]: Found 5 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m16:07:13.772659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acb7cf8d-7d4f-4ecd-8313-9df88c163f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b3e52d280>]}
[0m16:07:13.774541 [info ] [MainThread]: 
[0m16:07:13.775289 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:07:13.782612 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m16:07:13.804583 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m16:07:13.805285 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m16:07:13.805912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:40.430056 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 26.625 seconds
[0m16:07:40.433084 [debug] [ThreadPool]: On list_streaming_db: Close
[0m16:07:40.825370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m16:07:40.838213 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m16:07:40.838757 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m16:07:40.839164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:42.007208 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.168 seconds
[0m16:07:42.009929 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m16:07:42.408727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acb7cf8d-7d4f-4ecd-8313-9df88c163f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b4445f430>]}
[0m16:07:42.409963 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:07:42.410511 [info ] [MainThread]: 
[0m16:07:42.420296 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m16:07:42.421335 [info ] [Thread-1  ]: 1 of 5 START sql view model public.bronze_data ................................. [RUN]
[0m16:07:42.422180 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m16:07:42.422636 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m16:07:42.433814 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m16:07:42.434782 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m16:07:42.468208 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m16:07:42.469794 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m16:07:42.470323 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m16:07:42.470765 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:07:43.709231 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.238 seconds
[0m16:07:43.736441 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m16:07:44.154583 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acb7cf8d-7d4f-4ecd-8313-9df88c163f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b3dfae100>]}
[0m16:07:44.156786 [info ] [Thread-1  ]: 1 of 5 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.73s]
[0m16:07:44.158770 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m16:07:44.160216 [debug] [Thread-1  ]: Began running node model.crypto_transform.dim_symbol
[0m16:07:44.161503 [info ] [Thread-1  ]: 2 of 5 START sql table model public.dim_symbol ................................. [RUN]
[0m16:07:44.163016 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.dim_symbol)
[0m16:07:44.164226 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.dim_symbol
[0m16:07:44.171020 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.dim_symbol"
[0m16:07:44.172333 [debug] [Thread-1  ]: Began executing node model.crypto_transform.dim_symbol
[0m16:07:44.244631 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.dim_symbol"
[0m16:07:44.246949 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.dim_symbol"
[0m16:07:44.248102 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.dim_symbol"} */
create or replace transient table streaming_db.public.dim_symbol
         as
        (SELECT
    -- Generate a unique Surrogate Key (INT) for the Fact table to use
    -- We use md5 hash of ticker + valid_from to ensure uniqueness for every version
    MD5(ticker || dbt_valid_from) as symbol_key,
    
    ticker,
    sector,
    risk_level,
    
    -- SCD2 Metadata
    dbt_valid_from as valid_from,
    COALESCE(dbt_valid_to, '9999-12-31'::timestamp) as valid_to,
    
    CASE 
        WHEN dbt_valid_to IS NULL THEN TRUE 
        ELSE FALSE 
    END as is_current

FROM streaming_db.public.dim_symbol_snapshot
        );
[0m16:07:44.248923 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:07:46.447262 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.198 seconds
[0m16:07:46.450567 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: Close
[0m16:07:46.797162 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acb7cf8d-7d4f-4ecd-8313-9df88c163f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b3de228e0>]}
[0m16:07:46.798278 [info ] [Thread-1  ]: 2 of 5 OK created sql table model public.dim_symbol ............................ [[32mSUCCESS 1[0m in 2.63s]
[0m16:07:46.799222 [debug] [Thread-1  ]: Finished running node model.crypto_transform.dim_symbol
[0m16:07:46.799942 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m16:07:46.800721 [info ] [Thread-1  ]: 3 of 5 START sql incremental model public.silver_transformations ............... [RUN]
[0m16:07:46.801403 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.dim_symbol, now model.crypto_transform.silver_transformations)
[0m16:07:46.802034 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m16:07:46.814201 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m16:07:46.815668 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m16:07:46.856019 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:07:46.856829 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace  temporary view streaming_db.public.silver_transformations__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
        -- INCREMENTAL LOGIC (The most important part):
        -- "Only give me rows that are NEWER than the max time currently in this table"
        AND Trade_Time > (SELECT MAX(Trade_Time) FROM streaming_db.public.silver_transformations)
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
  );
[0m16:07:46.857367 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:07:48.138183 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.281 seconds
[0m16:07:48.150369 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:07:48.150987 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations__dbt_tmp
[0m16:07:48.344692 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.193 seconds
[0m16:07:48.349630 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:07:48.350541 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations
[0m16:07:48.590714 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.240 seconds
[0m16:07:48.600844 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:07:48.601425 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table "STREAMING_DB"."PUBLIC"."SILVER_TRANSFORMATIONS"
[0m16:07:48.816747 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.215 seconds
[0m16:07:48.847185 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.silver_transformations"
[0m16:07:48.848972 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:07:48.849405 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
-- back compat for old kwarg name
  
  begin;
[0m16:07:49.088364 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.238 seconds
[0m16:07:49.089044 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:07:49.089677 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
merge into streaming_db.public.silver_transformations as DBT_INTERNAL_DEST
        using streaming_db.public.silver_transformations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.trade_id = DBT_INTERNAL_DEST.trade_id
            )

    
    when matched then update set
        "TICKER" = DBT_INTERNAL_SOURCE."TICKER","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TRADE_VALUE_USD" = DBT_INTERNAL_SOURCE."TRADE_VALUE_USD","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID","TRADE_CATEGORY" = DBT_INTERNAL_SOURCE."TRADE_CATEGORY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")
    values
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")

;
[0m16:07:49.834211 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.744 seconds
[0m16:07:49.834986 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:07:49.835553 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
COMMIT
[0m16:07:50.168774 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.333 seconds
[0m16:07:50.179332 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.silver_transformations__dbt_tmp
[0m16:07:50.185508 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:07:50.185954 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
drop view if exists streaming_db.public.silver_transformations__dbt_tmp cascade
[0m16:07:50.439072 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.253 seconds
[0m16:07:50.442048 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m16:07:50.820806 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acb7cf8d-7d4f-4ecd-8313-9df88c163f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b3df86df0>]}
[0m16:07:50.821886 [info ] [Thread-1  ]: 3 of 5 OK created sql incremental model public.silver_transformations .......... [[32mSUCCESS 0[0m in 4.02s]
[0m16:07:50.822703 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m16:07:50.824390 [debug] [Thread-1  ]: Began running node model.crypto_transform.fact_trades
[0m16:07:50.825088 [info ] [Thread-1  ]: 4 of 5 START sql incremental model public.fact_trades .......................... [RUN]
[0m16:07:50.825790 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.silver_transformations, now model.crypto_transform.fact_trades)
[0m16:07:50.826290 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.fact_trades
[0m16:07:50.831705 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.fact_trades"
[0m16:07:50.832712 [debug] [Thread-1  ]: Began executing node model.crypto_transform.fact_trades
[0m16:07:50.837664 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:07:50.838330 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
create or replace  temporary view streaming_db.public.fact_trades__dbt_tmp
  
   as (
    

SELECT
    -- Create a deterministic unique ID for the Fact
    MD5(s.trade_id || s.trade_time) as fact_id,
    
    -- Foreign Key to the Dimension (SCD2 Link)
    d.symbol_key,
    
    -- Fact Measures
    s.trade_time,
    s.price,
    s.quantity,
    (s.price * s.quantity) as total_amount_usd,
    
    -- Degenerate Dimensions (IDs usually left in Fact)
    s.trade_id,
    s.buyer_order_id,
    s.seller_order_id

FROM streaming_db.public.silver_transformations s
-- JOIN Logic for SCD Type 2:
-- Match Ticker AND ensure Trade Time falls between the Dimension's validity window
LEFT JOIN streaming_db.public.dim_symbol d 
    ON s.ticker = d.ticker 
    AND s.trade_time >= d.valid_from 
    AND s.trade_time < d.valid_to


WHERE s.trade_time > (SELECT MAX(trade_time) FROM streaming_db.public.fact_trades)

  );
[0m16:07:50.838832 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:07:52.201748 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.363 seconds
[0m16:07:52.205754 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:07:52.206391 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table streaming_db.public.fact_trades__dbt_tmp
[0m16:07:52.452666 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.246 seconds
[0m16:07:52.459576 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:07:52.460315 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table streaming_db.public.fact_trades
[0m16:07:52.747692 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.287 seconds
[0m16:07:52.753275 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:07:52.753898 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table "STREAMING_DB"."PUBLIC"."FACT_TRADES"
[0m16:07:52.973186 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.219 seconds
[0m16:07:52.980203 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.fact_trades"
[0m16:07:52.982072 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:07:52.982589 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
-- back compat for old kwarg name
  
  begin;
[0m16:07:53.207491 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.224 seconds
[0m16:07:53.208280 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:07:53.208860 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
merge into streaming_db.public.fact_trades as DBT_INTERNAL_DEST
        using streaming_db.public.fact_trades__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.fact_id = DBT_INTERNAL_DEST.fact_id
            )

    
    when matched then update set
        "FACT_ID" = DBT_INTERNAL_SOURCE."FACT_ID","SYMBOL_KEY" = DBT_INTERNAL_SOURCE."SYMBOL_KEY","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TOTAL_AMOUNT_USD" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT_USD","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID"
    

    when not matched then insert
        ("FACT_ID", "SYMBOL_KEY", "TRADE_TIME", "PRICE", "QUANTITY", "TOTAL_AMOUNT_USD", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID")
    values
        ("FACT_ID", "SYMBOL_KEY", "TRADE_TIME", "PRICE", "QUANTITY", "TOTAL_AMOUNT_USD", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID")

;
[0m16:07:58.499073 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 5.290 seconds
[0m16:07:58.499988 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:07:58.500535 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
COMMIT
[0m16:07:58.862638 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.361 seconds
[0m16:07:58.867116 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.fact_trades__dbt_tmp
[0m16:07:58.868417 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:07:58.868938 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
drop view if exists streaming_db.public.fact_trades__dbt_tmp cascade
[0m16:07:59.117062 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.248 seconds
[0m16:07:59.120736 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: Close
[0m16:07:59.525128 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acb7cf8d-7d4f-4ecd-8313-9df88c163f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b3ddfa7f0>]}
[0m16:07:59.526251 [info ] [Thread-1  ]: 4 of 5 OK created sql incremental model public.fact_trades ..................... [[32mSUCCESS 0[0m in 8.70s]
[0m16:07:59.527187 [debug] [Thread-1  ]: Finished running node model.crypto_transform.fact_trades
[0m16:07:59.528846 [debug] [Thread-1  ]: Began running node model.crypto_transform.gold_consumption_view
[0m16:07:59.529622 [info ] [Thread-1  ]: 5 of 5 START sql view model public.gold_consumption_view ....................... [RUN]
[0m16:07:59.530452 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.fact_trades, now model.crypto_transform.gold_consumption_view)
[0m16:07:59.530922 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.gold_consumption_view
[0m16:07:59.535508 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.gold_consumption_view"
[0m16:07:59.536547 [debug] [Thread-1  ]: Began executing node model.crypto_transform.gold_consumption_view
[0m16:07:59.540909 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.gold_consumption_view"
[0m16:07:59.542386 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.gold_consumption_view"
[0m16:07:59.542860 [debug] [Thread-1  ]: On model.crypto_transform.gold_consumption_view: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.gold_consumption_view"} */
create or replace   view streaming_db.public.gold_consumption_view
  
   as (
    

SELECT
    -- 1. Fact Data (Measures)
    f.trade_time,
    f.price,
    f.quantity,
    f.total_amount_usd,
    
    -- 2. Dimension Data (Context)
    -- We act as if these columns always belonged to the trade
    d.sector,
    d.risk_level,
    
    -- 3. Metadata (Optional)
    f.fact_id,
    f.buyer_order_id,
    f.seller_order_id

FROM streaming_db.public.fact_trades f
-- The Join is already done HERE so users don't have to do it
LEFT JOIN streaming_db.public.dim_symbol d 
    ON f.symbol_key = d.symbol_key
  );
[0m16:07:59.543324 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:08:00.835767 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.292 seconds
[0m16:08:00.839068 [debug] [Thread-1  ]: On model.crypto_transform.gold_consumption_view: Close
[0m16:08:01.244320 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acb7cf8d-7d4f-4ecd-8313-9df88c163f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b3df865e0>]}
[0m16:08:01.245322 [info ] [Thread-1  ]: 5 of 5 OK created sql view model public.gold_consumption_view .................. [[32mSUCCESS 1[0m in 1.71s]
[0m16:08:01.246457 [debug] [Thread-1  ]: Finished running node model.crypto_transform.gold_consumption_view
[0m16:08:01.248666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:01.249141 [debug] [MainThread]: Connection 'model.crypto_transform.gold_consumption_view' was properly closed.
[0m16:08:01.249688 [info ] [MainThread]: 
[0m16:08:01.250223 [info ] [MainThread]: Finished running 2 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 47.47 seconds (47.47s).
[0m16:08:01.251928 [debug] [MainThread]: Command end result
[0m16:08:01.291883 [info ] [MainThread]: 
[0m16:08:01.292714 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:08:01.293513 [info ] [MainThread]: 
[0m16:08:01.294194 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:08:01.295599 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 50.80837, "process_user_time": 6.062902, "process_kernel_time": 2.229067, "process_mem_max_rss": "235464", "process_in_blocks": "8048", "process_out_blocks": "22784"}
[0m16:08:01.296447 [debug] [MainThread]: Command `dbt run` succeeded at 16:08:01.296268 after 50.81 seconds
[0m16:08:01.296968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b44472190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b42fdf310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b17aa6b20>]}
[0m16:08:01.297436 [debug] [MainThread]: Flushing usage events
[0m16:08:26.325275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d81a98a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d7f89a700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d7f89afa0>]}


============================== 16:08:26.335268 | c17ce333-dda9-40aa-a571-b11f9b495221 ==============================
[0m16:08:26.335268 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:08:26.335925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m16:08:27.422058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c17ce333-dda9-40aa-a571-b11f9b495221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d5889ff70>]}
[0m16:08:27.482369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c17ce333-dda9-40aa-a571-b11f9b495221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d5889fe80>]}
[0m16:08:27.483827 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:08:27.508454 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:08:27.712361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:08:27.713007 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:08:27.791648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c17ce333-dda9-40aa-a571-b11f9b495221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d7bd72c10>]}
[0m16:08:28.031388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c17ce333-dda9-40aa-a571-b11f9b495221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d7bd06dc0>]}
[0m16:08:28.032140 [info ] [MainThread]: Found 5 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m16:08:28.032667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c17ce333-dda9-40aa-a571-b11f9b495221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d50fd2190>]}
[0m16:08:28.034382 [info ] [MainThread]: 
[0m16:08:28.035123 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:08:28.041326 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m16:08:28.057537 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m16:08:28.057994 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m16:08:28.058449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:29.412379 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.354 seconds
[0m16:08:29.415830 [debug] [ThreadPool]: On list_streaming_db: Close
[0m16:08:29.812712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m16:08:29.826572 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m16:08:29.827284 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m16:08:29.827707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:31.125155 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.297 seconds
[0m16:08:31.128161 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m16:08:31.499529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c17ce333-dda9-40aa-a571-b11f9b495221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d59444b50>]}
[0m16:08:31.500557 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:08:31.501107 [info ] [MainThread]: 
[0m16:08:31.511329 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m16:08:31.512042 [info ] [Thread-1  ]: 1 of 5 START sql view model public.bronze_data ................................. [RUN]
[0m16:08:31.512666 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m16:08:31.513132 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m16:08:31.522459 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m16:08:31.523295 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m16:08:31.553128 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m16:08:31.554515 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m16:08:31.555022 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m16:08:31.555470 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:08:32.824774 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.269 seconds
[0m16:08:32.853423 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m16:08:33.349163 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c17ce333-dda9-40aa-a571-b11f9b495221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d5942deb0>]}
[0m16:08:33.350274 [info ] [Thread-1  ]: 1 of 5 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.83s]
[0m16:08:33.351157 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m16:08:33.351856 [debug] [Thread-1  ]: Began running node model.crypto_transform.dim_symbol
[0m16:08:33.352727 [info ] [Thread-1  ]: 2 of 5 START sql table model public.dim_symbol ................................. [RUN]
[0m16:08:33.353762 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.dim_symbol)
[0m16:08:33.354306 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.dim_symbol
[0m16:08:33.357813 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.dim_symbol"
[0m16:08:33.358674 [debug] [Thread-1  ]: Began executing node model.crypto_transform.dim_symbol
[0m16:08:33.383718 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.dim_symbol"
[0m16:08:33.385196 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.dim_symbol"
[0m16:08:33.385687 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.dim_symbol"} */
create or replace transient table streaming_db.public.dim_symbol
         as
        (SELECT
    -- Generate a unique Surrogate Key (INT) for the Fact table to use
    -- We use md5 hash of ticker + valid_from to ensure uniqueness for every version
    MD5(ticker || dbt_valid_from) as symbol_key,
    
    ticker,
    sector,
    risk_level,
    
    -- SCD2 Metadata
    dbt_valid_from as valid_from,
    COALESCE(dbt_valid_to, '9999-12-31'::timestamp) as valid_to,
    
    CASE 
        WHEN dbt_valid_to IS NULL THEN TRUE 
        ELSE FALSE 
    END as is_current

FROM streaming_db.public.dim_symbol_snapshot
        );
[0m16:08:33.386133 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:08:35.159959 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.774 seconds
[0m16:08:35.164256 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: Close
[0m16:08:35.637742 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c17ce333-dda9-40aa-a571-b11f9b495221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d7f5b8880>]}
[0m16:08:35.638995 [info ] [Thread-1  ]: 2 of 5 OK created sql table model public.dim_symbol ............................ [[32mSUCCESS 1[0m in 2.28s]
[0m16:08:35.640325 [debug] [Thread-1  ]: Finished running node model.crypto_transform.dim_symbol
[0m16:08:35.641029 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m16:08:35.642004 [info ] [Thread-1  ]: 3 of 5 START sql incremental model public.silver_transformations ............... [RUN]
[0m16:08:35.642881 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.dim_symbol, now model.crypto_transform.silver_transformations)
[0m16:08:35.643413 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m16:08:35.654069 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m16:08:35.654797 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m16:08:35.690667 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:08:35.691262 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace  temporary view streaming_db.public.silver_transformations__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
        -- INCREMENTAL LOGIC (The most important part):
        -- "Only give me rows that are NEWER than the max time currently in this table"
        AND Trade_Time > (SELECT MAX(Trade_Time) FROM streaming_db.public.silver_transformations)
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
  );
[0m16:08:35.691778 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:08:36.770155 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.078 seconds
[0m16:08:36.781289 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:08:36.781856 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations__dbt_tmp
[0m16:08:36.997637 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.215 seconds
[0m16:08:37.007982 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:08:37.009275 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations
[0m16:08:37.252536 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.242 seconds
[0m16:08:37.263287 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:08:37.263862 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table "STREAMING_DB"."PUBLIC"."SILVER_TRANSFORMATIONS"
[0m16:08:37.524972 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.260 seconds
[0m16:08:37.557192 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.silver_transformations"
[0m16:08:37.559037 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:08:37.559715 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
-- back compat for old kwarg name
  
  begin;
[0m16:08:37.822993 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.262 seconds
[0m16:08:37.823875 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:08:37.824528 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
merge into streaming_db.public.silver_transformations as DBT_INTERNAL_DEST
        using streaming_db.public.silver_transformations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.trade_id = DBT_INTERNAL_DEST.trade_id
            )

    
    when matched then update set
        "TICKER" = DBT_INTERNAL_SOURCE."TICKER","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TRADE_VALUE_USD" = DBT_INTERNAL_SOURCE."TRADE_VALUE_USD","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID","TRADE_CATEGORY" = DBT_INTERNAL_SOURCE."TRADE_CATEGORY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")
    values
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")

;
[0m16:08:38.482047 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.657 seconds
[0m16:08:38.482966 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:08:38.483560 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
COMMIT
[0m16:08:38.807550 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.323 seconds
[0m16:08:38.817481 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.silver_transformations__dbt_tmp
[0m16:08:38.824039 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:08:38.824513 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
drop view if exists streaming_db.public.silver_transformations__dbt_tmp cascade
[0m16:08:39.112455 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.287 seconds
[0m16:08:39.115710 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m16:08:39.525916 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c17ce333-dda9-40aa-a571-b11f9b495221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d7b8c1580>]}
[0m16:08:39.527039 [info ] [Thread-1  ]: 3 of 5 OK created sql incremental model public.silver_transformations .......... [[32mSUCCESS 0[0m in 3.88s]
[0m16:08:39.528052 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m16:08:39.529311 [debug] [Thread-1  ]: Began running node model.crypto_transform.fact_trades
[0m16:08:39.530449 [info ] [Thread-1  ]: 4 of 5 START sql incremental model public.fact_trades .......................... [RUN]
[0m16:08:39.531272 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.silver_transformations, now model.crypto_transform.fact_trades)
[0m16:08:39.531767 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.fact_trades
[0m16:08:39.538213 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.fact_trades"
[0m16:08:39.539011 [debug] [Thread-1  ]: Began executing node model.crypto_transform.fact_trades
[0m16:08:39.542843 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:08:39.543307 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
create or replace  temporary view streaming_db.public.fact_trades__dbt_tmp
  
   as (
    

SELECT
    -- Create a deterministic unique ID for the Fact
    MD5(s.trade_id || s.trade_time) as fact_id,
    
    -- Foreign Key to the Dimension (SCD2 Link)
    d.symbol_key,
    
    -- Fact Measures
    s.trade_time,
    s.price,
    s.quantity,
    (s.price * s.quantity) as total_amount_usd,
    
    -- Degenerate Dimensions (IDs usually left in Fact)
    s.trade_id,
    s.buyer_order_id,
    s.seller_order_id

FROM streaming_db.public.silver_transformations s
-- JOIN Logic for SCD Type 2:
-- Match Ticker AND ensure Trade Time falls between the Dimension's validity window
LEFT JOIN streaming_db.public.dim_symbol d 
    ON s.ticker = d.ticker 
    AND s.trade_time >= d.valid_from 
    AND s.trade_time < d.valid_to


WHERE s.trade_time > (SELECT MAX(trade_time) FROM streaming_db.public.fact_trades)

  );
[0m16:08:39.543779 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:08:40.844034 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.300 seconds
[0m16:08:40.848218 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:08:40.848779 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table streaming_db.public.fact_trades__dbt_tmp
[0m16:08:41.138208 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.289 seconds
[0m16:08:41.143467 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:08:41.144037 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table streaming_db.public.fact_trades
[0m16:08:41.352567 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.207 seconds
[0m16:08:41.358160 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:08:41.358852 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table "STREAMING_DB"."PUBLIC"."FACT_TRADES"
[0m16:08:41.570161 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.211 seconds
[0m16:08:41.577717 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.fact_trades"
[0m16:08:41.579510 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:08:41.580014 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
-- back compat for old kwarg name
  
  begin;
[0m16:08:41.991643 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.411 seconds
[0m16:08:41.992743 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:08:41.993332 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
merge into streaming_db.public.fact_trades as DBT_INTERNAL_DEST
        using streaming_db.public.fact_trades__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.fact_id = DBT_INTERNAL_DEST.fact_id
            )

    
    when matched then update set
        "FACT_ID" = DBT_INTERNAL_SOURCE."FACT_ID","SYMBOL_KEY" = DBT_INTERNAL_SOURCE."SYMBOL_KEY","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TOTAL_AMOUNT_USD" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT_USD","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID"
    

    when not matched then insert
        ("FACT_ID", "SYMBOL_KEY", "TRADE_TIME", "PRICE", "QUANTITY", "TOTAL_AMOUNT_USD", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID")
    values
        ("FACT_ID", "SYMBOL_KEY", "TRADE_TIME", "PRICE", "QUANTITY", "TOTAL_AMOUNT_USD", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID")

;
[0m16:08:42.938045 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.944 seconds
[0m16:08:42.939036 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:08:42.939647 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
COMMIT
[0m16:08:43.272464 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.332 seconds
[0m16:08:43.277143 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.fact_trades__dbt_tmp
[0m16:08:43.278495 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:08:43.279131 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
drop view if exists streaming_db.public.fact_trades__dbt_tmp cascade
[0m16:08:43.523686 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.244 seconds
[0m16:08:43.527738 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: Close
[0m16:08:43.665124 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c17ce333-dda9-40aa-a571-b11f9b495221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d7b883fa0>]}
[0m16:08:43.666854 [info ] [Thread-1  ]: 4 of 5 OK created sql incremental model public.fact_trades ..................... [[32mSUCCESS 0[0m in 4.13s]
[0m16:08:43.668418 [debug] [Thread-1  ]: Finished running node model.crypto_transform.fact_trades
[0m16:08:43.670621 [debug] [Thread-1  ]: Began running node model.crypto_transform.gold_consumption_view
[0m16:08:43.671598 [info ] [Thread-1  ]: 5 of 5 START sql view model public.gold_consumption_view ....................... [RUN]
[0m16:08:43.672342 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.fact_trades, now model.crypto_transform.gold_consumption_view)
[0m16:08:43.673065 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.gold_consumption_view
[0m16:08:43.682434 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.gold_consumption_view"
[0m16:08:43.683933 [debug] [Thread-1  ]: Began executing node model.crypto_transform.gold_consumption_view
[0m16:08:43.691402 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.gold_consumption_view"
[0m16:08:43.693192 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.gold_consumption_view"
[0m16:08:43.693837 [debug] [Thread-1  ]: On model.crypto_transform.gold_consumption_view: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.gold_consumption_view"} */
create or replace   view streaming_db.public.gold_consumption_view
  
   as (
    

SELECT
    -- 1. Fact Data (Measures)
    f.trade_time,
    f.price,
    f.quantity,
    f.total_amount_usd,
    
    -- 2. Dimension Data (Context)
    -- We act as if these columns always belonged to the trade
    d.sector,
    d.risk_level,
    
    -- 3. Metadata (Optional)
    f.fact_id,
    f.buyer_order_id,
    f.seller_order_id

FROM streaming_db.public.fact_trades f
-- The Join is already done HERE so users don't have to do it
LEFT JOIN streaming_db.public.dim_symbol d 
    ON f.symbol_key = d.symbol_key
  );
[0m16:08:43.694358 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:08:45.126988 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.432 seconds
[0m16:08:45.130444 [debug] [Thread-1  ]: On model.crypto_transform.gold_consumption_view: Close
[0m16:08:45.530330 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c17ce333-dda9-40aa-a571-b11f9b495221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d7b6f5130>]}
[0m16:08:45.531532 [info ] [Thread-1  ]: 5 of 5 OK created sql view model public.gold_consumption_view .................. [[32mSUCCESS 1[0m in 1.86s]
[0m16:08:45.532635 [debug] [Thread-1  ]: Finished running node model.crypto_transform.gold_consumption_view
[0m16:08:45.535032 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:45.535685 [debug] [MainThread]: Connection 'model.crypto_transform.gold_consumption_view' was properly closed.
[0m16:08:45.536669 [info ] [MainThread]: 
[0m16:08:45.537261 [info ] [MainThread]: Finished running 2 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 17.50 seconds (17.50s).
[0m16:08:45.539153 [debug] [MainThread]: Command end result
[0m16:08:45.580373 [info ] [MainThread]: 
[0m16:08:45.581109 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:08:45.581626 [info ] [MainThread]: 
[0m16:08:45.582133 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:08:45.583368 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.559978, "process_user_time": 4.156471, "process_kernel_time": 1.622813, "process_mem_max_rss": "203924", "process_out_blocks": "2040", "process_in_blocks": "0"}
[0m16:08:45.584103 [debug] [MainThread]: Command `dbt run` succeeded at 16:08:45.583984 after 19.56 seconds
[0m16:08:45.584793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d81a98a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d82b36850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d5889fe80>]}
[0m16:08:45.585254 [debug] [MainThread]: Flushing usage events
[0m16:08:52.067071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aedca27370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aeda9bb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aeda9bba90>]}


============================== 16:08:52.072948 | 7f69240f-62f0-4d68-b58f-7e6ba2373120 ==============================
[0m16:08:52.072948 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:08:52.073616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:08:52.975452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f69240f-62f0-4d68-b58f-7e6ba2373120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aeda781880>]}
[0m16:08:53.032930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f69240f-62f0-4d68-b58f-7e6ba2373120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aedb6553d0>]}
[0m16:08:53.034137 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:08:53.057635 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:08:53.242744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:08:53.243661 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:08:53.331983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f69240f-62f0-4d68-b58f-7e6ba2373120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aed6d19ca0>]}
[0m16:08:53.600197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f69240f-62f0-4d68-b58f-7e6ba2373120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aeda89c4c0>]}
[0m16:08:53.600943 [info ] [MainThread]: Found 5 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m16:08:53.601547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f69240f-62f0-4d68-b58f-7e6ba2373120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aedc672a60>]}
[0m16:08:53.603095 [info ] [MainThread]: 
[0m16:08:53.603567 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:08:53.605948 [debug] [MainThread]: Command end result
[0m16:08:53.646628 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.6364092, "process_user_time": 3.223587, "process_kernel_time": 1.560437, "process_mem_max_rss": "192864", "process_in_blocks": "600", "process_out_blocks": "1872"}
[0m16:08:53.647941 [debug] [MainThread]: Command `dbt test` succeeded at 16:08:53.647737 after 1.64 seconds
[0m16:08:53.648566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aedca27370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aeb410fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aeda781880>]}
[0m16:08:53.649156 [debug] [MainThread]: Flushing usage events
[0m16:09:02.991825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93eba573d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93e9a78490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93ea6e19d0>]}


============================== 16:09:02.997563 | 93ac7957-338f-42bf-ac6e-60992db7d8e0 ==============================
[0m16:09:02.997563 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:09:02.998175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:09:03.870813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93ac7957-338f-42bf-ac6e-60992db7d8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93e98ca2b0>]}
[0m16:09:03.930140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93ac7957-338f-42bf-ac6e-60992db7d8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93bc0fb1c0>]}
[0m16:09:03.931142 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:09:03.954890 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:09:04.141514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:09:04.142093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:09:04.226241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93ac7957-338f-42bf-ac6e-60992db7d8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93e5d47ca0>]}
[0m16:09:04.594347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93ac7957-338f-42bf-ac6e-60992db7d8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93e5cd85b0>]}
[0m16:09:04.595153 [info ] [MainThread]: Found 5 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m16:09:04.595629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93ac7957-338f-42bf-ac6e-60992db7d8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93bc0a6070>]}
[0m16:09:04.597169 [info ] [MainThread]: 
[0m16:09:04.597931 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:09:04.603543 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_streaming_db'
[0m16:09:04.620092 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db"
[0m16:09:04.620501 [debug] [ThreadPool]: On list_streaming_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db"} */
show terse schemas in database streaming_db
    limit 10000
[0m16:09:04.620879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:05.922805 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.302 seconds
[0m16:09:05.925762 [debug] [ThreadPool]: On list_streaming_db: Close
[0m16:09:06.312287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_streaming_db, now list_streaming_db_public)
[0m16:09:06.325540 [debug] [ThreadPool]: Using snowflake connection "list_streaming_db_public"
[0m16:09:06.326035 [debug] [ThreadPool]: On list_streaming_db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "connection_name": "list_streaming_db_public"} */
show objects in streaming_db.public limit 10000
[0m16:09:06.326425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:07.472625 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.146 seconds
[0m16:09:07.475416 [debug] [ThreadPool]: On list_streaming_db_public: Close
[0m16:09:07.835414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93ac7957-338f-42bf-ac6e-60992db7d8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93eda5b0d0>]}
[0m16:09:07.836430 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:09:07.836976 [info ] [MainThread]: 
[0m16:09:07.846244 [debug] [Thread-1  ]: Began running node model.crypto_transform.bronze_data
[0m16:09:07.846977 [info ] [Thread-1  ]: 1 of 5 START sql view model public.bronze_data ................................. [RUN]
[0m16:09:07.847611 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_streaming_db_public, now model.crypto_transform.bronze_data)
[0m16:09:07.848060 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.bronze_data
[0m16:09:07.857215 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.bronze_data"
[0m16:09:07.858075 [debug] [Thread-1  ]: Began executing node model.crypto_transform.bronze_data
[0m16:09:07.888370 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.bronze_data"
[0m16:09:07.889892 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.bronze_data"
[0m16:09:07.890427 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.bronze_data"} */
create or replace   view streaming_db.public.bronze_data
  
   as (
    SELECT
    RECORD_CONTENT:ticker::string AS ticker,           
    RECORD_CONTENT:price::float AS price,             
    RECORD_CONTENT:quantity::float AS quantity,          
    TO_TIMESTAMP(RECORD_CONTENT:timestamp::int, 3) as Trade_Time, 
    RECORD_CONTENT:trade_id::int AS trade_id,            
    RECORD_CONTENT:buyer_order_id::int AS buyer_order_id,      
    RECORD_CONTENT:seller_order_id::int AS seller_order_id  
FROM streaming_db.public.stock_trades_raw
  );
[0m16:09:07.890942 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:09:09.069681 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.179 seconds
[0m16:09:09.099719 [debug] [Thread-1  ]: On model.crypto_transform.bronze_data: Close
[0m16:09:09.484471 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ac7957-338f-42bf-ac6e-60992db7d8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93bf3f9f10>]}
[0m16:09:09.485598 [info ] [Thread-1  ]: 1 of 5 OK created sql view model public.bronze_data ............................ [[32mSUCCESS 1[0m in 1.64s]
[0m16:09:09.486485 [debug] [Thread-1  ]: Finished running node model.crypto_transform.bronze_data
[0m16:09:09.487187 [debug] [Thread-1  ]: Began running node model.crypto_transform.dim_symbol
[0m16:09:09.488355 [info ] [Thread-1  ]: 2 of 5 START sql table model public.dim_symbol ................................. [RUN]
[0m16:09:09.489801 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.bronze_data, now model.crypto_transform.dim_symbol)
[0m16:09:09.490348 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.dim_symbol
[0m16:09:09.494342 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.dim_symbol"
[0m16:09:09.495204 [debug] [Thread-1  ]: Began executing node model.crypto_transform.dim_symbol
[0m16:09:09.520121 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.dim_symbol"
[0m16:09:09.521798 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.dim_symbol"
[0m16:09:09.522798 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.dim_symbol"} */
create or replace transient table streaming_db.public.dim_symbol
         as
        (SELECT
    -- Generate a unique Surrogate Key (INT) for the Fact table to use
    -- We use md5 hash of ticker + valid_from to ensure uniqueness for every version
    MD5(ticker || dbt_valid_from) as symbol_key,
    
    ticker,
    sector,
    risk_level,
    
    -- SCD2 Metadata
    dbt_valid_from as valid_from,
    COALESCE(dbt_valid_to, '9999-12-31'::timestamp) as valid_to,
    
    CASE 
        WHEN dbt_valid_to IS NULL THEN TRUE 
        ELSE FALSE 
    END as is_current

FROM streaming_db.public.dim_symbol_snapshot
        );
[0m16:09:09.523416 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:09:11.910077 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.387 seconds
[0m16:09:11.913362 [debug] [Thread-1  ]: On model.crypto_transform.dim_symbol: Close
[0m16:09:12.278562 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ac7957-338f-42bf-ac6e-60992db7d8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93e98ab9a0>]}
[0m16:09:12.279621 [info ] [Thread-1  ]: 2 of 5 OK created sql table model public.dim_symbol ............................ [[32mSUCCESS 1[0m in 2.79s]
[0m16:09:12.280583 [debug] [Thread-1  ]: Finished running node model.crypto_transform.dim_symbol
[0m16:09:12.281392 [debug] [Thread-1  ]: Began running node model.crypto_transform.silver_transformations
[0m16:09:12.282172 [info ] [Thread-1  ]: 3 of 5 START sql incremental model public.silver_transformations ............... [RUN]
[0m16:09:12.282817 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.dim_symbol, now model.crypto_transform.silver_transformations)
[0m16:09:12.283371 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.silver_transformations
[0m16:09:12.293789 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.silver_transformations"
[0m16:09:12.294505 [debug] [Thread-1  ]: Began executing node model.crypto_transform.silver_transformations
[0m16:09:12.331115 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:09:12.331759 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
create or replace  temporary view streaming_db.public.silver_transformations__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT * FROM streaming_db.public.bronze_data 
),

deduplicated_data AS (
    SELECT 
        *,

        ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY Trade_Time DESC) as row_num
    FROM source_data
    WHERE 
        -- Data Quality Checks (Transformations):
        price > 0                   -- Filter out bad prints
        AND quantity > 0            -- Filter out system errors
        AND ticker IS NOT NULL      -- Filter out corrupted messages
        
        
        -- INCREMENTAL LOGIC (The most important part):
        -- "Only give me rows that are NEWER than the max time currently in this table"
        AND Trade_Time > (SELECT MAX(Trade_Time) FROM streaming_db.public.silver_transformations)
        
)

SELECT
    ticker,
    price,
    quantity,
    -- Transformation: Calculate total transaction value
    (price * quantity) as trade_value_usd, 
    Trade_Time,
    trade_id,
    buyer_order_id,
    seller_order_id,
    -- Transformation: Tag High Value Trades for analytics
    CASE 
        WHEN (price * quantity) > 10000 THEN 'WHALE' 
        ELSE 'RETAIL' 
    END as trade_category,
    current_timestamp() as dbt_updated_at
FROM deduplicated_data
WHERE row_num = 1
  );
[0m16:09:12.332260 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:09:13.276281 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.944 seconds
[0m16:09:13.287836 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:09:13.288315 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations__dbt_tmp
[0m16:09:13.511521 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.223 seconds
[0m16:09:13.517833 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:09:13.518463 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table streaming_db.public.silver_transformations
[0m16:09:13.792993 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.338 seconds
[0m16:09:13.803925 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:09:13.804714 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
describe table "STREAMING_DB"."PUBLIC"."SILVER_TRANSFORMATIONS"
[0m16:09:14.015391 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.210 seconds
[0m16:09:14.052498 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.silver_transformations"
[0m16:09:14.054596 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:09:14.055159 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
-- back compat for old kwarg name
  
  begin;
[0m16:09:14.398869 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.343 seconds
[0m16:09:14.399731 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:09:14.400347 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
merge into streaming_db.public.silver_transformations as DBT_INTERNAL_DEST
        using streaming_db.public.silver_transformations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.trade_id = DBT_INTERNAL_DEST.trade_id
            )

    
    when matched then update set
        "TICKER" = DBT_INTERNAL_SOURCE."TICKER","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TRADE_VALUE_USD" = DBT_INTERNAL_SOURCE."TRADE_VALUE_USD","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID","TRADE_CATEGORY" = DBT_INTERNAL_SOURCE."TRADE_CATEGORY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")
    values
        ("TICKER", "PRICE", "QUANTITY", "TRADE_VALUE_USD", "TRADE_TIME", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID", "TRADE_CATEGORY", "DBT_UPDATED_AT")

;
[0m16:09:15.193072 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.792 seconds
[0m16:09:15.194018 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:09:15.194583 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
COMMIT
[0m16:09:15.524654 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.329 seconds
[0m16:09:15.536520 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.silver_transformations__dbt_tmp
[0m16:09:15.543399 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.silver_transformations"
[0m16:09:15.543945 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.silver_transformations"} */
drop view if exists streaming_db.public.silver_transformations__dbt_tmp cascade
[0m16:09:15.821170 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.277 seconds
[0m16:09:15.824758 [debug] [Thread-1  ]: On model.crypto_transform.silver_transformations: Close
[0m16:09:16.195609 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ac7957-338f-42bf-ac6e-60992db7d8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93eba68f10>]}
[0m16:09:16.196968 [info ] [Thread-1  ]: 3 of 5 OK created sql incremental model public.silver_transformations .......... [[32mSUCCESS 0[0m in 3.91s]
[0m16:09:16.198292 [debug] [Thread-1  ]: Finished running node model.crypto_transform.silver_transformations
[0m16:09:16.200004 [debug] [Thread-1  ]: Began running node model.crypto_transform.fact_trades
[0m16:09:16.200738 [info ] [Thread-1  ]: 4 of 5 START sql incremental model public.fact_trades .......................... [RUN]
[0m16:09:16.201529 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.silver_transformations, now model.crypto_transform.fact_trades)
[0m16:09:16.202307 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.fact_trades
[0m16:09:16.208788 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.fact_trades"
[0m16:09:16.209685 [debug] [Thread-1  ]: Began executing node model.crypto_transform.fact_trades
[0m16:09:16.214307 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:09:16.215162 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
create or replace  temporary view streaming_db.public.fact_trades__dbt_tmp
  
   as (
    

SELECT
    -- Create a deterministic unique ID for the Fact
    MD5(s.trade_id || s.trade_time) as fact_id,
    
    -- Foreign Key to the Dimension (SCD2 Link)
    d.symbol_key,
    
    -- Fact Measures
    s.trade_time,
    s.price,
    s.quantity,
    (s.price * s.quantity) as total_amount_usd,
    
    -- Degenerate Dimensions (IDs usually left in Fact)
    s.trade_id,
    s.buyer_order_id,
    s.seller_order_id

FROM streaming_db.public.silver_transformations s
-- JOIN Logic for SCD Type 2:
-- Match Ticker AND ensure Trade Time falls between the Dimension's validity window
LEFT JOIN streaming_db.public.dim_symbol d 
    ON s.ticker = d.ticker 
    AND s.trade_time >= d.valid_from 
    AND s.trade_time < d.valid_to


WHERE s.trade_time > (SELECT MAX(trade_time) FROM streaming_db.public.fact_trades)

  );
[0m16:09:16.215714 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:09:17.399665 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.184 seconds
[0m16:09:17.404488 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:09:17.405228 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table streaming_db.public.fact_trades__dbt_tmp
[0m16:09:17.625630 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.220 seconds
[0m16:09:17.630881 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:09:17.631599 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table streaming_db.public.fact_trades
[0m16:09:17.852092 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.220 seconds
[0m16:09:17.858224 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:09:17.858907 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
describe table "STREAMING_DB"."PUBLIC"."FACT_TRADES"
[0m16:09:18.076259 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.217 seconds
[0m16:09:18.084001 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.fact_trades"
[0m16:09:18.085925 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:09:18.086454 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
-- back compat for old kwarg name
  
  begin;
[0m16:09:18.319024 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.232 seconds
[0m16:09:18.319876 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:09:18.320562 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
merge into streaming_db.public.fact_trades as DBT_INTERNAL_DEST
        using streaming_db.public.fact_trades__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.fact_id = DBT_INTERNAL_DEST.fact_id
            )

    
    when matched then update set
        "FACT_ID" = DBT_INTERNAL_SOURCE."FACT_ID","SYMBOL_KEY" = DBT_INTERNAL_SOURCE."SYMBOL_KEY","TRADE_TIME" = DBT_INTERNAL_SOURCE."TRADE_TIME","PRICE" = DBT_INTERNAL_SOURCE."PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","TOTAL_AMOUNT_USD" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT_USD","TRADE_ID" = DBT_INTERNAL_SOURCE."TRADE_ID","BUYER_ORDER_ID" = DBT_INTERNAL_SOURCE."BUYER_ORDER_ID","SELLER_ORDER_ID" = DBT_INTERNAL_SOURCE."SELLER_ORDER_ID"
    

    when not matched then insert
        ("FACT_ID", "SYMBOL_KEY", "TRADE_TIME", "PRICE", "QUANTITY", "TOTAL_AMOUNT_USD", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID")
    values
        ("FACT_ID", "SYMBOL_KEY", "TRADE_TIME", "PRICE", "QUANTITY", "TOTAL_AMOUNT_USD", "TRADE_ID", "BUYER_ORDER_ID", "SELLER_ORDER_ID")

;
[0m16:09:19.029386 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.708 seconds
[0m16:09:19.030224 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:09:19.030774 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
COMMIT
[0m16:09:19.360739 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.329 seconds
[0m16:09:19.365388 [debug] [Thread-1  ]: Applying DROP to: streaming_db.public.fact_trades__dbt_tmp
[0m16:09:19.366830 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.fact_trades"
[0m16:09:19.367427 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.fact_trades"} */
drop view if exists streaming_db.public.fact_trades__dbt_tmp cascade
[0m16:09:19.608356 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.240 seconds
[0m16:09:19.611895 [debug] [Thread-1  ]: On model.crypto_transform.fact_trades: Close
[0m16:09:19.970313 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ac7957-338f-42bf-ac6e-60992db7d8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93e5879820>]}
[0m16:09:19.971447 [info ] [Thread-1  ]: 4 of 5 OK created sql incremental model public.fact_trades ..................... [[32mSUCCESS 0[0m in 3.77s]
[0m16:09:19.972594 [debug] [Thread-1  ]: Finished running node model.crypto_transform.fact_trades
[0m16:09:19.974112 [debug] [Thread-1  ]: Began running node model.crypto_transform.gold_consumption_view
[0m16:09:19.975046 [info ] [Thread-1  ]: 5 of 5 START sql view model public.gold_consumption_view ....................... [RUN]
[0m16:09:19.975875 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.crypto_transform.fact_trades, now model.crypto_transform.gold_consumption_view)
[0m16:09:19.976574 [debug] [Thread-1  ]: Began compiling node model.crypto_transform.gold_consumption_view
[0m16:09:19.982348 [debug] [Thread-1  ]: Writing injected SQL for node "model.crypto_transform.gold_consumption_view"
[0m16:09:19.983118 [debug] [Thread-1  ]: Began executing node model.crypto_transform.gold_consumption_view
[0m16:09:19.986447 [debug] [Thread-1  ]: Writing runtime sql for node "model.crypto_transform.gold_consumption_view"
[0m16:09:19.987543 [debug] [Thread-1  ]: Using snowflake connection "model.crypto_transform.gold_consumption_view"
[0m16:09:19.988062 [debug] [Thread-1  ]: On model.crypto_transform.gold_consumption_view: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_transform", "target_name": "dev", "node_id": "model.crypto_transform.gold_consumption_view"} */
create or replace   view streaming_db.public.gold_consumption_view
  
   as (
    

SELECT
    -- 1. Fact Data (Measures)
    f.trade_time,
    f.price,
    f.quantity,
    f.total_amount_usd,
    
    -- 2. Dimension Data (Context)
    -- We act as if these columns always belonged to the trade
    d.sector,
    d.risk_level,
    
    -- 3. Metadata (Optional)
    f.fact_id,
    f.buyer_order_id,
    f.seller_order_id

FROM streaming_db.public.fact_trades f
-- The Join is already done HERE so users don't have to do it
LEFT JOIN streaming_db.public.dim_symbol d 
    ON f.symbol_key = d.symbol_key
  );
[0m16:09:19.988510 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:09:21.317382 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.329 seconds
[0m16:09:21.321227 [debug] [Thread-1  ]: On model.crypto_transform.gold_consumption_view: Close
[0m16:09:21.809653 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ac7957-338f-42bf-ac6e-60992db7d8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93e98fa460>]}
[0m16:09:21.810941 [info ] [Thread-1  ]: 5 of 5 OK created sql view model public.gold_consumption_view .................. [[32mSUCCESS 1[0m in 1.83s]
[0m16:09:21.811756 [debug] [Thread-1  ]: Finished running node model.crypto_transform.gold_consumption_view
[0m16:09:21.814052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:21.814526 [debug] [MainThread]: Connection 'model.crypto_transform.gold_consumption_view' was properly closed.
[0m16:09:21.815266 [info ] [MainThread]: 
[0m16:09:21.815839 [info ] [MainThread]: Finished running 2 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 17.22 seconds (17.22s).
[0m16:09:21.817609 [debug] [MainThread]: Command end result
[0m16:09:21.852872 [info ] [MainThread]: 
[0m16:09:21.853593 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:21.854098 [info ] [MainThread]: 
[0m16:09:21.854689 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:09:21.855966 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.980064, "process_user_time": 3.954912, "process_kernel_time": 1.698941, "process_mem_max_rss": "203728", "process_out_blocks": "2040", "process_in_blocks": "0"}
[0m16:09:21.856795 [debug] [MainThread]: Command `dbt run` succeeded at 16:09:21.856623 after 18.98 seconds
[0m16:09:21.857323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93eba573d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93eb6b61c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93bc0fb1c0>]}
[0m16:09:21.857774 [debug] [MainThread]: Flushing usage events
[0m16:09:26.380269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d6bccea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d69c374f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d69cc5460>]}


============================== 16:09:26.386769 | 6b661306-e5b9-4ee5-b5c6-9ff922132f02 ==============================
[0m16:09:26.386769 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:09:26.387495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True'}
[0m16:09:27.395506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b661306-e5b9-4ee5-b5c6-9ff922132f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d3b396610>]}
[0m16:09:27.462157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b661306-e5b9-4ee5-b5c6-9ff922132f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d3b31feb0>]}
[0m16:09:27.463305 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:09:27.488022 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:09:27.751349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:09:27.752081 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:09:27.829729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b661306-e5b9-4ee5-b5c6-9ff922132f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d65f51c40>]}
[0m16:09:28.064697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b661306-e5b9-4ee5-b5c6-9ff922132f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d69b06cd0>]}
[0m16:09:28.065534 [info ] [MainThread]: Found 5 models, 1 snapshot, 1 seed, 1 source, 454 macros
[0m16:09:28.066007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b661306-e5b9-4ee5-b5c6-9ff922132f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d6b918460>]}
[0m16:09:28.067514 [info ] [MainThread]: 
[0m16:09:28.067986 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:09:28.070197 [debug] [MainThread]: Command end result
[0m16:09:28.102155 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.779438, "process_user_time": 3.394362, "process_kernel_time": 1.551251, "process_mem_max_rss": "192772", "process_out_blocks": "1872", "process_in_blocks": "0"}
[0m16:09:28.102983 [debug] [MainThread]: Command `dbt test` succeeded at 16:09:28.102865 after 1.78 seconds
[0m16:09:28.103473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d6bccea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d6a8d6400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d6afdb580>]}
[0m16:09:28.103941 [debug] [MainThread]: Flushing usage events
